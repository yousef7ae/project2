!function(a,b,c){"use strict";function d(){return new Error("Unsupported by model")}function e(){return new Error("Parent node required")}function f(a,b){var d,e,f="",g=a.className.split(" ");for(d=0;d<g.length;d++)e=g[d],c.inArray(e,b)>=0&&(f+=" "+e);a.className=f.substr(1)}function g(a){return a.parent().children(":visible").index(a)}function h(a){var b=a.get(0).id;return b.substring(b.lastIndexOf("_")+1)}function i(a,b){return parseInt(a.children(z).find(b).attr($),10)}function j(a,b){return parseInt(a.find(b).attr($),10)}function k(a,b,c,d,e){var f,g,h,i;c.renderNodeContent?c.renderNodeContent(b,a,d,e):(d.nodeSelector>0&&(i=G,1===d.nodeSelector&&(i+=" u-selector--single"),a.markup('<span class="'+i+'"></span>')),c.getIcon&&(f=c.getIcon(b),null!==f&&a.markup("<span").attr("class",d.iconType+" "+f).markup("></span>")),g=d.useLinks&&c.getLink&&c.getLink(b),h=g?"a":"span",a.markup("<"+h+" tabIndex='-1' role='treeitem'").attr("class",d.labelClass).optionalAttr("href",g).attr($,e.level).attr(X,e.selected?ba:ca).optionalAttr(Z,e.disabled?ba:null).optionalAttr(W,e.hasChildren===!1?null:e.expanded?ba:ca).markup(">").content(c.getLabel(b)).markup("</"+h+">"))}function l(a){a.tabIndex=0,a.focus()}function m(a){var b;return a.hasClass(P)?b=a.children("ul").children("li").first():(b=a.next(),0===b.length&&(b=a.parent().parents("li").next("li").first())),b}function n(a){var b;return b=a.prev(),b.length>0?b.hasClass(P)&&(b=b.find("li").filter(":visible").last()):b=a.parent().parent("li"),b}function o(){var a={};window.getSelection?a=window.getSelection():document.selection&&(a=document.selection.createRange()),a.rangeCount?a.removeAllRanges():a.text>""&&document.selection.empty()}function p(a){var b=a.scrollTop(),d=a,e=null;a[0]===document&&(d=c(window)),d.on("scroll.treeTemp",function(){a.scrollTop(b),d.off(".treeTemp"),clearTimeout(e)}),e=setTimeout(function(){d.off(".treeTemp")},20)}function q(a,b,d,e,f){var g=a.val(b).width(d).keydown(function(a){var b=a.which;a.shiftKey||a.ctrlKey||a.altKey||(b===fa.ENTER?(e(c(this).val(),!0),a.preventDefault()):b===fa.ESCAPE&&(setTimeout(function(){f(!0)},10),a.preventDefault()))}).blur(function(a){e(c(this).val(),!1)})[0];return l(g),g.select(),g}var r="a-TreeView",s="a-TreeView-node",t="a-TreeView--noCollapse",u="."+s,v="a-TreeView-node--topLevel",w="a-TreeView-row",x="."+w,y="a-TreeView-content",z="."+y,A=z+", "+x,B="a-TreeView-label",C="a-TreeView-toggle",D="."+C,E="a-TreeView-dragHelper",F="a-TreeView-placeholder",G="u-selector",H="."+G,I="is-selected",J="."+I,K="is-disabled",L="."+K,M="is-focused",N="is-hover",O="is-expandable",P="is-collapsible",Q="is-processing",R="a-TreeView-node--leaf",S="a-Icon",T="u-RTL",U="a-TreeView-input",V="."+U,W="aria-expanded",X="aria-selected",Y="is-active",Z="aria-disabled",$="aria-level",_="<ul role='group'>",aa="</ul>",ba="true",ca="false",da="selectionChange",ea="expansionStateChange",fa=c.ui.keyCode,ga=function(a,b){a._trigger(da,b)},ha=a.debounce(ga,1),ia=a.debounce(ga,350),ja={begin:function(a,b){this.text=""},node:function(a,b,c){b>0&&(this.text+="\r\n"),this.text+=c},end:function(){},toString:function(){return this.text}},ka={begin:function(a,b){this.text="<ul>\r\n"},node:function(b,c,d){this.text+="<li>"+a.escapeHTML(d)+"</li>\r\n"},end:function(){this.text+="</ul>\r\n"},toString:function(){return this.text}};c.widget("apex.treeView",c.ui.mouse,c.extend(!0,{version:"19.1",widgetEventPrefix:"treeview",options:{getNodeAdapter:null,adapterTypesMap:null,showRoot:!0,expandRoot:!0,collapsibleRoot:!0,autoCollapse:!1,useLinks:!0,multiple:!1,nodeSelector:!1,allowCopy:!0,dataTransferFormats:[{format:"text/plain",writer:Object.create(ja)},{format:"text/html",writer:Object.create(ka)}],idPrefix:null,iconType:S,labelClass:B,doubleClick:!1,clickToRename:!1,keyboardRename:!1,keyboardAdd:!1,keyboardDelete:!1,tooltip:null,navigation:!1,dragAndDrop:!1,dragMultiple:!1,dragReorder:!1,dragAppendTo:"parent",dragContainment:!1,dragCursor:"auto",dragCursorAt:!1,dragHelper:null,dragOpacity:!1,dragAnimate:!1,dragExpandDelay:1200,dragScroll:!0,dragScrollSensitivity:20,dragScrollSpeed:10,dragZIndex:1e3,scope:"default",activate:null,deactivate:null,out:null,over:null,start:null,drag:null,beforeStop:null,stop:null,selectionChange:null,expansionStateChange:null,activateNode:null,beginEdit:null,endEdit:null,added:null,renamed:null,deleted:null,moved:null,copied:null},scrollTimerId:null,delayExpandTimer:null,hasCurrent:!1,tooltipOptions:null,triggerTimerId:null,forwardKey:fa.RIGHT,backwardKey:fa.LEFT,scrollParent:null,animating:!1,dragging:!1,dragItems:null,currentItem:null,_create:function(){var a=this,b=this.element,d=this.options;if(d.getNodeAdapter||(d.getNodeAdapter=this._parseTreeMarkup(b,d.adapterTypesMap||null)),!d.getNodeAdapter)throw new Error("Missing required option getNodeAdapter");this.nodeAdapter=d.getNodeAdapter(),this.containerCache={},d.collapsibleRoot===!1&&(d.expandRoot=!0),b.addClass(r).attr("role","tree"),this.baseId=(d.idPrefix||b[0].id||"tree")+"_",this.labelSelector="."+d.labelClass,this.editMode=!1,d.multiple&&b.attr("aria-multiselectable",ba),this.rtlFactor=1,"rtl"===b.css("direction")&&(b.addClass(T),this.forwardKey=fa.LEFT,this.backwardKey=fa.RIGHT,this.rtlFactor=-1),d.disabled&&b.attr(Z,ba),d.tooltip&&this._initTooltips(d.tooltip),this._initContextMenu(z,function(b){return c(b.target).closest("a").length>0||a.editMode},function(b){var d="keydown"===b.type&&a.lastFocused?a.lastFocused:b.target,e=c(d).closest(z);return!!e.length&&(!!e.hasClass(I)||e)},function(b){b.selectedNodes=a.getNodes(b.selection),b.treeNodeAdapter=a.nodeAdapter}),this.scrollParent=b.scrollParent(),this.offset=this.element.offset(),this._mouseInit(),this._on(this._eventHandlers),d.allowCopy&&apex.clipboard.addHandler(b[0],function(b){return!a.editMode&&(a._copy(b),!0)}),this._setOption("disabled",d.disabled),this.refresh()},_eventHandlers:{click:function(a){var b,d,e=this,f=this.options,g=c(a.target);if(!f.multiple&&"A"===a.target.nodeName&&(a.shiftKey||a.ctrlKey))return void(this.keyboardActivate=!1);if(g.hasClass(G))b=g.closest(u),a.ctrlKey=!0,a.shiftKey=!1,e._select(b.children(z),a,!0),a.preventDefault();else if(g.hasClass(C))this._toggleNode(g.parent()),this.scrollParent&&p(this.scrollParent),this.lastFocused.focus(),a.preventDefault();else if(b=g.closest(u),b.length>0){if(d=b.children(z),this.editMode&&d.hasClass(I))return;f.clickToRename&&d.find(this.labelSelector).attr(X)===ba&&!a.ctrlKey&&!a.altKey&&1===this.getSelection().length&&g.closest(this.labelSelector).length?this.renameNodeInPlace(d):(this._select(d,a,!0),f.navigation&&(this.keyboardActivate||"activate"!==f.doubleClick)&&this._activate(a)),a.preventDefault()}this.keyboardActivate=!1,o()},dblclick:function(a){var b,d=this.options.doubleClick;d&&!this.editMode&&(b=c(a.target).closest(u),b.length>0&&("toggle"===d?(this._toggleNode(b),a.preventDefault()):"activate"===d&&this._activate(a)))},keydown:function(a){var b,d,e,f,g,h=this,i=this.options,j=this.element,k=a.which;a.altKey||"INPUT"===a.target.nodeName||this.dragging||(k!==fa.PAGE_UP&&k!==fa.PAGE_DOWN||(this.scrollParent?(e=j.find(x).filter(":visible").first().outerHeight()||24,b=j.find("li").filter(":visible").first(),e+=parseInt(b.css("margin-top"),10)+parseInt(b.css("margin-bottom"),10),f=this.scrollParent[0]===document?c(window).height():this.scrollParent[0].clientHeight,g=Math.floor(f/e)-1):g=10),k===fa.HOME?(j.find(z).filter(":visible").first().each(function(){h._select(c(this),a,!0,!0)}),a.preventDefault()):k===fa.END?(j.find(z).filter(":visible").last().each(function(){h._select(c(this),a,!0,!0)}),a.preventDefault()):k===fa.SPACE?(this.lastFocused&&this._select(c(h.lastFocused).closest(z),a,!0,!0),a.preventDefault()):k===fa.DOWN?(this._traverseDown(a,1),a.preventDefault()):k===fa.UP?(this._traverseUp(a,1),a.preventDefault(),a.stopPropagation()):k===fa.PAGE_DOWN?(this._traverseDown(a,g),a.preventDefault()):k===fa.PAGE_UP?(this._traverseUp(a,g),a.preventDefault()):k===this.backwardKey?(this.lastFocused&&(b=c(this.lastFocused).closest(u),b.hasClass(P)?this._collapseNode(b):b.parent().prevAll(z).each(function(){h._select(c(this),a,!0,!0)})),a.preventDefault()):k===this.forwardKey?(this.lastFocused&&(b=c(this.lastFocused).closest(u),b.hasClass(O)?this._expandNode(b):b.hasClass(P)&&b.children("ul").children("li").first().children(z).each(function(){h._select(c(this),a,!0,!0)})),a.preventDefault()):k===fa.ENTER?"A"===a.target.nodeName||a.shiftKey||a.ctrlKey?this.keyboardActivate=!0:(this._activate(a),a.preventDefault()):113===k&&i.keyboardRename?(d=this.lastFocused&&c(this.lastFocused).closest(z+J).length>0?c(this.lastFocused).closest(z):this.getSelection().first(),d.length>0&&this.renameNodeInPlace(d)):45===k&&i.keyboardAdd?(d=this.lastFocused&&c(this.lastFocused).closest(z+J).length>0?c(this.lastFocused).closest(z):this.getSelection().first(),d.length>0&&this.addNodeInPlace(d)):k===fa.DELETE&&i.keyboardDelete&&this.deleteNodes(this.getSelection()))},keypress:function(a){function b(a){function b(){e=m(e),0===e.length&&(e=f.element.find(u).filter(":visible").first())}var d,e,g,h=a.length;for(e=d=c(f.lastFocused).closest(u),1===h&&b();;){if(g=e.children(z).find(f.labelSelector).first(),g.text().substring(0,h).toLowerCase()===a)return g.closest(z);if(b(),e[0]===d[0])break}return null}var d,e,f=this;if(!(0===a.which||a.ctrlKey||a.altKey||"INPUT"===a.target.nodeName||this.dragging)){if(d=String.fromCharCode(a.which).toLowerCase(),this.searchTimerId)d!==this.searchString&&(this.searchString+=d),clearTimeout(this.searchTimerId),this.searchTimerId=null;else{if(" "===d)return;this.searchString=d}this.searchTimerId=setTimeout(function(){f.searchTimerId=null},500),e=b(this.searchString),e&&this._select(e,a,!0,!0)}},focusin:function(a){var b=c(a.target).closest(this.labelSelector);b.length&&(b.addClass(M).closest(u).children(x).addClass(M),this._setFocusable(b))},focusout:function(a){var b=c(a.target).closest(this.labelSelector);b.removeClass(M).closest(u).children(x).removeClass(M)},mousemove:function(a){var b;this.dragging||(b=c(a.target).closest(u),b.length&&this.lastHover!==b[0]&&(c(this.lastHover).children(A).removeClass(N),b.children(A).addClass(N),this.lastHover=b[0]))},mouseleave:function(a){this.dragging||this.lastHover&&(c(this.lastHover).children(A).removeClass(N),this.lastHover=null)}},_setOption:function(a,d){var e,f=this.options;if(this._checkContextMenuOptions(a,d),"disabled"===a)f[a]=d,this.widget().toggleClass(K,!!d),d?(this.element.attr(Z,ba),this.lastFocused&&(this.lastFocused.tabIndex=-1),this.lastFocused=null):(this.element.removeAttr(Z),e=this.getSelection().first().find(this.labelSelector),e.length||(e=this.element.find(this.labelSelector).first()),this._setFocusable(e));else{if("allowCopy"===a)throw new Error("TreeView "+a+" cannot be set");if("dragMultiple"===a&&d&&!f.multiple)throw new Error("TreeView dragMultiple cannot be true when the multiple option is false");if("multiple"===a&&!d&&f.dragMultiple)throw new Error("TreeView multiple cannot be false when the dragMultiple option is true");if("collapsibleRoot"===a)throw new Error("TreeView collapsibleRoot option cannot be set");this._super(a,d)}f=this.options,f.multiple&&!f.nodeSelector&&apex.userHasTouched()&&(f.nodeSelector=!0),this.renderNodeOptions={iconType:f.iconType,labelClass:f.labelClass,useLinks:f.useLinks,nodeSelector:f.nodeSelector?f.multiple?2:1:0},"showRoot"===a||"useLinks"===a?this.refresh():"getNodeAdapter"===a?(this.nodeAdapter=f.getNodeAdapter(),this.refresh()):"multiple"===a?(this.element.attr("aria-multiselectable",d?ba:ca),d===!1&&this.getSelection().length>0&&this._select(c(this.lastFocused).closest(z),null,!1,!1)):"expandRoot"===a&&d===!1?f.collapsibleRoot===!1&&(f.expandRoot=!0,b.warn("ExpandRoot option cannot be false when collapsibleRoot is false")):"tooltip"===a&&this._initTooltips(d)},_initTooltips:function(a){var d,e=this;return c.ui.tooltip?(this.tooltipOptions&&(this.element.tooltip("destroy"),this.tooltipOptions=null),void(a&&(d=this.tooltipOptions=c.extend(!0,{},a),d.items=this.labelSelector,d.content&&c.isFunction(d.content)&&(d._originalContent=d.content,d.content=function(a){var b=e.getNodes(c(this).closest(z))[0];return d._originalContent.call(this,a,b)}),this.element.tooltip(d)))):void b.warn("tooltip option ignored because missing tooltip widget dependency")},_destroy:function(){var a=this.element;a.empty().removeClass(r+" "+T).removeAttr("role").removeAttr("aria-multiselectable"),apex.clipboard.removeHandler(a[0]),this._destroyContextMenu(),this.options.tooltip&&c.ui.tooltip&&a.tooltip("destroy"),this._mouseDestroy()},refresh:function(b){var d,e,f,g=this,j=this.options,k=this.nodeAdapter,l=null,m=this.element,n=a.htmlBuilder();k.getViewId&&(l=this.getSelectedNodes()),b?b.each(function(){var a=c(this).parent(),b=g.treeMap[h(a)];a.find(u).addBack().each(function(){delete g.treeMap[h(c(this))]}),n.clear(),g._renderNode(b,i(a,g.labelSelector),n),a.replaceWith(n.toString())}):(this.treeMap={},this.nextNodeId=0,k.clearViewId&&k.clearViewId(this.baseId),d=k.root(),d?(n.markup(_),j.showRoot?this._renderNode(d,1,n):k.hasChildren(d)&&this._renderChildren(d,1,n),n.markup(aa),m.html(n.toString())):(n.markup(_),n.markup(aa),m.html(n.toString())),j.expandRoot&&j.showRoot&&(e=this._getRoots(),e.length>0&&this._expandNode(e))),this.hasCurrent?(f=this.find({depth:-1,match:function(a){return a.current===!0}}),this.hasCurrent=!1,this.setSelection(f)):l&&l.length>0?this.setSelectedNodes(l,!1,!0):(this.selectAnchor=this.lastFocused,this._setFocusable(m.find(this.labelSelector).first()))},getNodeAdapter:function(){return this.nodeAdapter},focus:function(){this.lastFocused&&this.lastFocused.focus()},getTreeNode:function(a){var b,e=this.nodeAdapter;if(!e.getViewId)throw d();return b=e.getViewId(this.baseId,a),c("#"+this.baseId+b).children(z)},getSelection:function(){return this.element.find(z+J)},getNodes:function(a){var b=this,d=[];return a.each(function(){var a=h(c(this).closest("li"));"new"!==a&&d.push(b.treeMap[a])}),d},getSelectedNodes:function(){return this.getNodes(this.getSelection())},setSelection:function(a,b,c){b=!!b,this.options.multiple||(a=a.first()),this._select(a,null,b,!1,c)},setSelectedNodes:function(a,e,f){var g,h,i,j=[],k=this.nodeAdapter;if(!k.getViewId)throw d();for(e=!!e,this.options.multiple||(a=[a[0]]),g=0;g<a.length;g++)h=k.getViewId(this.baseId,a[g]),i=c("#"+this.baseId+h).children(z)[0],i?j.push(i):b.warn("TreeView: Ignoring bad node in setSelectedNodes");this._select(c(j),null,e,!1,f)},getExpandedNodeIds:function(){var a=this.nodeAdapter;if(!a.getExpandedNodeIds)throw d();return a.getExpandedNodeIds(this.baseId)},getExpandedState:function(){var a=this.nodeAdapter;if(!a.getExpandedState)throw d();return a.getExpandedState(this.baseId)},find:function(a){return c(this._find(a.parentNodeContent$||null,a.match,a.depth||1,a.findAll||!1))},expand:function(a){var b=this;a||(a=this._getRoots().children(z)),a.each(function(){var a=c(this).closest(u);a.hasClass(O)&&b._expandNode(a)})},expandAll:function(a){var b=this;a||(a=this._getRoots().children(z)),a.each(function(){var a=c(this).closest(u);a.hasClass(O)?b._expandNode(a,function(){b.expandAll(a.children("ul").children("li").children(z))}):b.expandAll(a.children("ul").children("li").children(z))})},collapse:function(a){var b=this;a||(a=this._getRoots().children(z)),a.each(function(){var a=c(this).closest(u);a.hasClass(P)&&b._collapseNode(a)})},collapseAll:function(a){var b=this;a||(a=this._getRoots().children(z)),a.each(function(){var a=c(this).closest(u);b.collapseAll(a.children("ul").children("li").children(z)),a.hasClass(P)&&b._collapseNode(a)})},addNodeInPlace:function(b,e,f){function g(a){n.remove(),r._makeLeafIfNeeded(b),r._select(b,null,a),r._endEdit({action:"add",status:"cancel"})}function i(c,d){var h;if(!x){if(0===c.length)return void g(d);x=!0,v.addNode(o,m.children().length-1,c,f,function(c,f){var i,j;return c===!1?(x=!1,h=n.find(V).val(e).get(0),l(h),void h.select()):void(c?(n.remove(),j=a.htmlBuilder(),r._renderNode(c,p,j),f>=m.children("li").length?m.append(j.toString()):m.children("li").eq(f).before(j.toString()),i=m.children("li").eq(f),0===r.getSelection().length&&r._select(i.children(z),null,d),r._endEdit({action:"add",status:"complete"}),r._trigger("added",{},{parentNode:o,parent$:b,index:f,node:c,node$:i.children(z)})):g(d))})}}function k(){var b,d,h,j=a.htmlBuilder(),k=r.baseId+"new";j.markup("<li").attr("id",k).attr("class",s+" "+R).markup("><div").attr("class",w+" "+I).markup("></div><div").attr("class",y+" "+I).markup(">"),v.getIcon&&j.markup("<span").attr("class",u.iconType).markup("></span>"),j.markup("<span role='treeitem'").attr("class",u.labelClass).attr($,p).attr(X,ba).markup("><input class='"+U+"' type='text'></span></div></li>"),r._select(c(),null,!1),m.append(j.toString()),n=m.find("#"+k),d=n.children(z),b=1===r.rtlFactor?d.width()-d.find(r.labelSelector)[0].offsetLeft-16:d.find(r.labelSelector)[0].offsetLeft+d.find(r.labelSelector).width()-16,h=d.find(V),q(h,e,b,i,g),r._beginEdit({action:"add",context:f,input:h[0]})}var m,n,o,p,r=this,t=this.element,u=this.options,v=this.nodeAdapter,x=!1;if(!v.addNode||!v.allowAdd)throw d();if(null===b){if(o=v.root(),!u.showRoot){if(!v.allowAdd(o,"add",f?[f]:void 0))return;return p=1,m=t.find("ul:first"),void k()}b=t.find("ul:first > li")}else o=this.treeMap[h(b.parent())];v.allowAdd(o,"add",f?[f]:void 0)&&(p=j(b,r.labelSelector)+1,r._makeParentIfNeeded(b),this._expandNode(b.parent(),function(){m=b.next("ul"),k()}))},renameNodeInPlace:function(b){function e(a){o.selected=b.hasClass(I),v.clear(),k(v,g,r,p.renderNodeOptions,o),b.html(v.toString()),o.selected&&p._select(b,null,a),p._endEdit({action:"rename",status:"cancel"})}function f(a,c){var d;if(!u)return u=!0,a===j||0===a.length?void e(c):void r.renameNode(g,a,function(a,f){var g,h,i;return a===!1?(u=!1,d=b.find(V).val(j)[0],l(d),void d.select()):void(a?(v.clear(),o.selected=b.hasClass(I),k(v,a,r,p.renderNodeOptions,o),b.html(v.toString()),p.treeMap[t]=a,h=s.parent(),i=h.children("li"),g=i.index(s),g!==f&&(f>g&&(f+=1),f>=i.length?h.append(s):i.eq(f).before(s)),o.selected&&p._select(b,null,c),p._endEdit({action:"rename",status:"complete"}),p._trigger("renamed",{},{prevLabel:j,index:f,node:a,node$:b}),p._trigger(da,0)):e(c))})}var g,i,j,m,n,o,p=this,r=this.nodeAdapter,s=b.parent(),t=h(s),u=!1,v=a.htmlBuilder();if(!r.renameNode||!r.allowRename)throw d();g=this.treeMap[t],r.allowRename(g)&&(n=b.find(this.labelSelector),o={level:parseInt(n.attr($),10),selected:n.attr(X)===ba,disabled:n.attr(Z)===ba,hasChildren:void 0!==n.attr(W),expanded:n.attr(W)===ba},j=r.getLabel(g),m=1===p.rtlFactor?b.width()-n[0].offsetLeft-16:n[0].offsetLeft+n.width()-16,i=c("<input class='"+U+"' type='text'>"),n.empty().append(i),q(i,j,m,f,e),p._beginEdit({action:"rename",node:g,input:i[0]}))},deleteNodes:function(a){function b(a){function b(a){i+=1,a&&(l.push(d.element),m.push({node:d.node,parent$:d.parent$,index:d.index}),n.clearViewId&&n.clearViewId(j.baseId,d.node)),i>=f&&(j.deleteTreeNodes(c(l)),j._trigger("deleted",{},{items:m}))}var d=k[a];n.deleteNode(d.node,b,a<f-1)}var e,f,i,j=this,k=[],l=[],m=[],n=this.nodeAdapter;if(!n.deleteNode||!n.allowDelete)throw d();for(a.each(function(){var a=c(this),b=j.treeMap[h(a.parent())];n.allowDelete(b)&&k.push({node:b,element:a[0],parent$:a.parent().parent().parent().children(z),index:g(a.parent())})}),f=k.length,i=0,e=0;e<f;e++)b(e)},deleteTreeNodes:function(a){var b,c=this,d=a.closest("ul").prev(),e=a.parent(),f=a.children(this.labelSelector).filter(this.lastFocused).length>0,g=a.hasClass(I);(g||f)&&(b=n(e.eq(0)),0===b.length&&(b=this._getRoots().first()),b.length>0?g?this._select(b.children(z),null,f):this._setFocusable(b.children(z).find(this.labelSelector)):f&&(this.lastFocused=null)),e.remove().each(function(){delete c.treeMap[h(e)]}),this._makeLeafIfNeeded(d)},addNode:function(a,b,c){var f,g,i=this.nodeAdapter;if(!i.addNode||!i.allowAdd)throw d();if(a&&a.length)g=this.treeMap[h(a.parent())];else{if(this.options.showRoot)throw e();g=i.root()}i.allowAdd(g,"add",c?[c]:void 0)&&(f=this.element.find("."+M).length>0,this._add({},a,b,c,f))},moveNodes:function(a,b,c){var f,g,i,j=this.getNodes(c),k=!0,l=this.nodeAdapter;if(!l.moveNodes||!l.allowDelete||!l.allowAdd)throw d();if(a&&a.length)i=this.treeMap[h(a.parent())];else{if(this.options.showRoot)throw e();i=l.root()}for(f=0;f<j.length;f++)if(!l.allowDelete(j[f])){k=!1;break}k&&l.allowAdd(i,"move",j)&&(g=this.element.find("."+M).length>0,this._moveOrCopy({},a,b,c,!1,g))},copyNodes:function(a,b,c){var f,g,i=this.getNodes(c),j=this.nodeAdapter;if(!j.copyNodes||!j.allowAdd)throw d();if(a&&a.length)g=this.treeMap[h(a.parent())];else{if(this.options.showRoot)throw e();g=j.root()}j.allowAdd(g,"copy",i)&&(f=this.element.find("."+M).length>0,this._moveOrCopy({},a,b,c,!0,f))},update:function(b){var c,d,e,g,i,j,l=this.treeMap[h(b.parent())],m=this.nodeAdapter,n=a.htmlBuilder();g=b.find(this.labelSelector),c=g[0]===this.lastFocused,(m.getClasses||m.isDisabled)&&(e=b.prevAll(x),f(b[0],[y,K,M,I,N]),f(e[0],[w,K,M,I,N]),m.getClasses&&(d=m.getClasses(l),d&&(b.addClass(d),e.addClass(d))),m.isDisabled&&m.isDisabled(l)&&(b.addClass(K),e.addClass(K),j=!0)),i={level:parseInt(g.attr($),10),selected:g.attr(X)===ba,disabled:j,hasChildren:void 0!==g.attr(W),expanded:g.attr(W)===ba},k(n,l,m,this.renderNodeOptions,i),b.html(n.toString()),c&&this._setFocusable(b.find(this.labelSelector))},_copy:function(a){var b,c,d=this.nodeAdapter,e=this.getSelectedNodes(),f=this.options.dataTransferFormats;if(e.length){for(f.forEach(function(a){a.writer.begin(d,e)}),b=0;b<e.length;b++)c=e[b],f.forEach(function(a){a.writer.node(c,b,d.getLabel(c))});f.forEach(function(b){b.writer.end(),a.setData(b.format,b.writer.toString())})}},_parseTreeMarkup:function(a,b){function d(a){var b=[];return a.children("ul").children("li").each(function(){var a,e,f,g,j,k=c(this),l=k.children("a").first(),m=k.children("span").first();a={},l.length>0?(a.label=l.text(),a.link=l.attr("href")):m.length>0&&(a.label=m.text()),f=k.attr("data-id"),f?a.id=f:h=!1,k.attr("data-current")===ba&&(a.current=!0,i.hasCurrent=!0),g=k.attr("class"),g&&(a.classes=g),k.attr("data-disabled")===ba&&(a.isDisabled=!0),e=k.attr("data-icon"),e&&(a.icon=e),j=k.attr("data-type"),j&&(a.type=j),k.children("ul").length>0&&(a.children=d(k)),b.push(a)}),b}var e,f,g,h=!0,i=this;return f=d(a),g=f.length>=1?1===f.length&&this.options.showRoot?f[0]:{children:f}:null,b||(b={"default":{operations:{canAdd:!1,canDelete:!1,canRename:!1,canDrag:!1}}}),e=c.apex.treeView.makeDefaultNodeAdapter(g,b,h),function(){return e}},_renderNode:function(a,b,c){var d,e,f,g,h,i,j,l,m=!1,n=this.options,o=this.nodeAdapter;e=this.nextNodeId,this.treeMap[e]=a,o.setViewId&&o.setViewId(this.baseId,a,e),this.nextNodeId+=1,f=s+" ",d=o.hasChildren(a),null===d&&(d=!0),d?(i=!1,o.isExpanded&&(i=o.isExpanded(this.baseId,a)),f+=i?P:O):f+=R,h=0===e&&n.showRoot&&!n.collapsibleRoot,h&&(f+=" "+t),1===b&&(f+=" "+v),g=y,o.isDisabled&&o.isDisabled(a)&&(g+=" "+K,m=!0),j=w,c.markup("<li").attr("id",this.baseId+e).attr("class",f).markup(">"),o.getClasses&&(l=o.getClasses(a),l&&(g+=" "+l,j+=" "+l)),c.markup("<div").attr("class",j).markup("></div>"),d&&!h&&c.markup("<span class='"+C+"'></span>"),c.markup("<div").attr("class",g).markup(">"),k(c,a,o,this.renderNodeOptions,{level:b,selected:!1,disabled:m,hasChildren:d,expanded:i}),c.markup("</div>"),i&&(c.markup(_),this._renderChildren(a,b+1,c),c.markup(aa)),c.markup("</li>")},_renderChildren:function(b,c,d,e,f){function g(){var a;for(a=0;a<h;a++)i._renderNode(j.child(b,a),c,d);e&&e(!0)}var h,i=this,j=this.nodeAdapter;h=j.childCount(b),null===h?e&&(a.delayLinger.start(f[0].id,function(){f.addClass(Q)}),j.fetchChildNodes(b,function(c){if(a.delayLinger.finish(f[0].id,function(){f.removeClass(Q),0===c&&e(c)}),c){if(h=j.childCount(b),h>0)return void g();c=0}c===!1&&e(c)})):h>0?g():e&&e(0)},_getRoots:function(){return this.element.children("ul").children("li")},_find:function(a,b,d,e){var f,g,i,j=this,k=[];return a?(i=a.parent(),this._addChildrenIfNeeded(i),g=i.children("ul").children("li")):g=this._getRoots(),g.each(function(){if(f=j.treeMap[h(c(this))],b(f)&&(k.push(c(this).children(z)[0]),!e))return!1}),(e||0===k.length)&&(d>1||d===-1)&&g.each(function(){if(k=k.concat(j._find(c(this).children(z),b,d===-1?d:d-1,e)),k.length>0&&!e)return!1}),k},_makeParentIfNeeded:function(a){a&&0===a.prev(D).length&&(a.parent().removeClass(R).addClass(O),a.before("<span class='"+C+"'></span>"),a.after(_+aa),a.parent().children("ul").hide())},_makeLeafIfNeeded:function(a){var b=this,d=this.nodeAdapter;a.each(function(){var a,e,f=c(this);0===f.next("ul").find("li").length&&(e=f.parent(),e.hasClass(P)&&d.setExpanded&&(a=b.treeMap[h(e)],d.setExpanded(b.baseId,a,!1)),f.parent().removeClass(O+" "+P).addClass(R),f.find(b.labelSelector).removeAttr(W),f.prev(D).remove(),f.next("ul").remove())})},_addChildrenIfNeeded:function(b){var c,d,e=this.treeMap[h(b)];c=b.children("ul"),c.length>0||b.hasClass(R)||(d=a.htmlBuilder(),d.markup(_),this._renderChildren(e,i(b,this.labelSelector)+1,d),d.markup(aa),b.append(d.toString()).children("ul").hide())},_toggleNode:function(a){a.hasClass(O)?this._expandNode(a):this._collapseNode(a)},_persistExpansionState:function(a,b,c){var d=this.nodeAdapter;d.setExpanded&&d.setExpanded(this.baseId,a,c),this._trigger(ea,{},{node:a,nodeContent$:b.children(z),expanded:c})},_expandNode:function(b,d){var e,f,g=this,j=this.nodeAdapter,k=this.treeMap[h(b)];this.options.autoCollapse&&b.parent().children("."+P).each(function(){g._collapseNode(c(this))}),b.removeClass(O),e=b.children("ul"),e.length>0&&null!==j.childCount(k)?(e.show(),b.addClass(P).children(z).find(this.labelSelector).attr(W,ba),this._persistExpansionState(k,b,!0),d&&d()):(e.remove(),f=a.htmlBuilder(),f.markup(_),this._renderChildren(k,i(b,this.labelSelector)+1,f,function(a){a?(b.addClass(P).children(z).find(g.labelSelector).attr(W,ba),f.markup(aa),b.append(f.toString()),g._persistExpansionState(k,b,!0)):0===a?(b.children(D).remove(),b.addClass(R).children(z).find(g.labelSelector).removeAttr(W)):(b.addClass(O).children(z).find(g.labelSelector).attr(W,ca),g._persistExpansionState(k,b,!1)),d&&d()},b))},_collapseNode:function(a){var b=this.options;b.showRoot&&!b.collapsibleRoot&&a.parent().parent().hasClass(r)||(a.removeClass(P).addClass(O).children(z).find(this.labelSelector).attr(W,ca),a.find(J).length>0&&this._select(a.children(z),null,!0),a.children("ul").hide(),this._persistExpansionState(this.treeMap[h(a)],a,!1))},_traverseDown:function(a,b){var d,e,f;if(this.lastFocused){for(d=c(this.lastFocused).closest(u),f=0;f<b&&(e=m(d),0!==e.length);f++)d=e;d.length>0&&this._select(d.children(z),a,!0,!0)}},_traverseUp:function(a,b){var d,e,f;if(this.lastFocused){for(d=c(this.lastFocused).closest(u),f=0;f<b&&(e=n(d),0!==e.length);f++)d=e;d.length>0&&this._select(d.children(z),a,!0,!0)}},_activate:function(a){var b,c=this.options,d=this.nodeAdapter,e=this.getSelectedNodes();0!==e.length&&(this._trigger("activateNode",a,{nodes:e}),c.navigation&&d.getLink&&!a.isDefaultPrevented()&&(b=d.getLink(e[0]),b&&apex.navigation.redirect(b)))},_select:function(b,d,e,f,g){var h,i,j,k,n,o,p,q,r=b,s="set",t=this,v=this.element,w=v.find(z+J);if(d&&this.options.multiple&&("click"===d.type?d.ctrlKey||d.metaKey?s="toggle":d.shiftKey&&(s="range"):"keydown"===d.type&&(d.keyCode===c.ui.keyCode.SPACE?s=d.ctrlKey?"toggle":d.shiftKey?"range":"add":d.ctrlKey?s="none":d.shiftKey&&(s="range"))),"range"!==s||this.selectAnchor||(s="set"),"set"!==s&&"range"!==s||(w.prevAll(x).addBack().find(H).addBack().removeClass(I),w.find(this.labelSelector).attr(X,ca)),i=b.eq(0).find(this.labelSelector),b=b.not(L),k=b.hasClass(I),"set"===s||"add"===s||"toggle"===s&&!k)b.prevAll(x).addBack().find(H).addBack().addClass(I),b.find(this.labelSelector).attr(X,ba),b.parent().parents(u).each(function(){h=c(this),h.hasClass(O)&&t._expandNode(h)}),this.selectAnchor=b[0];else if("range"===s){for(j=c("#"+this.selectAnchor.parentNode.id+", #"+r[0].parentNode.id),h=j.first();;)if(h.children(z).hasClass(K)||(h.children(z).prevAll(x).addBack().find(H).addBack().addClass(I),h.children(z).find(this.labelSelector).attr(X,ba)),h=m(h),0===h.length||1===j.length||h[0]===j[1])break;h.length>0&&2===j.length&&!h.children(z).hasClass(K)&&(h.children(z).prevAll(x).addBack().find(H).addBack().addClass(I),h.children(z).find(this.labelSelector).attr(X,ba))}else"toggle"===s&&k&&(b.prevAll(x).addBack().find(H).addBack().removeClass(I),b.find(this.labelSelector).attr(X,ca),this.selectAnchor=b[0]);i.length&&(e?l(i[0]):this._setFocusable(i),this.scrollParent&&(n=this.scrollParent[0],q=i.parent().offset(),q&&(p=v.offset(),n===document?(o={top:c(document).scrollTop(),left:c(document).scrollLeft()},(q.top<o.top||q.top>o.top+c(window).height())&&c(document).scrollTop(q.top-p.top),(q.left+i.parent()[0].offsetWidth<o.left||q.left>o.left+c(window).width())&&c(document).scrollLeft(q.left-p.left)):(o=this.scrollParent.offset(),p=v.offset(),(q.top<o.top||q.top>o.top+n.offsetHeight)&&(n.scrollTop=q.top-p.top),(q.left+i.parent()[0].offsetWidth<o.left||q.left>o.left+n.offsetWidth)&&(n.scrollLeft=q.left-p.left))))),g||("toggle"===s||"range"===s&&!k||"add"===s&&!k||"set"===s&&!a.arrayEqual(w,b))&&(f?ia(t,d):ha(t,d))},_setFocusable:function(a){var b=a[0];b&&(this.lastFocused&&this.lastFocused!==b&&(this.lastFocused.tabIndex=-1),b.tabIndex=0,this.lastFocused=b)},_beginEdit:function(a){this.editMode=!0,apex.tooltipManager&&apex.tooltipManager.disableTooltips(),this._trigger("beginEdit",{},a)},_endEdit:function(a){this.editMode=!1,apex.tooltipManager&&apex.tooltipManager.enableTooltips(),this._trigger("endEdit",{},a)},_mouseCapture:function(a,b){var d,e,f,g=!0,h=this.options;if(a.preventDefault(),this.animating||h.disabled||!h.dragAndDrop||c(a.target).hasClass(C))return!1;if(e=c(a.target).closest(u).children(z),0===e.length)return!1;if(h.dragMultiple&&(e.hasClass(I)?e=this.getSelection():a.ctrlKey&&(e=e.add(this.getSelection()))),b!==!0){for(f=this.getNodes(e),d=0;d<f.length;d++)if(!this.nodeAdapter.allowDrag||!this.nodeAdapter.allowDrag(f[d])){g=!1;break}if(!g)return!1}return this.dragItems=e,!0},_mouseStart:function(a,b,d){var e,f,g=null,h=this.options,i=this;return d||(c("body").on("keydown.treeview",function(a){return a.keyCode===c.ui.keyCode.ESCAPE?void i._cancel(a):void i._dragCopyOrMove(a,!0)}),c("body").on("keyup.treeview",function(a){i._dragCopyOrMove(a,!0)}),this._select(this.dragItems,null,!0,!1)),this.helper||(this.helper=this._createHelper(b)),this.margins={left:parseInt(this.dragItems.css("marginLeft"),10)||0,top:parseInt(this.dragItems.css("marginTop"),10)||0},this.offset=this.dragItems.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},c.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset()}),this.helper.css("position","absolute"),this._cacheHelperProportions(),c.ui.ddmanager&&!d&&(this.currentItem=this.dragItems.first(),c.ui.ddmanager.current=this,c.ui.ddmanager.prepareOffsets(this,a)),this.originalPosition=this._generatePosition(b),h.dragCursorAt&&this._adjustOffsetFromHelper(h.dragCursorAt),this.dragItems&&this.dragItems.length>0&&!this.isOver&&(g=this.getNodes(this.dragItems),g[0]||(g=null)),this.nodeAdapter.dragOperations?this.dragOperations=this.nodeAdapter.dragOperations(g):this.dragOperations=g?{normal:"move",ctrl:"copy"}:{normal:"add"},this.dragOperation=this.dragOperations.normal,this.dragging=!0,this.lastHover&&(c(this.lastHover).children(A).removeClass(N),this.lastHover=null),h.dragReorder&&(f=this.dragItems.first().outerHeight(),"move"===this.dragOperation&&this.dragItems.parent().hide(),this._createPlaceholder(f),this.initialPlaceholderPos=null),this._initPositions(),this._refreshPositions(),h.dragContainment&&this._setContainment(),d||h.dragCursor&&"auto"!==h.dragCursor&&(e=this.document.find("body"),this.storedCursor=e.css("cursor"),
e.css("cursor",h.dragCursor),this.storedStylesheet=c("<style>*{ cursor: "+h.dragCursor+" !important; }</style>").appendTo(e)),h.dragOpacity&&this.helper.css("opacity",h.dragOpacity),h.dragZIndex&&this.helper.css("zIndex",h.dragZIndex),this.helper.addClass(E),this.scrollParent&&this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset(),this.originalScroll={top:this.scrollParent[0].scrollTop,left:this.scrollParent[0].scrollLeft}),apex.tooltipManager&&apex.tooltipManager.disableTooltips(),this._trigger("start",b,this._uiHashDnD()),this._mouseDrag(b),c.ui.ddmanager&&!d&&c.ui.ddmanager.dragStart(this,b),!0},_mouseDrag:function(a){var b={pageX:a.pageX,pageY:a.pageY};return this.position=this._generatePosition(a),this.positionAbs=this._adjustPositionForScroll(),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.dragEventTarget=a.target,this.options.dragScroll&&(this._scrollCheck(b)?this.scrollTimerId||this._scrollStart(b):this.scrollTimerId&&this._scrollStop()),this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",this._dragCopyOrMove(a),this._dragHitCheck(),c.ui.ddmanager&&!this.isOver&&c.ui.ddmanager.drag(this,a),this._trigger("drag",a,this._uiHashDnD()),this.lastPositionAbs=this.positionAbs,!1},_dragHitCheck:function(){function a(){var a=l.positionAbs.top-l.lastPositionAbs.top;return 0!==a&&(a>0?"down":"up")}function b(){l.delayExpandTimer&&(clearTimeout(l.delayExpandTimer),l.delayExpandTimer=null)}var d,e,f,g,h,i,j,k,l=this,m=0,n=null,o=this.dropTargetNode?this.dropTargetNode[0].id:null,p=this.options;if(this.scrollParent[0]!==document&&(m=this.scrollParent[0].scrollTop-this.dropPositionsOrigin),f=this.positionAbs.left+this.offset.click.left,f>this.containerCache.left&&f<this.containerCache.left+this.containerCache.width)if(this.placeholder&&c(this.dragEventTarget).closest("."+F).length)null===this.initialPlaceholderPos&&(this.initialPlaceholderPos=f),k=(f-this.initialPlaceholderPos)*this.rtlFactor,k>(this.options.dragScrollSensitivity||10)?(this.initialPlaceholderPos=f,this._movePlaceholder({element:this.placeholder.children(z)},"below")):k<(-this.options.dragScrollSensitivity||-10)&&(this.initialPlaceholderPos=f,this._movePlaceholder({element:this.placeholder.children(z)},"above"));else for(this.initialPlaceholderPos=null,g=this.positionAbs.top+this.offset.click.top+m,d=0;d<this.dropPositions.length;d++)if(e=this.dropPositions[d],g>=e.top&&g<=e.bottom){n=e.nodeId,i=g>e.top+(e.bottom-e.top)/2?"bottom":"top";break}o===n&&i===this.lastLocation||(b(),this.element.find("."+Y).removeClass(Y),n?(h=c("#"+n),p.dragExpandDelay>=0&&h.hasClass(O)&&(this.delayExpandTimer=setTimeout(function(){l.delayExpandTimer=null,l._expandNode(h,function(){l._initPositions(h),l._refreshPositions()})},p.dragExpandDelay)),e.canAdd?(this.dropTargetNode=h,this.placeholder?(j=a(),"top"===i&&"up"===j?this._movePlaceholder(e,"before"):"bottom"===i&&"down"===j&&this._movePlaceholder(e,"after")):this.dropTargetNode.children(z+","+x).addClass(Y)):e.canAddChild&&this.placeholder&&(this.initialPlaceholderPos=f,this._movePlaceholder(e,"after"),this._movePlaceholder({element:this.placeholder.children(z)},"below"))):this.dropTargetNode=null),this.lastLocation=i},_mouseStop:function(a,b){var d,e,f=this;return this.delayExpandTimer&&(clearTimeout(this.delayExpandTimer),this.delayExpandTimer=null),this._scrollStop(),c.ui.ddmanager&&!b&&c.ui.ddmanager.dragStop(this,a),b||c("body").off(".treeview"),this._deactivate(),this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),c.ui.ddmanager&&!b&&(d=c.ui.ddmanager.drop(this,a))?(this.placeholder&&(this.dragItems.parent().show(),this._removePlaceholder()),this.dragging=!1,this.dragItems=null,this.currentItem=null,this.helper.remove(),this.helper=null,void this._stop(a)):a.target?void(this.options.dragAnimate?(e=this._getAnimation(),this.animating=!0,this.helper.animate(e,parseInt(this.options.dragAnimate,10)||500,function(){f._finishDrag(a)})):this._finishDrag(a)):(this.fromOutside=!1,void(this.dragging=!1))},_scrollCheck:function(a,b){var d,e,f,g=0,h=0,i=this.options,j=this.scrollParent[0];return j&&j!==document&&"HTML"!==j.tagName?(this.overflowOffset.top+j.offsetHeight-a.pageY<i.dragScrollSensitivity?g=i.dragScrollSpeed:a.pageY-this.overflowOffset.top<i.dragScrollSensitivity&&(g=-i.dragScrollSpeed),b&&g&&(d=j.scrollTop+g,d<0?(j.scrollTop=0,g=0):d>j.scrollHeight-j.clientHeight?(j.scrollTop=j.scrollHeight-j.clientHeight,g=0):j.scrollTop=d),this.overflowOffset.left+j.offsetWidth-a.pageX<i.dragScrollSensitivity?h=i.dragScrollSpeed:a.pageX-this.overflowOffset.left<i.dragScrollSensitivity&&(h=-i.dragScrollSpeed),b&&h&&(e=j.scrollLeft+h,e<0?(j.scrollLeft=0,h=0):e>j.scrollWidth-j.clientWidth?(j.scrollLeft=j.scrollWidth-j.clientWidth,h=0):j.scrollLeft=e),f=!(!h&&!g)):(d=c(document).scrollTop(),e=c(document).scrollLeft(),a.pageY-d<i.dragScrollSensitivity?g=-i.dragScrollSpeed:c(window).height()-(a.pageY-d)<i.dragScrollSensitivity&&(g=i.dragScrollSpeed),b&&g&&(d+=g,d<0?(c(document).scrollTop(0),g=0):d>c(document).height()-c(window).height()?(c(document).scrollTop(c(document).height()-c(window).height()),g=0):(a.pageY+=g,c(document).scrollTop(d))),a.pageX-e<i.dragScrollSensitivity?h=-i.dragScrollSpeed:c(window).width()-(a.pageX-e)<i.dragScrollSensitivity&&(h=i.dragScrollSpeed),b&&h&&(e+=h,e<0?(c(document).scrollLeft(0),h=0):e+this.helper.width()>c(document).width()-c(window).width()?(c(document).scrollLeft(c(document).width()-c(window).width()-this.helper.width()),h=0):(a.pageX+=h,c(document).scrollLeft(e))),f=!(!h&&!g),f&&b&&(this.position=this._generatePosition(a),this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",c.ui.ddmanager&&c.ui.ddmanager.prepareOffsets(this,a))),f},_scrollStart:function(a){function b(){c.scrollTimerId=setTimeout(function(){c._scrollCheck(a,!0)?(c._dragHitCheck(),b()):c._scrollStop()},e[d]),d<e.length-1&&(d+=1)}var c=this,d=0,e=[150,125,100,99,96,91,84,75,64,51,36];this.scrollTimerId&&this._scrollStop(),b()},_scrollStop:function(){clearTimeout(this.scrollTimerId),this.scrollTimerId=null},_getAnimation:function(){var a,b,c={};return this.placeholder||this.dropTargetNode?(this.placeholder?(b=this.placeholder,a=b.offset()):(b=this.dropTargetNode,a=b.offset()),c.left=a.left-this.offset.parent.left-this.margins.left,c.top=a.top-this.offset.parent.top-this.margins.top):(b=this.dragItems.eq(0),a=this.originalPosition,c.left=a.left-this.margins.left,c.top=a.top-this.margins.top,this.scrollParent[0]!==document&&(c.left+=this.originalScroll.left-this.scrollParent[0].scrollLeft,c.top+=this.originalScroll.top-this.scrollParent[0].scrollTop)),this.rtlFactor===-1&&(c.left+=b.width()-this.helper.width()),c},_initPositions:function(a){var b,d,e,f,g,i=this,j=[],k=this.options.dragReorder,l=this.nodeAdapter;if(this.dragItems&&this.dragItems.length>0?(g=this.getNodes(this.dragItems),g[0]||(g=[])):g=[],a&&this.dropPositions)for(d=[],f=a[0].id,e=0;e<this.dropPositions.length&&f!==this.dropPositions[e].nodeId;e++);else d=this.dropPositions=[],a=this.element;if(a.find(u).each(function(){var a,b,e,f=!1,m=c(this);if(m.is(":visible")&&!m.is("."+F)){if(k?(b=m.parent().closest(u),a=b.length?i.treeMap[h(b)]:i.options.showRoot?null:l.root()):a=i.treeMap[h(m)],!k&&"move"===i.dragOperation&&(g.indexOf(a)>=0||j.indexOf(m.parent().closest(u)[0])>=0))return void j.push(this);e=a&&l.allowAdd(a,i.dragOperation,g),k&&(f=l.allowAdd(i.treeMap[h(m)],i.dragOperation,g)),(e||f||m.hasClass(O))&&d.push({canAdd:e,canAddChild:f,element:c(this).children(x),nodeId:this.id,top:0,bottom:0})}}),void 0!==e&&d.length)for(b=0;b<d.length;b++)this.dropPositions.splice(e+b,0,d[b])},_refreshPositions:function(){var a,b,c,d,e;for(a=0;a<this.dropPositions.length;a++)b=this.dropPositions[a],d=b.element.outerHeight(),c=b.element.offset(),b.top=c.top,b.bottom=c.top+d;this.dropPositionsOrigin=0,e=this.scrollParent,e&&e[0]!==document?this.dropPositionsOrigin=e[0].scrollTop:e=this.element,c=e.offset(),this.containerCache.left=c.left,this.containerCache.top=c.top,this.containerCache.width=e.outerWidth(),this.containerCache.height=e.outerHeight()},_makeTempDragItem:function(){var b,d,e,f=a.htmlBuilder();for(f.markup("<li").attr("class",s).markup("><div").attr("class",w).markup("></div><div").attr("class",y).markup(">unseen content</div></li>"),d=c(f.toString()),b=0;b<this.dropPositions.length;b++)if(this.dropPositions[b].canAdd){e=c(this.dropPositions[b].nodeId).parent();break}e||(e=this.element.children("ul")),e.append(d),this.dragItems=d.children(z)},_createPlaceholder:function(a){this.placeholder=c("<li class='"+s+" "+F+"'><div class='"+w+"'></div><div class='"+y+"'>&nbsp;</div></li>"),this.dragItems.first().parent().before(this.placeholder),a&&this.placeholder.height(a)},_movePlaceholder:function(a,b){var d,e,f,g,i,j=this,k=this.placeholder.parent(),l=this.nodeAdapter,m=a.element.parent(),n=m[0];if("after"===b&&m.hasClass(P)&&l.allowAdd(j.treeMap[h(m)],j.dragOperation)&&(n=m.children("ul").children()[0],b="before"),"above"===b){if(m.next(":visible").length)return;if(n=m.parent().parent()[0],m=c(n),e=m.parent().closest(u),i=e.length?j.treeMap[h(e)]:j.options.showRoot?null:l.root(),m.hasClass(r)||null===i)return;if(f=l.allowAdd(i,j.dragOperation),!f)return;b="after"}if("below"===b){if(d=m.prevAll(":visible").first(),g=!1,d.hasClass(P)&&(d=d.children("ul").children().last(),g=!0),0===d.length)return;if(f=l.allowAdd(j.treeMap[h(d)],j.dragOperation),!g&&d.hasClass(R)&&f&&this._makeParentIfNeeded(d.children(z)),d.hasClass(O))return void this._expandNode(d,function(){j._initPositions(d),j._refreshPositions(),f&&d.children("ul")[0].appendChild(j.placeholder[0])});f&&d[0].parentNode.appendChild(this.placeholder[0])}else"after"!==b||n.nextSibling?n.parentNode.insertBefore(this.placeholder[0],"before"===b?n:n.nextSibling):n.parentNode.appendChild(this.placeholder[0]);0===k.children().length&&this._makeLeafIfNeeded(k.parent().find(z)),this._refreshPositions()},_removePlaceholder:function(){var a=this.placeholder.parent();this.placeholder.remove(),this.placeholder=null,0===a.children().length&&this._makeLeafIfNeeded(a.parent().find(z))},_createHelper:function(a){var b,d=this.options;return c.isFunction(d.dragHelper)?b=c(d.dragHelper.apply(this.element[0],[a,this.dragItems])):1===this.dragItems.length?b=this.dragItems.clone().removeAttr("id").removeClass(I):(b=c("<div></div>"),b.html(this.dragItems.clone().removeClass(I))),b.parents("body").length||b.appendTo("parent"===d.dragAppendTo?this.element[0].parentNode:d.dragAppendTo),/(fixed|absolute)/.test(b.css("position"))||b.css("position","absolute"),b},_adjustOffsetFromHelper:function(a){"left"in a&&(this.offset.click.left=a.left+this.margins.left),"right"in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left),"top"in a&&(this.offset.click.top=a.top+this.margins.top),"bottom"in a&&(this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top)},_getParentOffset:function(){var a;return this.offsetParent=this.helper.offsetParent(),a=this.offsetParent[0]===document||this.offsetParent[0]===document.firstElementChild?{left:0,top:0}:this.offsetParent.offset(),this.scrollParent&&this.scrollParent[0]!==document&&c.contains(this.scrollParent[0],this.offsetParent[0])&&(a.left+=this.scrollParent.scrollLeft(),a.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&c.ui.ie)&&(a={top:0,left:0}),{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_generatePosition:function(a){var b=a.pageX,d=a.pageY,e=this.scrollParent&&this.scrollParent[0]!==document&&c.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return this.dragging||this.containment&&(a.pageX-this.offset.click.left<this.containment[0]&&(b=this.containment[0]+this.offset.click.left),a.pageY-this.offset.click.top<this.containment[1]&&(d=this.containment[1]+this.offset.click.top),a.pageX-this.offset.click.left>this.containment[2]&&(b=this.containment[2]+this.offset.click.left),a.pageY-this.offset.click.top>this.containment[3]&&(d=this.containment[3]+this.offset.click.top)),{top:d-this.offset.click.top-this.offset.parent.top+(f?0:e.scrollTop()),left:b-this.offset.click.left-this.offset.parent.left+(f?0:e.scrollLeft())}},_adjustPositionForScroll:function(){var a=this.position,b=this.scrollParent&&this.scrollParent[0]!==document&&c.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,d=/(html|body)/i.test(b[0].tagName);return{top:a.top+this.offset.parent.top-(d?0:b.scrollTop()),left:a.left+this.offset.parent.left-(d?0:b.scrollLeft())}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a,b,d,e=this.options;"parent"===e.dragContainment&&(e.dragContainment=this.helper[0].parentNode),"document"!==e.dragContainment&&"window"!==e.dragContainment||(this.containment=[0-this.offset.parent.left,0-this.offset.parent.top,c("document"===e.dragContainment?document:window).width()-this.helperProportions.width-this.margins.left,(c("document"===e.dragContainment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(e.dragContainment)||(a=c(e.dragContainment)[0],b=c(e.dragContainment).offset(),d="hidden"!==c(a).css("overflow"),this.containment=[b.left+(parseInt(c(a).css("borderLeftWidth"),10)||0)+(parseInt(c(a).css("paddingLeft"),10)||0)-this.margins.left,b.top+(parseInt(c(a).css("borderTopWidth"),10)||0)+(parseInt(c(a).css("paddingTop"),10)||0)-this.margins.top,b.left+(d?Math.max(a.scrollWidth,a.offsetWidth):a.offsetWidth)-(parseInt(c(a).css("borderLeftWidth"),10)||0)-(parseInt(c(a).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,b.top+(d?Math.max(a.scrollHeight,a.offsetHeight):a.offsetHeight)-(parseInt(c(a).css("borderTopWidth"),10)||0)-(parseInt(c(a).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_intersectsWith:function(a){var b=this.positionAbs.left,c=this.positionAbs.top,d=a.left,e=d+a.width,f=a.top,g=f+a.height,h=this.offset.click.top,i=this.offset.click.left,j=c+h>f&&c+h<g,k=b+i>d&&b+i<e;return j&&k},_dragCopyOrMove:function(a,b){var c,d;a.ctrlKey?c="ctrl":a.altKey?c="alt":a.shiftKey?c="shift":a.metaKey&&(c="meta"),d=this.dragOperations[c]||this.dragOperations.normal,this.dragOperation!==d&&(this.dragOperation=d,this.placeholder&&this.dragItems.parent().toggle("move"!==d),this._initPositions(),this._refreshPositions(),b&&this._trigger("drag",a,this._uiHashDnD()))},_cancel:function(a,b){function d(){f.animating=!1,f.helper&&f.helper[0].parentNode&&f.helper.remove(),f.helper=null,f.dragging=!1,f.dragItems=null,f.currentItem=null,f._stop(a)}var e,f=this;this.dragging&&(this.positionAbs.top=-99999,this._mouseUp(c.Event("mouseup",{target:null})),this.placeholder&&this.dragItems.parent().show()),this.dropTargetNode=null,this.placeholder&&this._removePlaceholder(),this.options.dragAnimate&&!b?(e=this._getAnimation(),this.animating=!0,this.helper.animate(e,parseInt(this.options.dragAnimate,10)||500,function(){d()})):d()},_deactivate:function(){this.element.find("."+Y).removeClass(Y)},_finishDrag:function(a){var c,d,e,f,i,j=!0,k=this.nodeAdapter;if(this.animating=!1,this.placeholder?(d=this.placeholder.parent().closest(u),this.dragItems.parent().show(),e=g(this.placeholder),"move"===this.dragOperation&&this.dragItems.parent().hide()):(d=this.dropTargetNode,e=0),this.fromOutside){if(this.dragItems.parent().remove(),"add"===this.dragOperation&&k.addNode)try{this.placeholder&&this._removePlaceholder(),this._add(a,d.children(z),e,null,!0)}catch(l){b.error("Error in drop add action.",l)}}else if(("copy"===this.dragOperation||"move"===this.dragOperation)&&k.allowAdd&&k["copy"===this.dragOperation?"copyNodes":"moveNodes"]&&("copy"===this.dragOperation||k.allowDelete))try{if(f=d.length||this.options.showRoot?this.treeMap[h(d)]:k.root(),k.allowAdd(f,this.dragOperation,this.dragItems)&&"move"===this.dragOperation)for(i=this.getNodes(this.dragItems),c=0;c<i.length;c++)if(!k.allowDelete(i[c])){j=!1;break}if(j&&"move"===this.dragOperation)if(this.placeholder){if(this.dragItems.last().closest(u).next()[0]===this.placeholder[0]){for(j=!1,c=0;c<this.dragItems.length-1;c++)if(this.dragItems.eq(c).closest(u).next()[0]!==this.dragItems.eq(c+1).closest(u)[0]){j=!0;break}}else if(this.dragItems.first().closest(u).prev()[0]===this.placeholder[0])for(j=!1,c=1;c<this.dragItems.length;c++)if(this.dragItems.eq(c).closest(u).prev()[0]!==this.dragItems.eq(c-1).closest(u)[0]){j=!0;break}}else for(j=!1,c=0;c<this.dragItems.length;c++)if(this.dragItems.eq(c).closest(u).parent().closest(u)[0]!==d[0]){j=!0;break}j?(this.placeholder&&this._removePlaceholder(),this._moveOrCopy(a,d.children(z),e,this.dragItems,"copy"===this.dragOperation,!0)):this.dragItems.parent().show()}catch(l){this.dragItems.parent().show(),b.error("Error in drop "+this.dragOperation+" action.",l)}this.dragging=!1,this._trigger("beforeStop",a,this._uiHashDnD()),this.dragItems=null,this.currentItem=null,this.placeholder&&this._removePlaceholder(),this.helper.remove(),this.helper=null,this.fromOutside&&this._trigger("deactivate",a,this._uiHashDnD(this)),this._stop(a),this.fromOutside=!1},_stop:function(a){apex.tooltipManager&&apex.tooltipManager.enableTooltips(),this._trigger("stop",a,this._uiHashDnD())},_add:function(b,d,e,f,g){var i,k,l=this,m=this.nodeAdapter;d&&d.length?(i=this.treeMap[h(d.parent())],k=j(d,this.labelSelector)+1):(d=null,i=m.root(),k=1),m.addNode(i,e,null,f,function(f,h){function j(){l._select(q.node$,b,g),l._trigger("added",b,q)}var m,n,o,p=a.htmlBuilder(),q={parentNode:i,parent$:d,node:f,index:h};if(!(f===!1||null===f||h<0)){if(d){if(l._makeParentIfNeeded(d),n=d.parent().children("ul"),0===n.length)return void l._expandNode(d.parent(),function(){n=d.parent().children("ul"),q.node$=n.children().eq(e).children(z),j()})}else n=l.element.children("ul");l._renderNode(f,k,p),m=c(p.toString()),q.node$=m.children(z),o=n.children(),h>=o.length?n.append(m):o.eq(h).before(m),j()}})},_moveOrCopy:function(b,d,e,f,g,i){var k,l,m=this,n=this.getNodes(f),o=g?"copyNodes":"moveNodes",p=this.nodeAdapter;d&&d.length?(k=this.treeMap[h(d.parent())],l=j(d,this.labelSelector)+1):(d=null,k=p.root(),l=1),p[o](k,e,n,function(e){function h(){for(j=0;j<x.length;j++)s=x[j],o=p.child(k,s.toIndex),s.toNode=o,w.clear(),m._renderNode(o,l,w),q=c(w.toString()),s.toNode$=q.children(z),v=t.children(":visible"),s.toIndex>=v.length?t.append(q):v.eq(s.toIndex).before(q),y.push(s.toNode$[0]),g||(r=s.fromNode$.parent().parent().closest(u).children(z),s.fromParent$=r,s.fromIndex=s.fromNode$.parent().parent().children().index(s.fromNode$.parent()),s.fromNode$.parent().remove(),m._makeLeafIfNeeded(r));m._select(c(y),b,i),m._trigger(g?"copied":"moved",b,A)}var j,n,o,q,r,s,t,v,w=a.htmlBuilder(),x=[],y=[],A={parentNode:k,parent$:d,items:x};if(e){for(j=0;j<e.length;j++)n=e[j],n>=0&&x.push({fromNode$:f.eq(j),toIndex:n});if(x.sort(function(a,b){return a.toIndex-b.toIndex}),d)return m._makeParentIfNeeded(d),t=d.parent().children("ul"),void m._expandNode(d.parent(),function(){h()});t=m.element.children("ul"),h()}})},_uiHashDnD:function(a){var b=a||this;return{helper:b.helper,placeholder:b.dropTargetNode||b.placeholder||c([]),position:b.position,originalPosition:b.originalPosition,offset:b.positionAbs,items:b.dragItems,operation:b.dragOperation,sender:a?a.element:null}}},apex.widget.contextMenuMixin));var la={root:function(){return this.data},getLabel:function(a){return a.label},getIcon:function(a){var b=this.getType(a),c=null;return a.icon||null===a.icon?c=a.icon:b.icon||null===b.icon?c=b.icon:void 0!==this.types["default"].icon&&(c=this.types["default"].icon),c},getClasses:function(a){var b=this.getType(a),c=null;return b.classes?c=b.classes:this.types["default"].classes&&(c=this.types["default"].classes),a.classes&&(c?c+=" "+a.classes:c=a.classes),c},getLink:function(a){return a.link},isDisabled:function(a){var b=this.getType(a),c=!1;return void 0!==a.isDisabled?c=a.isDisabled:void 0!==b.isDisabled?c=b.isDisabled:void 0!==this.types["default"].isDisabled&&(c=this.types["default"].isDisabled),c},child:function(a,b){if(a.children)return a.children[b]},childCount:function(a){return a.children?a.children.length:0},hasChildren:function(a){return!!a.children&&a.children.length>0},allowAdd:function(a,b,c){var d,e,f=this.getType(a),g=!!a.children&&this.check("canAdd",a,b,c);if(g&&c&&(void 0!==f.validChildren?e=f.validChildren:void 0!==this.types["default"].validChildren&&(e=this.types["default"].validChildren),e!==!0))for(d=0;d<c.length;d++)if(e.indexOf(c[d].type)<0){g=!1;break}return g},allowRename:function(a){return this.check("canRename",a)},allowDelete:function(a){return a!==this.data&&this.check("canDelete",a)},allowDrag:function(a){return this.check("canDrag",a)},dragOperations:function(a){var b,c,d;if(a){if(a.length>0){for(d=a[0].type||"default",b=1;b<a.length;b++)if(a[b].type!==d){d="default";break}}else d="default";c=this.types[d].operations&&void 0!==this.types[d].operations.drag?this.types[d].operations.drag:this.types["default"].operations.drag}else c=this.types["default"].operations.externalDrag;return c},addNode:function(a,b,d,e,f){var g,h=c.extend(!0,{},e||this.newNode(a));d&&(h.label=d),this.sortCompare?a.children.push(h):a.children.splice(b,0,h),h._parent=a,void 0!==this._nextId&&(void 0===h.id?h.id=this.nextId():this._nextId+=1),this.sortCompare&&a.children.sort(this.sortCompare),g=a.children.indexOf(h),this.validateAdd(h,g,function(b){"string"==typeof b||b===!1?(a.children.splice(g,1),f(b===!1&&null)):b&&f(h,g)})},renameNode:function(a,b,c){var d,e=a.label;a.label=b,a._parent?(this.sortCompare&&a._parent.children.sort(this.sortCompare),d=a._parent.children.indexOf(a)):d=0,this.validateRename(a,d,function(b){"string"==typeof b||b===!1?(a.label=e,c(b===!1&&null)):b&&c(a,d)})},deleteNode:function(a,b,c){var d=a._parent,e=a._parent.children.indexOf(a);d.children.splice(e,1),delete a._parent,this.validateDelete(a,c,function(c){c||(a._parent=d,d.children.splice(e,0,a)),b(c)})},moveNodes:function(a,b,c,d){var e,f,g,h,i=[];for(e=0;e<c.length;e++)f=c[e],g=f._parent,h=g.children.indexOf(f),g.children.splice(h,1),a===g&&h<b&&(b-=1),this.sortCompare?a.children.push(f):(a.children.splice(b,0,f),b+=1),f._parent=a;for(this.sortCompare&&a.children.sort(this.sortCompare),e=0;e<c.length;e++)i[e]=a.children.indexOf(c[e]);this.validateMove(a,c,i,function(a){d(!!a&&i)})},copyNodes:function(a,b,d,e){function f(a,b){var d,e=c.extend({},a);if(e._parent=b,void 0!==j._nextId&&(e.id=j.nextId()),a.children)for(e.children=[],d=0;d<a.children.length;d++)e.children.push(f(a.children[d],e));return e}var g,h,i,j=this,k=[],l=[];for(g=0;g<d.length;g++)h=d[g],i=f(h,a),k[g]=i,this.sortCompare?a.children.push(i):(a.children.splice(b,0,i),l[g]=b,b+=1);if(this.sortCompare)for(a.children.sort(this.sortCompare),g=0;g<k.length;g++)l[g]=a.children.indexOf(k[g]);this.validateCopy(a,k,l,function(a){e(!!a&&l)})},sortCompare:function(a,b){return a.label>b.label?1:a.label<b.label?-1:0},nextId:function(){var a=this._nextId;return this._nextId+=1,"tn"+a},newNode:function(a){var b,d={},e=!0,f=this.getType(a);return void 0!==this._nextId&&(d.id=this.nextId()),c.isArray(f.validChildren)?(d.type=f.validChildren[0],b=this.types[d.type],b&&b.operations&&void 0!==b.operations.canAdd?e=f.operations.canAdd:void 0!==this.types["default"].operations.canAdd&&(e=this.types["default"].operations.canAdd),b&&void 0!==b.defaultLabel?d.label=b.defaultLabel:void 0!==this.types["default"].defaultLabel&&(d.label=this.types["default"].defaultLabel)):void 0!==this.types["default"].defaultLabel&&(d.label=this.types["default"].defaultLabel),e&&(d.children=[]),d},extraCheck:function(a,b,c,d,e){return a},validateAdd:function(a,b,c){c(!0)},validateRename:function(a,b,c){c(!0)},validateDelete:function(a,b,c){c(!0)},validateMove:function(a,b,c,d){d(!0)},validateCopy:function(a,b,c,d){d(!0)},getType:function(a){var b="default";return a.type&&(b=a.type),this.types[b]||this.types["default"]},check:function(a,b,d,e){var f=!1,g=this.getType(b);return b.operations&&void 0!==b.operations[a]?f=b.operations[a]:g.operations&&void 0!==g.operations[a]?f=g.operations[a]:void 0!==this.types["default"].operations[a]&&(f=this.types["default"].operations[a]),c.isFunction(f)&&(f=f.call(this,b,d,e)),this.extraCheck(f,a,b,d,e)}};if(c.apex.treeView.makeDefaultNodeAdapter=function(a,b,d,e){function f(a,b){var c;if(a._parent=b,d&&(g._nextId+=1),a.children)for(c=0;c<a.children.length;c++)f(a.children[c],a)}var g=Object.create(la);return c.isArray(d)&&(e=d,d=!0),null!==d&&void 0!==d||(d=!0),d&&(c.apex.treeView.addViewStateMixin(g,"id",e),g._nextId=1),g.data=a,g.types=c.extend(!0,{},{"default":{isDisabled:!1,validChildren:!0,operations:{canAdd:!0,canRename:!0,canDelete:!0,canDrag:!0,drag:{normal:"move",ctrl:"copy"},externalDrag:{normal:"add"}}}},b),g.data&&f(g.data,null),g},c.apex.treeView.makeModelNodeAdapter=function(a,b,d){var e,f;if(!apex.model)throw new Error("Missing module apex.model");return b.shape="tree",e=apex.model.create(a,b,d),f=b.labelField||"label",e._labelKey=e.getFieldKey(f),e._iconKey=e.getFieldKey(b.iconField||"icon"),e._classesKey=e.getFieldKey(b.classesField||"classes"),e._linkKey=e.getFieldKey(b.linkField||"link"),e._disabledKey=e.getFieldKey(b.disabledField||"isDisabled"),b.hasIdentity&&c.apex.treeView.addViewStateMixin(e,function(a){return e.getRecordId(a)},b.initialExpandedNodeIds),e.getType=e._getType,e.getLabel=function(a){return a[this._labelKey]},e.getIcon=function(a){var b=this.getType(a),c=this._options,d=null;return this._iconKey&&(a[this._iconKey]||null===a[this._iconKey])?d=a[this._iconKey]:b.icon||null===b.icon?d=b.icon:void 0!==c.types["default"].icon&&(d=c.types["default"].icon),d},e.getClasses=function(a){var b=this.getType(a),c=this._options,d=null;return b.classes?d=b.classes:c.types["default"].classes&&(d=c.types["default"].classes),this._classesKey&&a[this._classesKey]&&(d?d+=" "+a[this._classesKey]:d=a[this._classesKey]),d},e.getLink=function(a){return this._linkKey?a[this._linkKey]:null},e.isDisabled=function(a){var b=this.getType(a),c=this._options,d=!1;return this._disabledKey&&void 0!==a[this._disabledKey]?d=a[this._disabledKey]:void 0!==b.isDisabled?d=b.isDisabled:void 0!==c.types["default"].isDisabled&&(d=c.types["default"].isDisabled),d},e.allowRename=e.allowEdit,e.addNode=function(a,b,c,d,e){var f,g,h,i=null,j=this._initRecord(d,null,a);g=a[this._childrenKey],b>=0&&b<g.length&&(i=g[b]),c&&(j[this._labelKey]=c),h=this.insertNewRecord(a,i,j),j=this.getRecord(h),f=g.indexOf(j),e(j,f)},e.renameNode=function(a,b,c){var d,e;this.setValue(a,f,b),e=this.parent(a),d=e?e[this._childrenKey].indexOf(a):0,c(a,d)},e.deleteNode=function(a,b,c){var d=this.deleteRecords([a]);b(1===d)},e.moveNodes=function(a,b,c,d){var e,f,g,h,i,j=null;for(g=a[this._childrenKey],b-=1,b>=0&&b<g.length&&(j=g[b]),h=this.moveRecords(c,a,j),e=0;e<h.length;e++)f=this.getRecord(h[e]),i[e]=g.indexOf(f);d(i)},e.copyNodes=function(a,b,c,d){var e,f,g,h,i,j=null;for(g=a[this._childrenKey],b-=1,b>=0&&b<g.length&&(j=g[b]),h=this.copyRecords(c,a,j),e=0;e<h.length;e++)f=this.getRecord(h[e]),i[e]=g.indexOf(f);d(i)},e},c.apex.treeView.treeModelListener=function(a,b){function d(a,b){function d(a){var b,d,e=[];for(b=0;b<a.length;b++)d=h.getViewId(g.baseId,a[b]),e.push(c("#"+g.baseId+d).children(z)[0]);return c(e)}var e,f;if("refresh"===a)g.refresh();else if("refreshRecords"===a||"revert"===a);else if("move"===a);else if("copy"===a);else if("insert"===a)f=d([h.parent(b.record)]),g.refresh(f);else if("clearChanges"===a);else if("delete"===a){for(f=d(b.records),e=0;e<b.records.length;e++)h.clearViewId(g.baseId,b.records[e]);g.deleteTreeNodes(f)}else"set"!==a&&"metaChange"!==a||(f=d([b.record]),g.update(f))}var e,f,g=b.data("apex-treeView"),h=g.getNodeAdapter();if(f=g.option("treeModel"),f&&(f.unSubscribe(g.option("modelViewId")),g.option("modelName")!==a&&apex.model.release(this.modelName),g.option("treeModel",null),g.option("modelName",null),g.option("modelViewId",null)),a){if(g.option("treeModel",a),f=apex.model.get(a),g.option("modelName",f),!f)throw new Error("TreeView model not found: "+a);g.option("modelViewId",f.subscribe({onChange:d,progressView:this.element})),e=f.getOption("onlyMarkForDelete")}},c.apex.treeView.addViewStateMixin=function(a,b,d){c.extend(a,{_state:{},isExpanded:function(a,b){var c=this._getExpandedNodes(a);return c[this._getIdentity(b)]||!1},setExpanded:function(a,b,c){var d=this._getExpandedNodes(a);d[this._getIdentity(b)]=c},getExpandedNodeIds:function(a){var b,c=[],d=this._getExpandedNodes(a);for(b in d)d.hasOwnProperty(b)&&d[b]===!0&&c.push(b);return c},getExpandedState:function(a){var b=this._getExpandedNodes(a);return c.extend({},b)},getViewId:function(a,b){var c=this._state[a]&&this._state[a].nodeMap;return c&&c[this._getIdentity(b)]},setViewId:function(a,b,c){var d=this._state[a]&&this._state[a].nodeMap;d||(d={},this._state[a]||(this._state[a]={}),this._state[a].nodeMap=d),d[this._getIdentity(b)]=c},clearViewId:function(a,b){var c=this._state[a]&&this._state[a].nodeMap,d=this._state[a]&&this._state[a].expandedNodes;c&&(b?(delete c[this._getIdentity(b)],d&&delete d[this._getIdentity(b)]):(this._state[a].nodeMap={},delete this._state[a].expandedNodes))},_getExpandedNodes:function(a){var b,c=this._state[a]&&this._state[a].expandedNodes;if(!c&&(this._state[a]||(this._state[a]={}),c={},this._state[a].expandedNodes=c,d))for(b=0;b<d.length;b++)c[d[b]]=!0;return c}}),a._getIdentity||(a._getIdentity=c.isFunction(b)?b:function(a){return a[b]})},c.ui.draggable&&(c.ui.plugin.add("draggable","connectToTreeView",{start:function(a,d){var e=c(this).data("ui-draggable"),f=e.options,g=c.extend({},d,{item:e.element});c("body").on("keydown.treeviewplug",function(a){a.keyCode===c.ui.keyCode.ESCAPE&&(e.dropped=!1,e.cancel())}),e.trees=[],c(f.connectToTreeView).each(function(){var d=c.data(this,"apex-treeView");d&&!d.options.disabled&&d.options.dragAndDrop?(e.trees.push({instance:d}),d._initPositions(),d._refreshPositions(),d._trigger("activate",a,g)):b.warn("Draggable connectToTreeView matches an element that is not a treeView, is disabled, or doesn't support drag and drop.")})},stop:function(a,b){var d=c(this).data("ui-draggable");c("body").off(".treeviewplug"),c.each(d.trees,function(){this.instance.isOver&&!this.invalid?(this.instance.isOver=!1,d.cancelHelperRemoval=!0,this.instance._mouseStop(a,!0),a.target||(this.instance._trigger("deactivate",a,this.instance._uiHashDnD(this.instance)),this.instance.dragItems.parent().remove(),this.instance._cancel(a,!0))):(this.instance._deactivate(),this.instance._trigger("deactivate",a,this.instance._uiHashDnD(this.instance)),this.instance.dragItems&&(this.instance.dragItems.parent().remove(),this.instance._cancel(a,!0)))})},drag:function(a,b){var d=c(this).data("ui-draggable");c.each(d.trees,function(){var c=!1;if(!this.invalid)if(this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(c=!0),c){if(!this.instance.isOver){if(this.instance.isOver=!0,this.instance._makeTempDragItem(),this.instance.helper=b.helper,this.instance.helper.css("position","relative"),a.target=this.instance.dragItems.parent().children(x)[0],!this.instance._mouseCapture(a,!0))return this.instance.isOver=!1,void(this.invalid=!0);this.instance._trigger("over",a,this.instance._uiHashDnD(this.instance)),
this.instance._mouseStart(a,a,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d}this.instance.dragItems&&this.instance._mouseDrag(a)}else this.instance.isOver&&(this.instance.isOver=!1,this.instance._trigger("out",a,this.instance._uiHashDnD(this.instance)),a.target=null,this.instance._mouseStop(a,!0),this.instance.dragItems.parent().remove(),this.instance.placeholder&&this.instance._removePlaceholder(),d.dropped=!1)})}}),c.ui.plugin.add("draggable","cursor2",{start:function(){var a=c("body"),b=c(this).data("ui-draggable"),d=b.options;d.cursor2&&"auto"!==d.cursor2&&(b.storedCursor=a.css("cursor"),a.css("cursor",d.cursor2),b.storedStylesheet=c("<style>*{ cursor: "+d.cursor2+" !important; }</style>").appendTo(a))},stop:function(){var a=c(this).data("ui-draggable");a.storedCursor&&(c("body").css("cursor",a.storedCursor),a.storedStylesheet.remove())}})),apex.widget){var ma={"default":{operations:{canAdd:!1,canDelete:!1,canRename:!1,canDrag:!1}}};apex.widget.tree={init:function(d,e,f,g){var h,i=c.extend(!0,{},ma),j=c("#"+a.escapeCSS(d),apex.gPageContext$),k=g.initialSelectedNodeId,l=g.nodeHasTooltip;g.defaultIcon&&(i["default"].icon=g.defaultIcon),g=c.extend({getNodeAdapter:function(){return(g.makeNodeAdapter||c.apex.treeView.makeDefaultNodeAdapter)(e,i,f)},tooltip:l?{show:apex.tooltipManager.defaultShowOption(),content:function(a,b){return b?b.tooltip:null}}:null,navigation:!0},g),j.treeView(g),g.regionStaticId&&apex.region.create(g.regionStaticId,{type:"Tree",widgetName:"treeView",refresh:function(){b.warn("Refresh not supported.")},focus:function(){j.treeView("focus")},widget:function(){return j}}),k&&(h=j.treeView("find",{depth:-1,findAll:!1,match:function(a){return a.id===k}}),h.length&&j.treeView("setSelection",h))},expand_all:function(b){c("#"+a.escapeCSS(b),apex.gPageContext$).treeView("expandAll")},collapse_all:function(b){c("#"+a.escapeCSS(b),apex.gPageContext$).treeView("collapseAll")},reset:function(b){var d=c("#"+a.escapeCSS(b),apex.gPageContext$);d.treeView("collapseAll").treeView("expand",d.children().children("li").first())}}}}(apex.util,apex.debug,apex.jQuery);