apex.model={},function(a,b,c,d){"use strict";function e(a){if("string"==typeof a)return[a,null];if(B(a)&&2===a.length&&"string"==typeof a[0]&&(null===a[1]||"string"==typeof a[1]))return a;throw new Error("Invalid model id")}function f(a,b){return Math.floor(a/b)*b}function g(a){var b,c;if(B(a)){for(c=[],b=0;b<a.length;b++)c.push(g(a[b]));return c}return C(a)?A(!0,{},a):a}function h(a){var b,c;if(B(a))for(c=[],b=0;b<a.length;b++)c[b]=g(a[b]);else{c={};for(b in a)a.hasOwnProperty(b)&&(c[b]=g(a[b]))}return c}function i(a,b,c){var d,e=a._listeners;for(d=0;d<e.length;d++)e[d].onChange(b,c)}function j(a,b,c,d,e){a?b.call(a,c,d,e):b(c,d,e)}function k(a){return"string"==typeof a?a:B(a)?1===a.length?""+a[0]:JSON.stringify(a):a.toString()}function l(a,b){function c(a){var b,c,d=a._listeners;for(b=0;b<d.length;b++)c=d[b].progressView,c&&c[0]&&c[0].offsetWidth&&c[0].offsetHeight&&(f.push(c),g.push(d[b].progressOptions||null))}var e,f=[],g=[];if(c(a),b)for(e=0;e<b.length;e++)c(b[e]);return 0===f.length?null:a._options.makeLoadingIndicator?a._options.makeLoadingIndicator(f,g):function(){var a,b,c=d();for(a=0;a<f.length;a++)b=apex.util.showSpinner(f[a],g[a]),c=c.add(b);return function(){c.remove()}}}function m(a,b,c,d){var e,f;return f=a,d&&(f+=" Server status: "+d),e=new Error(f),b.status>=0&&(e.status=b.status),e}function n(a,b){var c,d;delete a.error,delete a.warning,delete a.message;for(c in a.fields)a.fields.hasOwnProperty(c)&&(d=a.fields[c],b||delete d.changed,delete d.error,delete d.warning,delete d.message)}function o(a,b,c,d,e){var f;return b===-1&&(b=0),c===-1&&(c=b+a*d),f=c-b,b+f/(d+1)*e}function p(a){return new Error("Model has invalid shape for the "+a+" method")}function q(a){var b,c=e(a);return b=w[c[0]],b&&(b=c[1]?b.instances[c[1]]:b.model),b}function r(a,b,c,d){function f(a){for(var b,c=a,d=e(c.modelId());d;){if(d[0]===l[0]&&(d[1]===l[1]||null===l[1]))return!0;d=null,b=c.getOption("parentModel"),b&&(c=q(b),c&&(d=e(b)))}return!1}function g(d){var e=!(!c&&!d._options.regionId);return e&&("change"===a?e=d.isChanged():"error"===a&&(e=d.hasErrors()),e&&b&&(e=f(d))),e}function h(a,b){m.push({id:a,model:b})}function i(a,b){var c;a.model&&g(a.model)&&h(b,a.model);for(c in a.instances)a.instances.hasOwnProperty(c)&&g(a.instances[c])&&h([b,c],a.instances[c])}var j,k,l=d?e(d):null,m=[];if(l||(b=!1),!b&&l&&l[0])k=l[0],j=w[k],j&&(l[1]?j.instances[l[1]]&&g(j.instances[l[1]])&&h([k,l[1]],j.instances[l[1]]):i(j,k));else for(k in w)w.hasOwnProperty(k)&&(j=w[k],i(j,k));return m}function s(a){var b;b=x.indexOf(a),b>=0&&x.splice(b,1)}function t(a){var b;b=x.indexOf(a),b>=0&&x.splice(b,1),x.push(a)}function u(){var a,b;for(a=0;a<x.length;a++)if(b=x[a],!b.isChanged())return b;return null}var v=10,w={},x=[],y=100,z=v,A=d.extend,B=d.isArray,C=d.isPlainObject,D=d.isFunction,E=d.Deferred,F={modelId:function(){return null===this.instance?this.name:[this.name,this.instance]},fetch:function(a,b,c){function e(a){var b,c=r._data;if(0===a)return 0;for(b=a;b<c.length&&void 0!==c[b];b++);return b}var g,h,i,j,k,n,o,p,q,r=this,s=this._options,t=E();if("number"!=typeof a&&(c=b,b=a,a=0),"table"===s.shape){if(q=f(a,s.pageSize),a=e(q),this._haveAllData&&a>=this._data.length||this._masterRecordIsInserted||this._masterRecordIsDeleted)return!1;p=this._getServerOffset(a),o=q+s.pageSize-a,o<s.pageSize&&void 0===this._data[q+s.pageSize]&&(o+=s.pageSize),k={version:s.version,firstRow:p+1,maxRows:o}}else k={version:s.version};return this._requestsInProgress.fetch?null:(n=A({},s.regionData,{id:s.regionId,ajaxIdentifier:s.ajaxIdentifier,fetchData:A({},s.fetchData,k)}),i={regions:[n]},s.pageItemsToSubmit&&(i.pageItems=s.pageItemsToSubmit),this._addParentItems(i.regions[0]),j=d.extend({},s.requestOptions),c?delete j.loadingIndicator:j.loadingIndicator=l(this),this._requestsInProgress.fetch=!0,g=this._callServer(i,j),g.done(function(b){var c,d=null,e=null,f=null,g=null,h=null;delete r._requestsInProgress.fetch,r._requestsInProgress.abortFetch?(delete r._requestsInProgress.abortFetch,t.reject(m("Error: Aborted when model cleared",{status:0},"abort"))):(c=b.regions[0].fetchedData,"table"===s.shape?(d=c.values,e=c.totalRows,f=c.firstRow-1,g=c.moreData,h=c.dataOverflow):"tree"===s.shape?d=c.root:"record"===s.shape&&(d=c.value),r._addData(a,f,d,e,g,h),t.resolve())}).fail(function(a,b,c){delete r._requestsInProgress.fetch,t.reject(m("Error retrieving data.",a,b,c))}),h=t.promise(),b&&h.always(b),h.always(function(a){r._drainWaiters(a)}),h)},fetchAll:function(a){function b(){var e=c.fetch(d,function(e){e?a({error:e}):(a({offset:d,total:c.getTotalRecords(),done:!1}),d+=f,b())},!0);null===e?setTimeout(function(){b()},500):e===!1&&a({offset:d,total:c.getTotalRecords(),done:!0})}var c=this,d=0,e=this._options,f=e.pageSize;if("table"!==e.shape)throw p("fetchAll");for(;this._data[d];)d+=1;b()},fetchRecords:function(a,b){var c,e,f,g,h,i,j,k,n=this,o=this._options,q=[],r=E();if("record"===o.shape)throw p("fetchRecords");if(void 0===this._identityKeys)throw new Error("Model must have identityField defined");for(c=0;c<a.length;c++)f=this._getIdentity(a[c]),g=this.getRecordMetadata(f),g&&!g.inserted&&q.push({recordId:f,pk:this._getPrimaryKey(a[c])});return 0===q.length?null:(k=A({},o.regionData,{id:o.regionId,ajaxIdentifier:o.ajaxIdentifier,fetchData:A({},o.fetchData,{version:o.version,primaryKeys:q})}),i={regions:[k]},o.pageItemsToSubmit&&(i.pageItems=o.pageItemsToSubmit),this._addParentItems(i.regions[0]),j=d.extend({},o.requestOptions,{loadingIndicator:l(this)}),e=this._callServer(i,j),e.done(function(a){var b,c;b=a.regions[0].fetchedData,c=b.values,n._updateData(c),r.resolve()}).fail(function(a,b,c){r.reject(m("Error retrieving data.",a,b,c))}),h=r.promise(),b&&h.always(b),h)},save:function(a){var b,c,e,f,g,h=this._options,i=E();return g=d.extend({},h.requestOptions,{loadingIndicator:l(this)}),f={},(c=this.addChangesToSaveRequest(f))?(b=this._callServer(f,g),c(b),b.done(function(a){a.errors?i.reject(a.errors):i.resolve(null,a)}).fail(function(a,b,c){i.reject(m("Error saving data.",a,b,c))}),e=i.promise(),a&&e.always(a),e):null},saveInProgress:function(){return!!this._requestsInProgress.save},addChangesToSaveRequest:function(a){function b(){delete o._requestsInProgress.save,o._changes=o._pendingChanges.concat(o._changes)}function c(a){var b,c,d,e,f,h,i,j=a.record;for(h=a.inserted&&!a.originalId,c=p.recordIsArray?[]:{},b=0;b<s.length;b++)e=s[b],d=j[e],null!==d&&"object"==typeof d&&d.hasOwnProperty("v")&&(d=d.v),i=t[e],a.fields&&a.fields[i]&&a.fields[i].disabled&&(d=""),!h||!o.isIdentityField(i)||a.original&&d!==a.original[e]||(d=""),p.recordIsArray?c.push(g(d)):c[e]=g(d);f=null,a.deleted?f="d":a.inserted?f="i":a.updated&&(f="u"),c[q]||(c[q]={}),f&&(c[q].op=f),c[q].recordId=o._getIdentity(j),a.originalId&&(c[q].originalId=a.originalId),p.saveSelection&&(c[q].sel=a.sel?"Y":"N"),u.push(c)}var d,e,f,h,i,j,k,l,m,n,o=this,p=this._options,q=this._metaKey,r=[],s=[],t={},u=[],v=0;if(p.pageItemsToSubmit&&(h=a.pageItems,h||(h=[],a.pageItems=h),B(h)))for(i=p.pageItemsToSubmit,B(i)||(i=i.replace(/#/g,"").split(/\s*,\s*/)),d=0;d<i.length;d++)h.indexOf(i[d])<0&&h.push(i[d]);if(this._requestsInProgress.save||0===this._changes.length&&!p.saveSelection)return null;for(d in p.fields)p.fields.hasOwnProperty(d)&&(e=p.fields[d],e.virtual||(v+=1),e["volatile"]||e.virtual||(f=p.recordIsArray?e.index:d,s.push(f),t[f]=d,p.recordIsArray&&e.index===this._metaKey&&(q=s.length-1)));for(p.recordIsArray&&s.sort(function(a,b){return a-b}),q||(q=p.recordIsArray?s.length:"_meta"),d=0;d<this._changes.length;d++)j=this._changes[d],j.autoInserted&&!j.updated&&r.push(j.record);for(r.length&&this.deleteRecords(r),d=0;d<this._changes.length;d++)j=this._changes[d],c(j);if(this._pendingChanges=this._changes,this._changes=[],p.saveSelection)for(d in this._selection)this._selection.hasOwnProperty(d)&&(j=this._selection[d],j.inserted||j.deleted||j.updated||c(j));for(k=a.regions,k||(a.regions=k=[]),d=0;d<k.length&&(l=k[d],l.id!==p.regionId);d++)l=null;return l||(l=A({},p.regionData,{id:p.regionId,ajaxIdentifier:p.ajaxIdentifier,saveData:{models:[]}}),k.push(l)),m=l.saveData.models,n=A({},p.saveData,{instance:this.instance,version:p.version,values:u}),this._addParentItems(n),m.push(n),this._requestsInProgress.save=!0,function(a){a.done(function(a){var c,d,e,f,g,h,i;if(o._requestsInProgress.abortSave)delete o._requestsInProgress.abortSave,b();else if(a.errors){for(c=0;c<a.errors.length;c++)h=a.errors[c],h.regionStaticId===p.regionStaticId&&h.recordId&&h.instance==o.instance&&o.setValidity("error",h.recordId,h.columnName||null,h.message);b()}else if(a.regions){for(g=null,c=0;c<a.regions.length;c++){if(e=a.regions[c],e.id===p.regionId){for(f=e.fetchedData.models,d=0;d<f.length;d++)if(f[d].instance==o.instance){g=f[d].values,o._metaKey||(i=p.recordIsArray?v:"_meta"),o._updateData(g,i);break}break}e=null}o._clearChanges("_pendingChanges")}delete o._requestsInProgress.save}).fail(function(a,c,d){b()})}},setData:function(a,b){b=b||0,this._addData(b,b,a,a?a.length:null,!1,!1),i(this,"refresh",{})},clearData:function(){this._clear(),i(this,"refresh",{})},getTotalRecords:function(){var a,b,c=this._options;if("table"===c.shape)return this._haveAllData||"none"===c.paginationType?this._data.length:this._totalRecords<0?this._totalRecords:Math.max(this._data.length,this._totalRecords);if("record"===c.shape)return 1;if("tree"===c.shape){b=0;for(a in this._index)this._index.hasOwnProperty(a)&&(b+=1);return b}},getServerTotalRecords:function(){var a=this._options;return"table"===a.shape?this._totalRecords<0?this._totalRecords:this._totalRecords+this._numInsertedRecords-this._numDeletedRecords:"record"===a.shape?1:"tree"===a.shape?-1:void 0},getDataOverflow:function(){return!!this.dataOverflow},forEach:function(a,b){var c,d,e,f=this,g=this._options,h=this._data;if("record"===g.shape)throw p("forEach");if("tree"===g.shape)c=0,h&&this.walkTree(h,{node:function(d){j(b,a,d,c,f._getIdentity(d)),c+=1}});else for(e=h.length,c=0;c<e;c++)d=h[c],d&&j(b,a,d,c,this._getIdentity(d,c))},transform:function(a,b){function c(a,b){var c;return c=a[b],c||(c={values:{},paths:[]},a[b]=c),c}function d(a,b,d,e,f,g){var h,i,j,k,l,m,n,o,q;if(a){for(l=a.split("/"),m=e,o=null,q=null,j=null,h=0;h<l.length;h++){if(j=l[h],i=p.exec(j)){n=c(g,i[1]),n.paths[b]=l.slice(h+1).join("/");break}o=m,q=j,m.hasOwnProperty(j)||(m[j]={}),m=m[j]}o?(B(o[q])?(k=o[q],k.length=0):k=[],o[q]=k):k=e,f[b]=k}else{if(!B(e))throw new Error("Context must be an array when there is no path");f[b]=e}d&&(n=c(g,d))}function e(){var a,c;for(a=0;a<q.length;a++)c=q[a],d(c.path,a,c.uniqueIndexField,b,t,u)}function f(a,b,c,d,e){var f,g,i;for(f in a)a.hasOwnProperty(f)&&(g=a[f],i=h(g,c,d,e),void 0!==i&&(b[f]=i));return b}function g(a,b,c,d,e){var f,g,i;for(f=0;f<a.length;f++)g=a[f],i=h(g,c,d,e),void 0!==i&&(b[f]=i);return b}function h(a,c,d,e){var h,i,j,k,l=!1;return"string"==typeof a?(h=a.length,j=a.charAt(0),k=a.charAt(h-1),"'"===j&&"'"===k?a.substring(1,h-1):("("===j&&")"===k&&(a=a.substring(1,h-1),l=!0),i=v.getValue(c,a),null!==i&&"object"==typeof i&&i.hasOwnProperty("d")&&(i=l?i.v:i.d),l||!r||null!==i&&""!==i||(i=r),i)):D(a)?a.call(b,v,c,d,e):null===a?a:B(a)?g(a,[],c,d,e):"object"==typeof a?f(a,{},c,d,e):void 0}function i(a,b,c,d){var e,f,g,i=[];if(a)for(a=a.split("/"),e=0;e<a.length;e++)f=a[e],g=p.exec(f),g&&i.push({key:g[1],value:h(g[1],b,c,d)});return i}function j(e,f,g){var j,k,l,m,p,r,w,x,y,z,A;if(!(f<n||o>0&&f>=n+o)&&(a.includeAggregates||!v._metaKey||!e[v._metaKey].agg)&&(!a.filter||a.filter.call(b,v,e,f,g)))for(j=0;j<s;j++)if(r=null,l=q[j],m=t[j],!l.filter||l.filter.call(b,v,e,f,g)){if(l.uniqueIndexField&&(r=u[l.uniqueIndexField],w=h(l.uniqueIndexField,e,f,g),void 0!==r.values[w]))continue;if(p=h(l.item,e,f,g),void 0!==p){if(r)r.values[w]={index:m.length,arrays:[],indexes:{}};else for(x=i(l.path,e,f,g),A=u,k=0;k<x.length;k++)r=c(A,x[k].key),y=r.values[x[k].value],void 0===y&&(y={index:m.length,arrays:[],indexes:{}},z=""===r.paths[j]?[]:{},m.push(z),r.values[x[k].value]=y),z=m[y.index],y.arrays[j]||d(r.paths[j],j,null,z,y.arrays,y.indexes),m=y.arrays[j],A=y.indexes;m.push(p)}}}var k,l,m,n,o,p=/^\[\W*([^ \t\/]+)\W*\]$/,q=a.template,r=a.showNullAs,s=q.length,t=[],u={},v=this;for(null!==b&&"object"==typeof b||(b={}),e(),n=0,a.offset>=0&&(n=a.offset),o=a.fetchData?this._options.pageSize:null,a.count>0&&(o=a.count),a.fetchData?this.forEachInPage(n,o,j):this.forEach(j),k=0;k<s;k++)l=q[k],m=t[k],l.sort&&m.array.sort(l.sort);return b},forEachInPage:function(a,b,d,e){function f(f){var g,h,i=b-(f-a);c.trace("Model: "+m.modelId()+". forEachInPage fetching more data starting at: ",f),m._waitingPages.push({offset:f,callback:d,thisArg:e,next:function(){m.forEachInPage(f,i,d,e)}}),m._requestsInProgress.fetch||(h=m.fetch(f,function(a){a||setTimeout(function(){m._waitingPages.length>0&&(g=m._waitingPages.shift(),g.next())},1)}),h||(m._waitingPages.pop(),j(e,d,null,-1,null)))}var g,h,i,k,l=a,m=this,n=this._options,o=this._data;if("table"!==n.shape)throw p("forEachInPage");if(b>n.pageSize&&(n.pageSize=10*Math.floor((b+9)/10)),"one"===n.paginationType&&(l=a-this._offset),l<0||l>=o.length)return void(this._haveAllData?(j(e,d,null,-1,null),this._drainWaiters()):f(a));for(h=l+b,k=a,g=l;g<h;g++){if(i=o[g],void 0===i)return void(this._haveAllData&&g>=o.length?(j(e,d,null,-1,null),this._drainWaiters()):f(g+this._offset));i&&(j(e,d,i,k,this._getIdentity(i,g)),k+=1)}this._drainWaiters()},indexOf:function(a){var b,c=this._options;if("record"===c.shape)throw p("indexOf");return"tree"===c.shape?(b=this.getRecordMetadata(this._getIdentity(a)),b&&b.parent?b.parent[this._childrenKey].indexOf(a):-1):this._data.indexOf(a)},recordAt:function(a){if("table"!==this._options.shape)throw p("recordAt");return this._data[a]||null},getRecordId:function(a){return this._getIdentity(a)},isIdentityField:function(a){return void 0!==this._identityKeys&&this._identityKeys.indexOf(this.getFieldKey(a))>=0},getRecordMetadata:function(a){var b=this._index[k(a)];return b||null},metadataChanged:function(a,b){var c=this._index[k(a)];c&&i(this,"metaChange",{record:c.record,recordId:a,field:b||null})},getTypeMetadata:function(a){return this._options.types[a]||null},getFieldMetadata:function(a){return this._options.fields[a]||null},getFieldKey:function(a){var b=this._options;if(b.fields.hasOwnProperty(a)&&!b.fields[a].virtual)return b.recordIsArray?b.fields[a].index:a},isChanged:function(){var a,b,c;if(0===this._changes.length)return!1;for(c=0,a=0;a<this._changes.length;a++)b=this._changes[a],b.autoInserted&&!b.updated||(c+=1);return c>0},getChanges:function(){return this._changes},clearChanges:function(){this._clearChanges("_changes")},hasErrors:function(){return this._errors.length>0},getErrors:function(){return this._errors},setSelectionState:function(a,b){var c=k(a),d=this._index[c];d&&(b=!!b,d.sel!==b&&(d.sel=b,b?(this._selection[c]=d,this._selectionCount+=1):(delete this._selection[c],this._selectionCount-=1)))},clearSelection:function(){var a;for(a in this._selection)this._selection.hasOwnProperty(a)&&(this._selection[a].sel=!1);this._selection={},this._selectionCount=0},getSelectedCount:function(){return this._selectionCount},getSelectedRecords:function(){var a,b=this._selection,c=[];for(a in b)b.hasOwnProperty(a)&&c.push(b[a].record);return c},allowEdit:function(a){return this.check("canEdit",a)},allowDelete:function(a){var b=this._options;return"record"!==b.shape&&("tree"!==b.shape||a!==this._data)&&this.check("canDelete",a)},allowAdd:function(a,b,c){var d,e,f,g,h=this._options;if("record"===h.shape)return!1;if(!("tree"!==h.shape||a&&a[this._childrenKey]))return!1;if(f=this.check("canAdd",a,b,c),f&&c&&"tree"===h.shape&&(g=this._getType(a),e=void 0!==g.validChildren?g.validChildren:void 0===h.types["default"].validChildren||h.types["default"].validChildren,e!==!0))for(d=0;d<c.length;d++)if(e.indexOf(c[d][this._typeKey])<0){f=!1;break}return f},allowDrag:function(a){var b=this._options;return"record"!==b.shape&&this.check("canDrag",a)},dragOperations:function(a){var b,c,d,e=this._options;if(a){if(a.length>0&&this._typeKey){for(d=a[0][this._typeKey]||"default",b=1;b<a.length;b++)if((a[b][this._typeKey]||"default")!==d){d="default";break}}else d="default";c=e.types[d].operations&&void 0!==e.types[d].operations.drag?e.types[d].operations.drag:e.types["default"].operations.drag}else c=e.types["default"].operations.externalDrag;return c},check:function(a,b,c,d){var e,f=!1,g=this._options,h=this._getType(b);if(!g.editable||this._masterRecordIsDeleted)return!1;if(b&&(e=this.getRecordMetadata(this._getIdentity(b)))){if(e.deleted||e.agg)return!1;if(e.inserted&&("canEdit"===a||"canDelete"===a))return!0}return e&&void 0!==e[a]?f=e[a]:h.operations&&void 0!==h.operations[a]?f=h.operations[a]:void 0!==g.types["default"].operations[a]&&(f=g.types["default"].operations[a]),D(f)&&(f=f.call(this,b,c,d)),D(g.check)&&(f=g.check(f,a,b,c,d)),f},getValue:function(a,b){var c;return void 0===b&&(b=a,a=this._data),c=this.getFieldKey(b),a[c]},setValue:function(a,b,c,d){function e(a,b){var c,d=a,e=b;if(null!==a&&"object"==typeof a&&a.hasOwnProperty("v")&&(d=a.v,null!==b&&"object"==typeof b&&b.hasOwnProperty("v")&&(e=b.v)),B(d)&&B(e)){if(d.length!==e.length)return!1;for(c=0;c<d.length;c++)if(d[c]!=e[c])return!1;return!0}return d==e}var f,g,j,k,l,m,n,o,p,q,r=this._options,s=!1;if(void 0===c&&(c=b,b=a,a=this._data),j=this.getFieldKey(b),!this.allowEdit(a))throw new Error("Set value not allowed for record.");if(n=this._getIdentity(a),k=this.getRecordMetadata(n),!k)return null;if(void 0===j||r.fields[b].readonly&&!r.fields[b].parentField||k.fields&&k.fields[b]&&k.fields[b].ck)throw new Error("Set value not allowed for field.");if(g=a[j],!e(g,c)){if(!d&&(b===r.sequenceField||b===r.parentIdentityField))if(o=p=q=null,b===r.sequenceField){if("tree"===r.shape?(p=this.parent(),p&&(o=p[this._childrenKey])):o=this._data,o)for(f=0;f<o.length&&!(parseFloat(o[f][this._sequenceKey])>parseFloat(c));f++)q=o[f]}else b===r.parentIdentityField&&(p=this.getRecord(c));if(k.original||(k.original=h(a),s=!0),a[j]=c,m=this._getIdentity(a),m!==n){if(this._index[m])return a[j]=g,s&&delete k.original,"DUP";k.originalId||(k.originalId=n),delete this._index[n],this._index[m]=k,k.sel&&(delete this._selection[n],this._selection[m]=k)}return k.updated||k.deleted||k.inserted||this._addChange(k),k.updated=!0,k.fields||(k.fields={}),l=k.fields[b],l||(l={},k.fields[b]=l),l.changed=!0,(k.error||k.warning)&&this.setValidity("valid",m),i(this,"set",{oldValue:g,oldIdentity:m!==n?n:null,recordId:m,record:a,field:b}),(p||q)&&this.moveRecords([a],p,q),"SET"}return"NC"},getRecordValue:function(a,b){return this.getValue(this.getRecord(a),b)},setRecordValue:function(a,b,c){this.setValue(this.getRecord(a),b,c)},setValidity:function(a,b,c,d){var e,f,g,h,i,j,l,m=this._index[k(b)];if(m&&(c?(m.fields||(m.fields={}),g=m.fields[c],g||(g={},m.fields[c]=g)):g=m,j="valid",l=g.message||d,g.warning&&(j="warning"),g.error&&(j="error"),a!==j||l!==d)){switch(a){case"error":f="error",delete g.warning;break;case"warning":f="warning",delete g.error;break;case"valid":delete g.error,delete g.warning,delete g.message;break;default:throw new Error("Invalid value for pValidity parameter: "+a)}if(f&&(g[f]=!0,g.message=d),h=m.error,!h&&m.fields)for(e in m.fields)if(m.fields.hasOwnProperty(e)&&m.fields[e].error){h=!0;break}h?(i=this._errors.indexOf(m),i>=0&&this._errors.splice(i,1),this._errors.push(m)):this._removeError(m),this.metadataChanged(b,c)}},deleteRecords:function(a){var b,d,e,f,g=[],h=[],j=this._options;if("record"===j.shape)throw p("deleteRecords");for(b=0;b<a.length;b++)f=a[b],e=this._getIdentity(f),d=this.getRecordMetadata(e),d?this.allowDelete(f)?("table"===j.shape&&(this._numDeletedRecords+=1),j.onlyMarkForDelete&&!d.inserted||("table"===j.shape&&d.inserted&&(this._numDeletedRecords-=1,this._numInsertedRecords-=1),this._removeRecord(e,d)),d.inserted?(delete d.inserted,delete d.autoInserted,delete d.updated,this._removeError(d),this._removeChange(d)):(n(d,!0),this._removeError(d),d.deleted=!0,this._addChange(d)),g.push(f),h.push(e)):c.warn("Delete not allowed for record: "+e):c.warn("Record to delete not found: "+e);return g.length>0&&i(this,"delete",{records:g,recordIds:h}),g.length},canRevertRecord:function(a){var b;return b=this.getRecordMetadata(this._getIdentity(a)),!(!b||!b.original&&!b.deleted)},revertRecords:function(a){var b,d,e,f,g,h,j={},k=[],l=[],m=this._options;for(b=0;b<a.length;b++)e=a[b],f=this._getIdentity(e),d=this.getRecordMetadata(f),d?d.original||d.deleted?("table"===m.shape?g=this._data:"tree"===m.shape&&(g=this.parent(d.record)[this._childrenKey]),h=g.indexOf(d.record),d.deleted?("table"===m.shape&&(this._numDeletedRecords-=1),delete d.deleted):(d.originalId&&(this._index[d.originalId]=d,delete this._index[f],d.sel&&(this._selection[d.originalId]=d,delete this._selection[f]),j[f]=d.originalId,delete d.originalId),d.original&&(d.record=d.original,delete d.original),delete d.updated,n(d),this._removeError(d)),this._removeChange(d),e=d.record,g[h]!==e&&(g[h]=e),k.push(e),l.push(f)):c.warn("Nothing to revert for record "+f):c.warn("Record to revert not found: "+f);return k.length>0&&i(this,"revert",{records:k,recordIds:l,newIds:j}),k.length},insertNewRecord:function(a,b,c){var d,e,f,g,h,j,k,l=this._options,m=null;if("record"===l.shape)throw p("insertNewRecord");if(g=this._initRecord(c,null,a),!this.allowAdd(a,"new",[g]))throw new Error("Insert not allowed for new record.");return h="tree"===l.shape?a?a[this._childrenKey]:this._data[this._childrenKey]:this._data,e=0,b&&(m=this._getIdentity(b),d=this.getRecordMetadata(m),d&&(e=h.indexOf(d.record)+1)),this._sequenceKey&&(j=k=-1,e-1>=0&&(j=parseFloat(h[e-1][this._sequenceKey])),e<h.length&&(k=parseFloat(h[e][this._sequenceKey])),g[this._sequenceKey]=""+o(l.sequenceStep,j,k,1,1)),h.splice(e,0,g),f=this._getIdentity(g),d={record:g,inserted:!0},this._index[f]=d,this._addChange(d),"tree"===l.shape?d.parent=a:this._numInsertedRecords+=1,i(this,"insert",{record:g,recordId:f,insertAfterId:m}),f},moveRecords:function(a,b,d){var e,f,g,h,j,k,l,m,n,q,r=this._options,s=[],t=[],u=null;if("record"===r.shape)throw p("moveRecords");for("tree"===r.shape?(b||(b=this._data),h=b[this._childrenKey]):h=this._data,g=0,d&&(u=this._getIdentity(d),f=this.getRecordMetadata(u),f&&(g=h.indexOf(f.record)+1),(!f||g<0)&&(c.warn("AfterRecord not found, move to beginning."),g=0)),this._sequenceKey&&(n=q=-1,g-1>=0&&(n=parseFloat(h[g-1][this._sequenceKey])),g<h.length&&(q=parseFloat(h[g][this._sequenceKey]))),e=0;e<a.length;e++)if(l=a[e],m=this._getIdentity(l),f=this.getRecordMetadata(m)){if("tree"===r.shape){if(j=this.parent(l),!j){c.warn("Move not allowed for root");continue}j=j[this._childrenKey]}else j=h;k=j.indexOf(l),j.splice(k,1),h===j&&k<g&&(g-=1),t.push(l),s.push(m),h.splice(g,0,l),g+=1,this._sequenceKey&&this.setValue(l,r.sequenceField,""+o(r.sequenceStep,n,q,a.length,e+1),!0),"tree"===r.shape&&(f.parent=b,this._parentIdKey&&this.setValue(l,r.parentIdentityField,this._getIdentity(b),!0))}else c.warn("Record to move not found: "+m);return i(this,"move",{records:t,recordIds:s,insertAfterId:u}),s},copyRecords:function(a,b,d){var e,f,g,h,j,k,l,m,n,q,r,s=this,t=this._options,u=[],v=[],w=null;if("record"===t.shape)throw p("copyRecords");for("tree"===t.shape?(n={node:function(a,b){var c,d;b&&(c=s._getIdentity(a),d={record:a,inserted:!0,parent:b},s._index[c]=d,s._addChange(d))}},b||(b=this._data),l=b[this._childrenKey]):l=this._data,g=0,d&&(w=this._getIdentity(d),f=this.getRecordMetadata(w),f&&(g=l.indexOf(f.record)+1),(!f||g<0)&&(c.warn("AfterRecord not found, copy to beginning."),g=0)),this._sequenceKey&&(q=r=-1,g-1>=0&&(q=parseFloat(l[g-1][this._sequenceKey])),g<l.length&&(r=parseFloat(l[g][this._sequenceKey]))),e=0;e<a.length;e++)h=a[e],k=this._getIdentity(h),f=this.getRecordMetadata(k),f?(j=this._initRecord(null,a[e],b),l.splice(g,0,j),g+=1,this._sequenceKey&&(j[this._sequenceKey]=""+o(t.sequenceStep,q,r,a.length,e+1)),m=this._getIdentity(j),v.push(j),u.push(m),f={record:j,inserted:!0},this._index[m]=f,this._addChange(f),"tree"===t.shape?(f.parent=b,this.walkTree(j,n,null)):this._numInsertedRecords+=1):c.warn("Record to copy not found: "+k);return i(this,"copy",{records:v,recordIds:u,insertAfterId:w}),u},root:function(){if("tree"!==this._options.shape)throw p("root");return this._data},child:function(a,b){var c=a[this._childrenKey];if(c)return c[b]},parent:function(a){var b,c;if(this._identityKeys&&(b=this._getIdentity(a),c=this.getRecordMetadata(b),c&&c.hasOwnProperty("parent")))return c.parent?c.parent:null},childCount:function(a){var b=a[this._childrenKey];return null===b?null:b?b.length:0},hasChildren:function(a){var b=a[this._childrenKey];return null===b?null:!!b&&b.length>0},fetchChildNodes:function(a,b){var c,e,f,g,h,i=this,j=this._options,k=E();return h=A({},j.regionData,{id:j.regionId,ajaxIdentifier:j.ajaxIdentifier,fetchData:A({},j.fetchData,{version:j.version,parentId:this._getPrimaryKey(a)})}),f={regions:[h]},j.pageItemsToSubmit&&(f.pageItems=j.pageItemsToSubmit),this._addParentItems(f.regions[0]),g=d.extend({},j.requestOptions,{loadingIndicator:l(this)}),c=this._callServer(f,g),c.done(function(b){var c=b[i._childrenKey];i._addData(a,null,c),k.resolve(c.length)}).fail(function(a,b,c){k.reject(m("Error retrieving data.",a,b,c))}),e=k.promise(),b&&e.always(b),e},clearChildNodes:function(a){a[this._childrenKey];a[this._childrenKey]=null},walkTree:function(a,b,c){var d,e,f,g,h;if(void 0===c&&(c=null,e=this._getIdentity(a),e&&(f=this.getRecordMetadata(e),f&&(c=f))),h=b.node(a,c),!h&&(g=a[this._childrenKey],g&&g.length>0)){for(b.beginChildren&&b.beginChildren(a),d=0;d<g.length;d++)this.walkTree(g[d],b,a);b.endChildren&&b.endChildren(a)}},subscribe:function(a){var b=a.viewId;return b||(b="v::"+y,y+=1,a.viewId=b),this._listeners.push(a),b},unSubscribe:function(a){var b;for(b=0;b<this._listeners.length;b++)this._listeners[b].viewId===a&&this._listeners.splice(b,1)},getOption:function(a){var b=this._options[a];if(void 0===b)throw new Error("No such option: "+a);return b},setOption:function(a,b){var d={genIdPrefix:1,pageItemsToSubmit:1,fetchData:1,saveData:1,regionData:1,requestOptions:1,parentRecordId:1,editable:1,pageSize:1};if(d[a]){if("editable"===a&&!this._options.identityField)throw new Error("An editable model requires an identityField");this._options[a]=b}else c.warn("Option cannot be set: "+a)},_callServer:function(a,c){var d;return d=(this._options.callServer||b.plugin)(a,c)},_drainWaiters:function(a){var b,c;for(b=0;b<this._waitingPages.length;b++)if(c=this._waitingPages[b],(this._haveAllData||this._data[c.offset]||a)&&(this._waitingPages.splice(b,1),b-=1,a&&0!==a.status?j(c.thisArg,c.callback,null,-1,null):c.next(),this._requestsInProgress.fetch))return},_getServerOffset:function(a){var b,c,d,e=a-1;for(d=this._data[e];d;){if(b=this._getIdentity(d,e),c=this.getRecordMetadata(b),c&&c.serverOffset>=0)return c.serverOffset+1;e-=1,d=this._data[e]}return a},_clear:function(){var a=this._options;this._requestsInProgress.fetch&&(this._requestsInProgress.abortFetch=!0),this._requestsInProgress.save&&(this._requestsInProgress.abortSave=!0),"table"===a.shape?(this._data=[],a.hasTotalRecords?this._totalRecords=0:this._totalRecords=-1,this._haveAllData=!1,this._offset=0,this._numInsertedRecords=0,this._numDeletedRecords=0,this._masterRecordIsInserted&&(this._haveAllData=!0),this.dataOverflow=!1):this._data=null,this._changes=[],this._errors=[],this._index={},this._selection={},this._selectionCount=0},_saveDataState:function(){this._saveState={_data:this._data,_totalRecords:this._totalRecords,_haveALlData:this._haveAllData,_offset:this._offset,_numInsertedRecords:this._numInsertedRecords,_numDeletedRecords:this._numDeletedRecords,dataOverflow:this.dataOverflow,_changes:this._changes,_errors:this._errors,_index:this._index,_selection:this._selection,_selectionCount:this._selectionCount}},_restoreDataState:function(){var a=this._saveState;this._data=a._data,this._totalRecords=a._totalRecords,this._haveALlData=a._haveAllData,this._offset=a._offset,this._numInsertedRecords=a._numInsertedRecords,this._numDeletedRecords=a._numDeletedRecords,this.dataOverflow=a.dataOverflow,this._changes=a._changes,this._errors=a._errors,this._index=a._index,this._selection=a._selection,this._selectionCount=a._selectionCount},_clearChanges:function(a){var b,c,d,e=[],f=[],g=this._options,h=this[a];for(b=0;b<h.length;b++)c=h[b],d=this._getIdentity(c.record),c.deleted&&g.onlyMarkForDelete&&this._removeRecord(d,c),c.deleted?e.push(d):(c.inserted||c.updated)&&f.push(d),delete c.deleted,delete c.recordId,delete c.inserted,delete c.autoInserted,delete c.updated,delete c.original;this[a]=[],i(this,"clearChanges",{deletedIds:e,changedIds:f})},_addData:function(a,b,d,e,f,g){function h(a,b,c){var d={record:c};v._metaKey&&(A(d,c[v._metaKey]),d.sel="Y"===d.sel,d.agg&&(!a||v._identityKeys&&!c[v._identityKeys[0]])&&(v._assignTempIdentity(c),a=v._getIdentity(c)),d.allowedOperations&&(d.canEdit=!!d.allowedOperations.update,d.canDelete=!!d.allowedOperations["delete"])),void 0!==b&&null!==b&&(d.serverOffset=b),v._index[a]=d,d.sel&&(v._selected[a]=d)}var j,k,l,m,n,o,p,q,r,s,t,u=this._options,v=this;if("table"===u.shape?((0===a&&!this.isChanged()||"none"===u.paginationType)&&this._clear(),"one"===u.paginationType&&(this._offset=a),this._totalRecords=-1,void 0!==e&&null!==e?this._totalRecords=e:u.hasTotalRecords&&c.warn("Model missing total records"),this._haveAllData||f||(this._haveAllData=!0),g&&(this.dataOverflow=!0)):"record"===u.shape&&this._clear(),"tree"===u.shape&&a)p=a,p[this._childrenKey]=d,u.identityField&&v.walkTree(p,{node:function(a,b){var c;b&&(c=v._getIdentity(a),h(c,null,a),v.getRecordMetadata(c).parent=b)}},null),i(this,"addData",{parentNode:p,offset:0,count:d.length});else if(null===this._data||0===this._data.length||"table"!==u.shape||"one"===u.paginationType)c.trace("Model: "+this.modelId()+". add data set: ",a,e,f),this._data=d,this._numInsertedRecords=0,this._numDeletedRecords=0,"record"!==u.shape?(s={offset:0,count:d.length},q=b,this.forEach(function(a,b,c){v._metaKey&&a[v._metaKey].agg?r=null:(r=q,q+=1),h(c,r,a)}),"tree"===u.shape&&this.root()&&u.identityField&&(this.walkTree(this.root(),{node:function(a,b){v.getRecordMetadata(v._getIdentity(a)).parent=b}},null),s.parentNode=null,s.count=1)):u.identityField&&this._data?(s={offset:0,count:1},h(this._getIdentity(this._data),null,this._data)):s={offset:0,count:this._data?1:0},i(this,"addData",s);else{for(c.trace("Model: "+this.modelId()+". add data merge: ",a,e,f),k=a,q=b,t=[],j=0;j<d.length;j++)if(l=d[j],m=this._getIdentity(l,k),this._metaKey&&l[this._metaKey].agg?r=null:(r=q,q+=1),o=this.getRecordMetadata(m)){if(o.updated||o.inserted||o.deleted)continue;n=this._data.indexOf(o.record),this._data[n]=l,o.record=l,o.serverOffset=r,this._metaKey&&A(o,l[this._metaKey]),t.push(m)}else this._data[k]?this._data.splice(k,0,l):this._data[k]=l,k+=1,h(m,r,l);s={offset:a,count:k-a},t.length&&(s.replacedIds=t),i(this,"addData",s)}},_updateData:function(a,b){var c,d,e,f,g,h,j=[],k=[],l=[],m=[],o={},p=b||this._metaKey;for(c=0;c<a.length;c++)d=a[c],h=d[p],f=h?h.recordId:null,h&&f&&h.notFound?(g=this.getRecordMetadata(f),this._removeRecord(f,g),l.push(g.record),m.push(f)):(e=this._getIdentity(d),f===e&&(f=null),g=this.getRecordMetadata(f?f:e),g&&(f&&(o[f]=e,this._index[e]=g,delete this._index[f],delete this._selection[f],this._selectionCount-=1),j.push(d),k.push(f||e),this._data[this._data.indexOf(g.record)]=d,g.record=d,p&&h?(A(!0,g,h),delete g.recordId):b&&(this._options.recordIsArray?d.splice(b,1):delete d[b]),delete g.deleted,delete g.inserted,delete g.autoInserted,delete g.updated,delete g.original,n(g),this._removeError(g),this._removeChange(g)));j.length>0&&i(this,"refreshRecords",{records:j,recordIds:k,newIds:o}),l.length>0&&i(this,"delete",{records:l,recordIds:m})},_initRecord:function(b,c,d){var e,f,g,h,i,j,k,l,m=this._options;if(b)j=b;else{j=m.recordIsArray?[]:{};
for(e in m.fields)if(m.fields.hasOwnProperty(e)&&(f=m.fields[e],g=m.recordIsArray?f.index:e,!f.virtual))if(!c||f.noCopy){if(f.parentField&&m.parentModel&&(k||(k=a.get(m.parentModel),k&&!l&&m.parentRecordId&&(l=k.getRecord(m.parentRecordId))),l)){j[g]=k.getValue(l,f.parentField);continue}j[g]=void 0!==f.defaultValue?f.defaultValue:""}else j[g]=c[g]}if(k&&a.release(m.parentModel),this._identityKeys&&this._assignTempIdentity(j),this._metaKey&&(j[this._metaKey]={}),"tree"===m.shape&&(this._parentIdKey&&(j[this._parentIdKey]=this._getIdentity(d)),i=[],j[this._childrenKey]=i,c&&(h=c[this._childrenKey])))for(e=0;e<h.length;e++)i.push(this._initRecord(null,h[e],j));return j},_assignTempIdentity:function(a){var b;for(b=0;b<this._identityKeys.length;b++)a[this._identityKeys[b]]=this._options.genIdPrefix+this._nextInsertId,this._nextInsertId+=1},_getIdentity:function(a,b){var c,d=null;if(void 0!==this._identityKeys)if(1===this._identityKeys.length)d=a[this._identityKeys[0]]+"";else for(d=[],c=0;c<this._identityKeys.length;c++)d.push(a[this._identityKeys[c]]+"");else null!==b&&void 0!==b&&(d=b+"");return null!==d?k(d):d},_getPrimaryKey:function(a){var b,c;if(void 0!==this._identityKeys)for(c=[],b=0;b<this._identityKeys.length;b++)c.push(a[this._identityKeys[b]]+"");return c},_getType:function(a){var b="default",c=this._options;return a&&void 0!==this._typeKey&&(b=a[this._typeKey],null!==b&&"object"==typeof b&&b.hasOwnProperty("v")&&(b=b.v),b||(b="default")),c.types[b]||c.types["default"]},_getRecordById:function(a){var b=this._index[k(a)];return b?b.record:null},_removeRecord:function(a,b){var c,d,e=this._options;"table"===e.shape?c=this._data:"tree"===e.shape&&(c=b.parent[this._childrenKey],delete b.parent),c.splice(c.indexOf(b.record),1),d=k(a),delete this._index[d],b.sel&&(delete this._selection[d],this._selectionCount-=1)},_addChange:function(a){var b=this._changes.indexOf(a);b>=0&&this._changes.splice(b,1),this._changes.push(a)},_removeChange:function(a){var b=this._changes.indexOf(a);b>=0&&!a.deleted&&!a.updated&&!a.inserted&&this._changes.splice(b,1)},_removeError:function(a){var b=this._errors.indexOf(a);b>=0&&this._errors.splice(b,1)},_addParentItems:function(b){var c,d,e,f,g,h,i={values:[]},j=this._options;if(j.parentModel&&j.parentRecordId){for(c in j.fields)j.fields.hasOwnProperty(c)&&(d=j.fields[c],d.parentField&&(e||(e=a.get(j.parentModel),e&&!f&&(f=e.getRecord(j.parentRecordId),h=e.getRecordMetadata(j.parentRecordId))),f&&(g={n:d.parentField,v:e.getValue(f,d.parentField)},i.values.push(g))));h&&(h.salt&&(i.salt=h.salt),h["protected"]&&(i["protected"]=h["protected"])),e&&a.release(j.parentModel),b.parentRecordId=j.parentRecordId,i.values.length>0&&(b.parentItems=i)}}},G={shape:"table",recordIsArray:!1,hasTotalRecords:!1,genIdPrefix:"t",regionId:null,ajaxIdentifier:null,pageItemsToSubmit:null,regionData:{},fetchData:{},saveData:{},version:1,parentModel:null,parentRecordId:null,editable:!1,onlyMarkForDelete:!0,identityField:null,typeField:null,childrenField:null,parentIdentityField:null,sequenceField:null,metaField:null,sequenceStep:10,saveSelection:!1,types:{"default":{validChildren:!0,operations:{canAdd:!0,canEdit:!0,canDelete:!0,canDrag:!0,drag:{normal:"move",ctrl:"copy"},externalDrag:{normal:"add"}}}},check:null,sortCompare:null,paginationType:"none",pageSize:100,preFetch:!1},H={table:1,tree:1,record:1},I={none:1,one:1,progressive:1};a.create=function(b,d,f,g,h,j){var k,l,m,n,o,p,q,r,s,t,v,y,C=e(b),D=Object.create(F);if(D.name=C[0],D.instance=C[1],D._requestsInProgress={},D._listeners=[],D._waitingPages=[],m=d.fields,D._options=A(!0,{},G,d),D._options.fields=m,l=D._options,!l.fields)throw new Error("The fields option is required");if(!H[l.shape])throw new Error("Invalid shape option: "+l.shape);if(!I[l.paginationType])throw new Error("Invalid paginationType option: "+l.paginationType);if(l.editable&&!l.identityField)throw new Error("An editable model requires an identityField");if("tree"===l.shape&&!l.childrenField)throw new Error("A tree shaped model requires a childrenField");if("table"===l.shape&&"none"===l.paginationType&&void 0===d.hasTotalRecords&&(l.hasTotalRecords=!0),D._nextInsertId=1e3,l.identityField)if(B(l.identityField))for(D._identityKeys=[],k=0;k<l.identityField.length;k++)D._identityKeys.push(D.getFieldKey(l.identityField[k]));else D._identityKeys=[D.getFieldKey(l.identityField)];if(l.typeField&&(D._typeKey=D.getFieldKey(l.typeField),void 0===D._typeKey))throw new Error("Type field not found: "+l.typeField);if(l.childrenField&&(D._childrenKey=D.getFieldKey(l.childrenField),void 0===D._childrenKey))throw new Error("Children field not found: "+l.childrenField);if(l.parentIdentityField&&(D._parentIdKey=D.getFieldKey(l.parentIdentityField),void 0===D._parentIdKey))throw new Error("Parent identity field not found: "+l.parentIdentityField);if(l.sequenceField&&(D._sequenceKey=D.getFieldKey(l.sequenceField),void 0===D._sequenceKey))throw new Error("Sequence field not found: "+l.sequenceField);if(l.metaField&&(D._metaKey=D.getFieldKey(l.metaField),void 0===D._metaKey))throw new Error("Meta field not found: "+l.metaField);if("record"!==l.shape?l.identityField?D.getRecord=D._getRecordById:D.getRecord=D.recordAt:D.getRecord=function(){return D._data},D._clear(),f?(s="none"!==l.paginationType&&(void 0!==h&&null!==h?h:void 0===g||null===g||f.length<g),D._addData(0,0,f,g,s,j)):null!==g&&void 0!==g&&(D._totalRecords=g),l.parentModel&&l.parentRecordId&&!f&&(y=a.get(l.parentModel))){v=y.getRecordMetadata(l.parentRecordId),v.inserted&&(D._masterRecordIsInserted=!0,D._clear()),v.deleted&&(D._saveDataState(),D._masterRecordIsDeleted=!0,D._clear(),D._addData(0,0,[],0,!1,!1)),p=D._parentFieldsMap={};for(k in l.fields)l.fields.hasOwnProperty(k)&&(o=l.fields[k],o.parentField&&(p[o.parentField]||(p[o.parentField]=[]),p[o.parentField].push(k)));D.parentModelViewId=y.subscribe({onChange:function(b,c){var d,e;if("delete"===b||"revert"===b||"refreshRecords"===b||"clearChanges"===b){for(e=c.recordIds||c.deletedIds,d=0;d<e.length;d++)if(e[d]===l.parentRecordId){"delete"===b?(D._saveDataState(),D._masterRecordIsDeleted=!0,D._clear(),D._addData(0,0,[],0,!1,!1),i(D,"refresh",{})):"revert"!==b&&"refreshRecords"!==b||!D._masterRecordIsDeleted?"refreshRecords"===b&&c.newIds&&c.newIds[D.instance]||"clearChanges"===b&&D._masterRecordIsDeleted&&delete D._saveState:(delete D._masterRecordIsDeleted,D._restoreDataState(),i(D,"refresh",{}));break}"clearChanges"===b&&D._masterRecordIsInserted&&delete D._masterRecordIsInserted}else"set"===b&&(c.oldIdentity||c.recordId)===l.parentRecordId?(q=c.field,q in p&&(n=p[q],r=y.getValue(c.record,q),D.forEach(function(a){var b,d;if(!D._metaKey||!a[D._metaKey].agg)for(b=0;b<n.length;b++)d=n[b],c.oldValue===D.getValue(a,d)&&D.setValue(a,d,r)})),c.oldIdentity&&(l.parentRecordId=c.recordId,a.renameInstance(D.modelId(),c.recordId))):"refresh"===b&&D._masterRecordIsDeleted&&(delete D._masterRecordIsDeleted,D._restoreDataState(),i(D,"refresh",{}))}}),a.release(l.parentModel)}return x.length>=z&&(t=u(),t&&(c.info("Model: cache overflow; remove model from cache: "+t.modelId()),a.destroy(e(t.modelId())))),t=w[C[0]],t||(t={instances:{},instancesRef:{}},w[C[0]]=t),C[1]?(t.instancesRef[C[1]]=1,t.instances[C[1]]=D):(t.modelRef=1,t.model=D),c.info("Model: created model: "+b+" refCount: 1"),D},a.list=function(a,b,c){var d=r(null,c,a,b);return d.map(function(a){return a.id})},a.getStats=function(){var a,b,c,d,e,f=[];for(a in w)if(w.hasOwnProperty(a)){b=w[a],d=b.model,d&&(c={name:d.name,instance:null,refCount:b.modelRef,cachePos:x.indexOf(d),subscribers:d._listeners.length,progressViews:d._listeners.map(function(a){return a.progressView||null})},f.push(c));for(e in b.instances)b.instances.hasOwnProperty(e)&&(d=b.instances[e],c={name:d.name,instance:d.instance,refCount:b.instancesRef[e],cachePos:x.indexOf(d),subscribers:d._listeners.length,progressViews:d._listeners.map(function(a){return a.progressView||null})},f.push(c))}return f},a.anyChanges=function(a,b,c){var d=r("change",c,a,b);return d.length>0},a.anyErrors=function(a,b,c){var d=r("error",c,a,b);return d.length>0},a.addChangesToSaveRequest=function(a,b,c){var d,e,f=[],g=r("change",c,!1,b);if(g.length<=0)return null;for(d=0;d<g.length;d++)e=g[d].model.addChangesToSaveRequest(a),e&&f.push(e);return function(a){var b;for(b=0;b<f.length;b++)f[b](a)}},a.save=function(a,c,d,e,f){var g,h,i,j,k;if(a=a||{},c=c||{},j=r("change",e,!1,d),h=apex.model.addChangesToSaveRequest(a,d,e)){if(d&&void 0===c.loadingIndicator&&void 0===c.loadingIndicatorPosition){for(k=[],g=1;g<j.length;g++)k.push(j[g].model);c.loadingIndicator=l(j[0].model,k)}return i=(f||b.plugin)(a,c),h(i),i}return null},a.get=function(a){var b,d,f,g=e(a);return b=w[g[0]],b&&(g[1]?(d=b.instances[g[1]],d&&(f=b.instancesRef[g[1]]+=1)):(d=b.model,d&&(f=b.modelRef+=1)),d&&(s(d),c.info("Model: get model: "+a+" refCount: "+f))),d},a.renameInstance=function(a,b){var d,f,g=e(a);d=w[g[0]],d&&g[1]&&(f=d.instances[g[1]],f.instance=b,delete d.instances[g[1]],d.instances[b]=f,c.info("Model: rename model "+g[0]+" instance: "+g[1]+" to "+b),i(f,"instanceRename",{oldInstance:g[1],newInstance:b}))},a.release=function(b){var d,f,g=e(b);d=w[g[0]],d&&(g[1]?(f=d.instancesRef[g[1]]-=1,d=d.instances[g[1]]):(f=d.modelRef-=1,d=d.model),c.info("Model: release model: "+b+" refCount: "+f),f<=0&&(d._options.parentModel&&q(d._options.parentModel)?(c.info("Model: save in cache model: "+b),t(d)):d.isChanged()||a.destroy(b)))},a.destroy=function(b){function d(d){var e,f;d&&(s(d),d.parentModelViewId&&(f=d._options.parentModel,e=a.get(f),e&&(e.unSubscribe(d.parentModelViewId),a.release(f))),d._data=null,d._index=null,d._selection=null,c.info("Model: destroy model: "+b))}var f,g,h=e(b);if(f=w[h[0]]){if(h[1])d(f.instances[h[1]]),delete f.instancesRef[h[1]],delete f.instances[h[1]];else if(d(f.model),delete f.model,delete f.modelRef,"string"==typeof b&&!h[1])for(g in f.instances)f.instances.hasOwnProperty(g)&&(d(f.instances[g]),delete f.instancesRef[g],delete f.instances[g]);0!==Object.keys(f.instances).length||f.model||delete w[h[0]]}},a.getMaxCachedModels=function(){return z},a.setMaxCachedModels=function(a){z=parseInt(a,10)||v}}(apex.model,apex.server,apex.debug,apex.jQuery);
!function(a,b,c,d){"use strict";var e=".",f="a-Toolbar",g=f+"--small",h=f+"--simple",i=f+"-group",j=f+"-groupContainer",k=j+"--start",l=j+"--center",m=j+"--end",n=i+"--together",o=f+"-item",p=f+"-input",q=f+"-inputText",r=f+"-inputCheckbox",s=f+"-static",t=f+"-button",u=t+"-item",v=f+"-radioGroup",w=f+"-toggleButton",x=f+"-menu",y=f+"-selectList",z="a-Button",A=z+"--hot",B="a-Button-label",C="a-Button--withIcon",D="a-Button--noLabel",E="a-Icon",F=E+" icon-menu-drop-down",G="js-menuButton",H="js-actionButton",I="js-actionRadioGroup",J="js-actionCheckbox",K="js-actionSelect",L="is-active",M=e+p,N="start",O="center",P="end",Q=a.ui.keyCode,R=1;a.widget("apex.toolbar",{version:"5.1",widgetEventPrefix:"toolbar",options:{label:"",toolbarFor:null,idPrefix:null,actionsContext:null,small:!1,simple:!1,toolbarClass:"",cursorKeyNavigation:!1,data:[]},_create:function(){function c(b,c){"update"!==c&&"updateChoices"!==c||(k.enterActions[b.name]&&j.find('[data-enter-action="'+b.name+'"]').prop("disabled",!!b.disabled),j.is(":visible")&&j.find("."+i).each(function(){var b,c=a(this);b=c.children().filter(function(){return!this.style||"none"!==this.style.display}).length>0,c.toggle(b)}))}var e,j=this.element,k=this,l=this.options;e=b.debounce(c,10),this.menus={},this.enterActions={},j.addClass(f).attr("role","toolbar").attr("aria-label",l.label?l.label:d.formatMessage("APEX.TB.TOOLBAR")),l.toolbarFor&&j.attr("aria-controls",l.toolbarFor),l.small&&j.addClass(g),l.simple&&j.addClass(h),l.toolbarClass&&j.addClass(l.toolbarClass),apex.actions&&(this.actionsContext=l.actionsContext||apex.actions,this.actionsContext.observe(e),this.actionObserver=e),this.refresh(),l.cursorKeyNavigation&&(this.toolbarHasChanged(),this._on(this._keyNavHandlers))},_keyNavHandlers:{keydown:function(b){function c(a){var d,f;a.attr("tabindex","-1"),f=parseFloat(e.focusableElements.index(a[0])+1),d=f>=e.focusableElements.length?e.focusableElements.first():e.focusableElements.filter(":eq("+f+")"),a.is(":input[type=radio]")&&a.attr("name")===d.attr("name")?c(d):d.attr("tabindex","0").focus(),b.preventDefault()}function d(a){var c,f;a.attr("tabindex","-1"),f=parseFloat(e.focusableElements.index(a[0])-1),c=f<0?e.focusableElements.last():e.focusableElements.filter(":eq("+f+")"),a.is(":input[type=radio]")&&a.attr("name")===c.attr("name")?d(c):c.attr("tabindex","0").focus(),b.preventDefault()}var e=this,f=b.which,g=a(b.target);g.is(":input[type=text],:input[type=radio],select")?b.shiftKey&&f===Q.TAB?d(g):f===Q.TAB&&c(g):f===Q.LEFT?d(g):f===Q.RIGHT&&c(g)}},_destroy:function(){var b,c=this.element,d=this.options;c.removeClass(f+" "+g+" "+h+" "+d.toolbarClass).removeAttr("role").empty(),this.actionsContext&&this.actionsContext.unobserve(this.actionObserver);for(b in this.menus)this.menus.hasOwnProperty(b)&&a("#"+b).remove()},_setOption:function(a,b){var c=this.element;"small"===a&&c.toggleClass(g,b),"simple"===a&&c.toggleClass(h,b),"toolbarClass"===a&&c.removeClass(this.options.toolbarClass).addClass(b),this._super(a,b),"data"===a&&this.refresh()},_getControlProperty:function(a,b){var c,d;return d=a[b],void 0===d&&a.action&&(c=this.actionsContext.lookup(a.action),c&&c[b]&&(d=c[b])),d},_getLocalizedControlProperty:function(a,b){var c,e=null;return a[b+"Key"]?e=d.getMessage(a[b+"Key"]):void 0!==a[b]&&(e=a[b]),!e&&a.action&&(c=this.actionsContext.lookup(a.action),c&&void 0!==c[b]&&(e=c[b])),e},_getNoUpdate:function(a){return a.label||a.labelKey||a.icon||a.title||a.titleKey?"true":null},_getId:function(a){var b=this.options.idPrefix||this.element[0].id||"tb";return a.id?b+"_"+a.id:null},_forceId:function(a){a.id||(a.id="m"+R,R+=1)},_buildText:function(b,c){var d=a.extend({id:"",label:"",size:"30",maxChars:"4000",placeholder:"",action:""},c);d.enterAction&&(this.enterActions[d.enterAction]=!0),b.markup("<input").optionalAttr("id",this._getId(d)).attr("class",p+" "+q+" "+o).attr("title",this._getLocalizedControlProperty(d,"label")).attr("type","text").attr("size",d.size).attr("maxlength",d.maxChars).attr("value","").optionalAttr("placeholder",this._getLocalizedControlProperty(d,"placeholder")).optionalAttr("data-enter-action",d.enterAction).markup(" />")},_buildStatic:function(a,b){a.markup("<span").optionalAttr("id",this._getId(b)).attr("class",s+" "+o).markup(">"),b.content?a.markup(b.content):a.content(this._getLocalizedControlProperty(b,"label")),a.markup("</span>")},_buildSelect:function(a,b){var c,d=this.actionsContext.lookup(b.action);c=this._getLocalizedControlProperty(b,"title"),c||(c=this._getLocalizedControlProperty(b,"label")),a.markup("<select").optionalAttr("id",this._getId(b)).attr("class",y+" "+K+" "+o).attr("size","1").optionalAttr("title",c).optionalAttr("aria-label",c).optionalBoolAttr("disabled",d&&!!d.disabled).attr("data-action",b.action).markup("></select>")},_buildButton:function(a,b){function c(){a.markup("<span").attr("class",E+" "+f).markup("></span>")}var d,e,f,g,h,i=z+" "+o,j=b.menu||b.menuId;j?(b.menu?(this._forceId(b),d=this._getId(b)+"_menu"):d=b.menuId,i+=" "+G):i+=" "+H,f=this._getControlProperty(b,"icon"),f&&(i+=" "+C),b.iconOnly&&(i+=" "+D),b.hot&&(i+=" "+A),h=this.actionsContext.lookup(b.action),h&&h.get&&!h.onLabel&&h.get(b.action)&&(i+=" "+L),a.markup("<button type='button'").attr("class",i).optionalAttr("id",this._getId(b)).optionalBoolAttr("disabled",h&&!!h.disabled),e=this._getLocalizedControlProperty(b,"label"),g=this._getLocalizedControlProperty(b,"title"),!e&&h&&h.get&&(e=h.get()?h.onLabel:h.offLabel),b.iconOnly?(g||(g=e),a.attr("title",g).attr("aria-label",e)):g&&a.attr("title",g),j?a.attr("data-menu",d).attr("aria-haspopup",!0).attr("aria-expanded",!1):a.attr("data-action",b.action).optionalAttr("data-no-update",this._getNoUpdate(b)),a.markup(">"),f&&b.iconBeforeLabel&&c(),b.iconOnly||a.markup("<span class='"+B+"'>").content(e).markup("</span>"),f&&!b.iconBeforeLabel&&c(),j&&a.markup("<span").attr("class",F).markup("></span>"),a.markup("</button>"),b.menu&&(this.menus[d]=b.menu)},_buildRadioButtonGroup:function(a,b){a.markup("<div role='group'").attr("aria-label",this._getLocalizedControlProperty(b,"label")).attr("class",v+" "+I+" "+o).attr("data-action",b.action).attr("data-item",z).attr("data-item-wrap",u).markup("></div>")},_buildToggle:function(a,b){var c,d,e=this.actionsContext.lookup(b.action);this._forceId(b),c=e&&e.get(b.action),d=p+" "+r,c&&(d+=" "+L),a.markup("<div").attr("class",w+" "+J+" "+o).attr("data-action",b.action).optionalAttr("data-no-update",this._getNoUpdate(b)).markup(">"),a.markup("<input type='checkbox'").attr("class",d).attr("name",b.action).attr("id",this._getId(b)).optionalBoolAttr("checked",c).optionalBoolAttr("disabled",e&&!!e.disabled).markup(" />"),a.markup("<label").attr("for",this._getId(b)).attr("class",z).markup(">").content(this._getLocalizedControlProperty(b,"label")).markup("</label>"),a.markup("</div>")},_buildToolbar:function(a,b){var c,d=[],e=[],f=[];for(c=0;c<b.length;c++)b[c].align&&b[c].align!==N?b[c].align===O?e.push(b[c]):b[c].align===P&&f.push(b[c]):d.push(b[c]);d.length&&this._buildGroupContainer(a,N,d),e.length&&this._buildGroupContainer(a,O,e),f.length&&this._buildGroupContainer(a,P,f)},_buildGroupContainer:function(a,b,d){var e,f,g,h,o,p=j;switch(b){case N:p+=" "+k;break;case O:p+=" "+l;break;case P:p+=" "+m}for(a.markup("<div").attr("class",p).markup(">"),e=0;e<d.length;e++){for(o=i,g=d[e],g.customCSS&&(o+=" "+g.customCSS),g.groupTogether&&(o+=" "+n),a.markup("<div").attr("class",o).markup(">"),f=0;f<g.controls.length;f++)switch(h=g.controls[f],h.type){case"STATIC":this._buildStatic(a,h);break;case"TEXT":this._buildText(a,h);break;case"SELECT":this._buildSelect(a,h);break;case"MENU":case"BUTTON":this._buildButton(a,h);break;case"RADIO_GROUP":this._buildRadioButtonGroup(a,h);break;case"TOGGLE":this._buildToggle(a,h);break;default:c.error("Unknown toolbar control type: "+h.type)}a.markup("</div>")}a.markup("</div>")},refresh:function(){var c,d,e,f,g,h,i,j=this,k=this.element,l=this.options,m=l.data,n=b.htmlBuilder();for(g in this.menus)this.menus.hasOwnProperty(g)&&a("#"+g).remove();for(this._buildToolbar(n,l.data),k.html(n.toString()),c=0;c<m.length;c++)if(e=m[c].controls)for(d=0;d<e.length;d++)f=e[d],i=this.actionsContext.lookup(f.action),i&&(i.hide&&this.actionsContext.update(f.action),i.choices&&this.actionsContext.updateChoices(f.action));k.find(M).on("keydown",function(b){var c=a(b.target),d=c.attr("data-enter-action");d&&13===b.which&&(j.actionsContext.invoke(d),b.preventDefault())});for(g in this.menus)this.menus.hasOwnProperty(g)&&(a("<div/>",{id:g,"class":x,style:"display:none;"}).appendTo("body"),h=this.menus[g],h.actionsContext=this.actionsContext,h.idPrefix=this.options.idPrefix||this.element[0].id||"tb",a("#"+g).menu(h))},toolbarHasChanged:function(){var a,b;this.focusableElements=this.element.find(":focusable"),a=this.focusableElements.filter("[tabindex=0]"),b=a.length?this.focusableElements.index(a[0]):0,this.focusableElements.filter(":eq("+b+")").attr("tabindex","0").end().not(":eq("+b+")").attr("tabindex","-1")},hideControl:function(a){var b=this.find(a);b&&(b.action?this.actionsContext.hide(b.action):(this.findElement(a).hide(),this.actionObserver&&this.actionObserver({},"update")))},showControl:function(a){var b=this.find(a);b&&(b.action?this.actionsContext.show(b.action):(this.findElement(a).show(),this.actionObserver&&this.actionObserver({},"update")))},disableControl:function(a){var b=this.find(a);b&&(b.action?this.actionsContext.disable(b.action):this.findElement(a).prop("disabled",!0))},enableControl:function(a){var b=this.find(a);b&&(b.action?this.actionsContext.enable(b.action):this.findElement(a).prop("disabled",!1))},findGroup:function(a){var b,c,d=this.options.data;for(b=0;b<d.length;b++)if(c=d[b],c.id===a)return c;return null},find:function(b){var c,d,e,f,g,h=this.options.data;for(c=0;c<h.length;c++)if(e=h[c].controls)for(d=0;d<e.length;d++)if(f=e[d],f.id===b)return f;for(g in this.menus)if(this.menus.hasOwnProperty(g)&&(f=a("#"+g).menu("find",b)))return f;return null},findElement:function(b){var c,d=this._getId({id:b});return c=a("#"+d)}})}(apex.jQuery,apex.util,apex.debug,apex.lang);
!function(a,b,c,d,e){"use strict";function f(a){return a.parent().children().index(a)}function g(a){var b=a.find("a");return b.length?b[0]:a[0]}function h(a){return e(a).closest(k)}var i="a-IconList",j="a-IconList-item",k="."+j,l="u-selector",m=l+" "+l+"--single",n="."+l,o="is-selected",p="."+o,q=p+k,r="is-focused",s="is-disabled",t="aria-selected",u="aria-multiselectable",v="aria-labelledby",w="role",x="tabindex",y="u-RTL",z=e.ui.keyCode,A=0,B=function(a,b){a._trigger("selectionChange",b)},C=d.debounce(B,1),D=d.debounce(B,350),E={begin:function(){this.text=""},item:function(a,b,c){b>0&&(this.text+="\r\n"),this.text+=c},end:function(){},toString:function(){return this.text}},F={begin:function(){this.text="<ul>\r\n"},item:function(a,b,c){this.text+="<li>"+d.escapeHTML(c)+"</li>\r\n"},end:function(){this.text+="</ul>\r\n"},toString:function(){return this.text}};e.widget("apex.iconList",e.extend(!0,{version:"19.1",widgetEventPrefix:"iconlist",options:{multiple:!1,itemSelector:!1,addItemSelector:!0,label:!0,navigation:!1,tabbableContent:null,noNavKeyContent:null,allowCopy:!0,dataTransferFormats:[{format:"text/plain",writer:Object.create(E)},{format:"text/html",writer:Object.create(F)}],selectionChange:null,activate:null},_create:function(){var a,c=this,d=this.options,f=this.element;this.columns=0,this.rows=0,this.searchString="",this.searchTimerId=null,d.navigation&&(d.multiple=!1),f.addClass(i).attr(w,"listbox"),d.multiple&&f.attr(u,"true"),this.forwardKey=z.RIGHT,this.backwardKey=z.LEFT,"rtl"===f.css("direction")&&(f.addClass(y),this.forwardKey=z.LEFT,this.backwardKey=z.RIGHT),f.attr(v)?(a=e("#"+f.attr(v).split(" ").join(",#")).last(),this.infoId=a.attr("id")+"_info",a.append("<span id='"+this.infoId+"' class='u-VisuallyHidden'></span>")):(this.infoId=(f.attr("id")||"il"+A++)+"_info",f.before("<span id='"+this.infoId+"' class='u-VisuallyHidden'></span>"),f.attr(v,this.infoId),this.addedLabel=!0),this._initContextMenu(j,function(a){return!1},function(a){var b="keydown"===a.type&&c.lastFocused?c.lastFocused:a.target,d=h(b);return!!d.length&&(!!d.hasClass(o)||d)}),this._on(this._eventHandlers),d.allowCopy&&b.addHandler(f[0],function(a){return c._copy(a),!0}),this.refresh(),d.disabled&&this._setOption("disabled",d.disabled)},_eventHandlers:{resize:function(a){a.target===this.element[0]&&(this._dim(),a.stopPropagation())},click:function(a){var b,c=this.options,d=c.navigation,f=e(a.target);d&&f.closest("a").length>0&&(a.shiftKey||a.ctrlKey)||(b=f.closest(k),b.length&&(c.itemSelector&&f.closest(n).length&&(a.ctrlKey=!0,a.shiftKey=!1),this._select(b,a,!0,!1),d&&this._activate(a),!d&&c.tabbableContent&&f.closest(c.tabbableContent).length?c.tabbableContent&&f.closest(c.tabbableContent).length&&f.focus():a.preventDefault()))},dblclick:function(a){var b;this.options.navigation||(b=h(a.target),b.length&&this._activate(a))},mousedown:function(a){a.preventDefault()},keydown:function(a){var b,c,d,g=this.element,i=this.options,j=e(a.target),k=null,l=a.which;!i.navigation&&i.noNavKeyContent&&j.closest(i.noNavKeyContent).length||(l===z.HOME?k=g.children().first():l===z.END?k=g.children().last():l===z.DOWN?this.lastFocused&&(b=this._index2RowCol(f(h(this.lastFocused))),c=g.children(),b.row<Math.floor((c.length-1)/this.columns)&&(d=this._rowCol2Index(b.row+1,b.column),d>=c.length&&(d=c.length-1),k=c.eq(d))):l===z.UP?this.lastFocused&&(b=this._index2RowCol(f(h(this.lastFocused))),c=g.children(),d=this._rowCol2Index(b.row-1,b.column),d>=0&&(k=c.eq(d)),k&&a.stopPropagation()):l===this.backwardKey?this.lastFocused&&(k=h(this.lastFocused).prev()):l===this.forwardKey?this.lastFocused&&(k=h(this.lastFocused).next()):l===z.SPACE?this.lastFocused&&!this.searchTimerId&&(k=h(this.lastFocused)):l===z.ENTER&&"A"!==a.target.nodeName&&this._activate(a),k&&k[0]&&(this._select(k,a,!0,!0),a.preventDefault()))},keypress:function(a){var b,c,d=this.options,f=this;if(0!==a.which&&d.label&&!a.altKey&&!a.ctrlKey&&(d.navigation||!d.noNavKeyContent||!e(a.target).closest(d.noNavKeyContent).length)){if(b=String.fromCharCode(a.which).toLowerCase(),this.searchTimerId)b!==this.searchString&&(this.searchString+=b),clearTimeout(this.searchTimerId),this.searchTimerId=null;else{if(" "===b)return;this.searchString=b}this.searchTimerId=setTimeout(function(){f.searchTimerId=null},500),c=this._findItem(this.searchString),c&&this._select(c,a,!0,!0)}},focusin:function(a){var b=h(a.target);0!==b.length&&(b.addClass(r),this._setFocusable(a.target))},focusout:function(a){var b=h(a.target);b.removeClass(r)}},_destroy:function(){var a=this.element,c=this.options;a.removeClass(i+" "+s+" "+y).removeAttr(w).removeAttr(u).children().removeClass(j).removeAttr(w).removeAttr(t).removeAttr(x),a.find("a").removeAttr(x).removeAttr(w),c.itemSelector&&c.addItemSelector&&a.find(n).remove(),b.removeHandler(a[0]),this._destroyContextMenu(),e("#"+this.infoId).remove(),this.addedLabel&&a.removeAttr(v)},_setOption:function(a,b){var c,d,e=this.options,f=this.element;if(this._checkContextMenuOptions(a,b),"multiple"===a)e.navigation&&(b=!1);else if("allowCopy"===a||"addItemSelector"===a||"navigation"===a)throw new Error("IconList "+a+" option cannot be set");this._super(a,b),"disabled"===a?(f.toggleClass(s+" ui-state-disabled",b).attr("aria-disabled",b),this.lastFocused&&(b?this.lastFocused&&(c=!e.navigation&&e.tabbableContent,c?(d=h(this.lastFocused),d.add(d.find(c).not(":disabled")).prop("tabIndex",-1)):this.lastFocused.tabIndex=-1):this._setFocusable(this.lastFocused)),b&&this._dim()):"multiple"===a?b?f.attr(u,"true"):f.removeAttr(u):"itemSelector"===a&&this.refresh()},refresh:function(){var a,b,c,d=this.options,f=this.element;d.multiple&&!d.itemSelector&&apex.userHasTouched()&&(d.itemSelector=!0,d.addItemSelector=!0),f.find("a").attr(x,-1).attr(w,"option"),f.find(d.tabbableContent).attr(x,-1),c=f.children(),c.addClass(j).filter(function(){return 0===e(this).find("a").length}).attr(w,"option").attr(x,-1),d.addItemSelector&&(d.itemSelector?(b=e("<span class='"+(d.multiple?l:m)+"'></span>"),c.filter(function(){return e(this).find(n).length<=0}).prepend(b)):f.find(n).remove()),this._dim(),a=f.find(q),a.length>0?this.setSelection(a,!1):(this.lastFocused&&e(this.lastFocused).is(":visible")||(this.lastFocused=g(f.children().first())),this.selectAnchor=this.lastFocused,this.lastFocused&&!d.disabled&&this._setFocusable(this.lastFocused))},resize:function(){this._dim()},focus:function(){this.lastFocused&&this.lastFocused.focus()},getColumns:function(){return this.columns},getRows:function(){return this.rows},getSelection:function(){return this.element.find(q)},getSelectionValues:function(){var a=[];return this.getSelection().each(function(){a.push(e(this).attr("data-value"))}),a},setSelection:function(a,b,c){b=!!b,this._select(a,null,b,!1,c)},_copy:function(a){var b,c,d=this.getSelection(),e=this.options.dataTransferFormats;if(d.length){for(e.forEach(function(a){a.writer.begin(d)}),b=0;b<d.length;b++)c=d.eq(b),e.forEach(function(a){a.writer.item(c,b,c.text())});e.forEach(function(b){b.writer.end(),a.setData(b.format,b.writer.toString())})}},_rowCol2Index:function(a,b){return a*this.columns+b},_index2RowCol:function(a){var b=Math.floor(a/this.columns);return{row:Math.floor(a/this.columns),column:a-b*this.columns}},_dim:function(){var a,b,d,f=this,g=this.element,h=g.width(),i=g.children(),j=i.length;j&&(a=i.first().position().top,d=i.first().outerWidth()),this.columns=j,i.each(function(b){var c=e(this).position().top;if(c>a)return a=c,f.columns=b,!1}),j>0?this.rows=Math.floor((j+this.columns-1)/this.columns):this.rows=0,1===this.rows&&(this.columns=Math.floor(h/d)),b=1===this.columns?c.formatMessage("APEX.ICON_LIST.LIST_DIM",this.rows):c.formatMessage("APEX.ICON_LIST.GRID_DIM",this.columns,this.rows),e("#"+this.infoId).text(b)},_findItem:function(a){var b,c,d,e=this.element,f=a.length,g=this.options.label;for(c=d=h(this.lastFocused),1===f&&(c=c.next()),0===c.length&&(c=e.children().first());c.length>0;){if(b=g===!0?c.text().trim():c.find(g).text(),b.substring(0,f).toLowerCase()===a)return c;if(c=c.next(),0===c.length&&(c=e.children().first()),c[0]===d[0])break}return null},_setFocusable:function(a){var b,c,d=this.options,e=!d.navigation&&d.tabbableContent;this.lastFocused&&this.lastFocused!==a&&(e?(c=h(this.lastFocused),c.add(c.find(e).not(":disabled")).prop("tabIndex",-1)):this.lastFocused.tabIndex=-1),e?(c=h(a),b=c.find(e).not("disabled").prop("tabIndex",0).length,b||c.prop("tabIndex",0)):a.tabIndex=0,this.lastFocused=a},_activate:function(a){var b,c;this._trigger("activate",a,{values:this.getSelectionValues()}),this.options.navigation&&!a.isDefaultPrevented()&&(b=this.getSelection(),c=b.attr("href")||b.find("a").attr("href"),c&&(a.preventDefault(),apex.navigation.redirect(c)))},_select:function(a,b,c,h,i){var j,k,l,m,p,r,s,u,v,w="set",x=this,y=this.element,z=this.options,A=y.find(q);a=a.filter(":visible"),b&&z.multiple&&("click"===b.type?b.ctrlKey||b.metaKey?w="toggle":b.shiftKey&&(w="range"):"keydown"===b.type&&(b.keyCode===e.ui.keyCode.SPACE?w=b.ctrlKey?"toggle":b.shiftKey?"range":"add":b.ctrlKey?w="none":b.shiftKey&&(w="range"))),"range"!==w||this.selectAnchor||(w="set"),"set"!==w&&"range"!==w||A.removeClass(o).removeAttr(t).find(n).removeClass(o),j=a.hasClass(o),"set"===w||"add"===w||"toggle"===w&&!j?(a.addClass(o).attr(t,!0).find(n).addClass(o),this.selectAnchor=a[0]):"range"===w?(y.children().removeClass(o).removeAttr(t).find(n).removeClass(o),r=f(e(this.selectAnchor)),s=f(a.last()),r>s&&(u=s,s=r,r=u),y.children().filter(function(a){return a>=r&&a<=s}).addClass(o).attr(t,!0).find(n).addClass(o)):"toggle"===w&&j&&(a.removeClass(o).removeAttr(t).find(n).removeClass(o),this.selectAnchor=a[0]),a.length>0&&(v=g(a.first()),c?(v.tabIndex=0,v.focus()):this._setFocusable(v),l=y.scrollParent(),m=l[0]===document?{left:0,top:0}:l.offset(),m&&(p=y.offset(),k=a.first().offset(),(k.top<m.top||k.top>m.top+l[0].offsetHeight)&&(l[0].scrollTop=k.top-p.top),(k.left+a[0].offsetWidth<m.left||k.left>m.left+l[0].offsetWidth)&&(l[0].scrollLeft=k.left-p.left))),i||z.navigation&&b&&"click"===b.type||("toggle"===w||"range"===w&&!j||"add"===w&&!j||"set"===w&&!d.arrayEqual(A,a))&&(h?D(x,b):C(x,b))}},apex.widget.contextMenuMixin))}(apex.debug,apex.clipboard,apex.lang,apex.util,apex.jQuery);
!function(a,b,c,d,e,f){"use strict";var g="a-Combobox",h="."+g,i=g+"-wrapper",j="."+i,k="a-Button",l=k+"--withIcon",m=k+"--noLabel",n="a-Icon",o="icon-menu-drop-down",p="js-menuButton",q="combobox",r="-values",s="-menu",t="-showAll";a.widget("apex."+q,{version:"5.1",widgetEventPrefix:q,options:{source:[],multipleValues:!1,multipleValueDelimiter:",",label:""},_create:function(){var f=b.htmlBuilder(),k=this,l=this.options,m=a(h).length;this.baseId=this.element[0].id||q+(m+1),this.actions=c.createContext(q,this.element[0]),l.label&&e.warn("Label not provided, which is an accessibility issue (unless the 'label' option is later set)."),f.markup("<span").attr("class",i).markup("></span>"),this.element.wrap(f.toString()).addClass(g),this.wrapper$=this.element.closest(j),this._createShowAllButton(),this._on(this.element,{keydown:function(b){(b.altKey||b.metaKey)&&b.which===a.ui.keyCode.DOWN&&(k.menu$.menu("open",k.element,!1),k.menu$.find(":focusable").first().focus())}}),this.actions.add({name:this.baseId+r,label:d.getMessage("APEX.COMBOBOX.LIST_OF_VALUES"),set:function(a){var b=k.element.val();l.multipleValues?k.element.val((b?b+l.multipleValueDelimiter:b)+a):k.element.val(a),b!==k.element.val()&&k.element.change()},get:function(){return k.element.val()},choices:l.source})},_setOption:function(b,c){switch(this._super(b,c),b){case"multipleValues":break;case"source":this.actions.lookup(this.baseId+r).choices=c,this.actions.updateChoices(this.baseId+r);break;case"label":a("#"+this.baseId+t,this.wrapper$).attr("title",d.formatMessage("APEX.COMBOBOX.SHOW_ALL_VALUES",c)).attr("aria-label",d.formatMessage("APEX.COMBOBOX.SHOW_ALL_VALUES",c))}},_createShowAllButton:function(){var c=b.htmlBuilder();c.markup("<button type='button'").attr("id",this.baseId+t).attr("tabindex","-1").attr("title",d.formatMessage("APEX.COMBOBOX.SHOW_ALL_VALUES",this.options.label)).attr("aria-label",d.formatMessage("APEX.COMBOBOX.SHOW_ALL_VALUES",this.options.label)).attr("class",k+" "+l+" "+m+" "+p).attr("data-menu",this.baseId+s).attr("aria-haspopup",!0).attr("aria-expanded",!1).markup(">"),c.markup("<span").attr("aria-hidden",!0).attr("class",n+" "+o).markup(">").markup("</span>"),c.markup("</button>"),this.wrapper$.append(c.toString()),this.menu$=a("<div/>",{id:this.baseId+s,"class":"",style:"display:none;"}).appendTo("body"),this.menu$.menu({actionsContext:this.actions,items:[{type:"radioGroup",action:this.baseId+r}]})},_destroy:function(){this.element.insertBefore(this.wrapper$),this.wrapper$.remove(),this.menu$.remove(),this.element.removeClass(g),c.removeContext(q,this.element[0])}})}(apex.jQuery,apex.util,apex.actions,apex.lang,apex.debug);
!function(a,b,c){"use strict";var d="a-Splitter",e="."+d,f="a-Splitter-barH",g="a-Splitter-barV",h="."+f+",."+g,i="a-Splitter--end",j="a-Splitter-thumb",k="."+j,l="u-RTL",m="is-focused",n="is-active",o="is-collapsed",p="is-disabled",q="button",r="title";a.widget("apex.splitter",{version:"5.0",widgetEventPrefix:"splitter",options:{orientation:"horizontal",positionedFrom:"begin",minSize:60,position:100,noCollapse:!1,dragCollapse:!0,collapsed:!1,snap:!1,inc:10,realTime:!1,iframeFix:!1,restoreText:null,collapseText:null,title:null,change:null},lastPos:null,bar$:null,before$:null,after$:null,horiz:!0,fromEnd:!1,barSize:1,_create:function(){var f,g,h,i,j,o,p=this,r=this.options,s=this.element,t=b.htmlBuilder(),u=a.ui.keyCode,v=!!r.snap&&[1*r.snap,1*r.snap],w=r.noCollapse?0:1,x=null;if(2!==s.children().length)throw new Error("Splitter must have exactly two children.");if("horizontal"!==r.orientation&&"vertical"!==r.orientation)throw new Error("Orientation bad value");if("begin"!==r.positionedFrom&&"end"!==r.positionedFrom)throw new Error("PositionedFrom bad value");if(r.minSize<w&&(r.minSize=w,c.warn("Option minSize adjusted")),this.horiz="horizontal"===r.orientation,this.fromEnd="end"===r.positionedFrom,o=this.horiz?"left":"top",this.before$=s.children().eq(0),this.after$=s.children().eq(1),s.addClass(d+" resize"),"rtl"===s.css("direction")&&(s.addClass(l),this.horiz&&(this.before$=s.children().eq(1),this.after$=s.children().eq(0),this.fromEnd=!this.fromEnd)),s.parent(e).length>0||this.before$.is(e)||this.after$.is(e))throw new Error("Child of splitter cannot be a splitter");this.before$[0].id||(this.before$[0].id=(s[0].id||"splitter")+"_first"),this.after$[0].id||(this.after$[0].id=(s[0].id||"splitter")+"_second"),r.position<r.minSize&&(r.position=r.minSize),this.lastPos=r.position,r.snap&&(r.inc=r.snap),this._renderBar(t),this.bar$=a(t.toString()).insertAfter(s.children().eq(0)),this.horiz?this.barSize=this.bar$.width():this.barSize=this.bar$.height(),s.css({position:"relative"}).children().css({position:"absolute"}),this.horiz?(f=this.bar$.position()[o],g=0,h="e-resize",this.fromEnd?(i=u.LEFT,j=u.RIGHT):(i=u.RIGHT,j=u.LEFT)):(f=0,g=this.bar$.position()[o],h="s-resize",this.fromEnd?(i=u.UP,j=u.DOWN):(i=u.DOWN,j=u.UP)),this.bar$.css({left:f,top:g}).draggable({axis:p.horiz?"x":"y",containment:"parent",cancel:q,cursor:h,iframeFix:r.iframeFix,grid:v,scroll:!1,drag:function(a,b){var c;r.realTime&&(c=b.position[o],p.fromEnd&&(c=(p.horiz?s.width():s.height())-c-p.barSize),p._setPos(c,!1))},start:function(a,b){p.bar$.addClass(n)},stop:function(a,b){var c=b.position[o];p.bar$.removeClass(n),p.fromEnd&&(c=(p.horiz?s.width():s.height())-c-p.barSize),p._setPos(c,!1)}}).click(function(){a(this).find(k).focus()}).find(q).click(function(){p._setPos(p._getPos(),!p._isCollapsed())}),apex.widget.util.TouchProxy.addTouchListeners(this.bar$[0]),this.bar$.find(k).focus(function(){a(this).parent().addClass(m+" "+n)}).blur(function(){a(this).parent().removeClass(m+" "+n)}).keydown(function(a){var b,c,d=a.keyCode,e=null,f=!1;if(d!==j||r.collapsed?d===i&&(e=p._getPos(),e<0?(r.noCollapse||(f=!0),e=0):e+=r.inc,b=p._getMaxPos(),e>b&&(e=b)):(e=p._getPos(),e-=r.inc,e<r.minSize&&r.noCollapse&&(e=r.minSize),e<0&&(e=0)),null!==e)return c=e,p.fromEnd&&(c=(p.horiz?s.width():s.height())-c-p.barSize),p.bar$.css(o,c),x&&(clearTimeout(x),x=null),x=setTimeout(function(){x=null,p._setPos(e,f)},100),!1}),this._on(!0,this._eventHandlers),r.disabled&&this._setOption("disabled",r.disabled),this.refresh()},_eventHandlers:{resize:function(c){var d,e,f,g,h=this.options,i=this.element;if(c.target===i[0]){if(d=i.height(),e=i.width(),0===d||0===e)throw new Error("Splitter needs to be in a component with size");g=i.offset(),this.horiz?(i.children().each(function(){b.setOuterHeight(a(this),d)}),this.fromEnd?(f=[g.left+h.minSize,g.top,g.left+e-this.barSize,g.top+d],h.dragCollapse&&!h.noCollapse||(f[2]-=h.minSize)):(f=[g.left,g.top,g.left+e-this.barSize-h.minSize,g.top+d],h.dragCollapse&&!h.noCollapse||(f[0]+=h.minSize+1))):(i.children().each(function(){b.setOuterWidth(a(this),e)}),this.fromEnd?(f=[g.left,g.top+h.minSize,g.left+e,g.top+d-this.barSize],h.dragCollapse&&!h.noCollapse||(f[3]-=h.minSize)):(f=[g.left,g.top,g.left+e,g.top+d-this.barSize-h.minSize],h.dragCollapse&&!h.noCollapse||(f[1]+=h.minSize+1))),this._setPos(h.position,h.collapsed),this.bar$.draggable("option","containment",f),i.children(".resize").filter(":visible").trigger("resize"),c.stopPropagation()}}},_destroy:function(){this.element.removeClass(d+" "+p+" "+l+" resize").children(h).remove(),this.element.children().css("position","")},refresh:function(){this.element.is(":visible")&&this.element.trigger("resize")},_setOption:function(b,d){var e,f,g;if(this.options.noCollapse&&("collapsed"===b||"restoreText"===b||"collapseText"===b))return void c.warn("Setting "+b+" option on noCollapse splitter has no effect.");if("orientation"===b||"positionedFrom"===b||"noCollapse"===b)throw new Error("Readonly option: "+b);"position"===b?this._setPos(1*d,this._isCollapsed()):"collapsed"===b?this._setPos(this._getPos(),!!d):"snap"===b?(d=!!d&&1*d,this.options.snap=d,e=!!d&&[d,d],this.bar$.draggable("option","grid",e),d&&(this.options.inc=d)):"inc"===b?(d=1*d,this.options.snap&&(d=this.options.snap),this.options.inc=d):"disabled"===b?(this.options.disabled=d,g=this.bar$.find(k),this.options.noCollapse?d?g.removeAttr("tabindex"):g.attr("tabindex","0"):(g[0].disabled=d,d?g.attr(r,this.options.title):g.attr(r,this.options.collapsed?this.options.restoreText:this.options.collapseText)),this.bar$.draggable("option","disabled",d),d?(this.element.addClass(p),this.bar$.addClass(p),g.attr("aria-disabled",!0)):(g.removeAttr("aria-disabled"),this.bar$.removeClass(p),this.element.removeClass(p))):"minSize"===b?(f=this.options.noCollapse?0:1,d<f&&(d=f,c.warn("Option minSize adjusted")),this.options.minSize=d):a.Widget.prototype._setOption.apply(this,arguments),"title"===b?(this.bar$.attr(r,d),(this.options.noCollapse||this.options.disabled)&&this.bar$.find(k).attr(r,d)):"restoreText"===b&&this.options.collapsed&&!this.options.disabled?this.bar$.find(q).attr(r,d):"collapseText"!==b||this.options.collapsed||this.options.disabled?"iframeFix"===b?this.bar$.draggable("option","iframeFix",d):"dragCollapse"===b&&this.refresh():this.bar$.find(q).attr(r,d)},_renderBar:function(a){var b=this.options,c=this.horiz?f:g;this.fromEnd&&(c+=" "+i),b.noCollapse&&(b.collapsed=!1),b.collapsed&&(c+=" "+o),a.markup("<div").attr("class",c).optionalAttr(r,b.title).markup("><div></div>"),b.noCollapse?a.markup("<span role='separator' class='"+j+"' tabindex='0' aria-expanded='true'").optionalAttr(r,b.title).markup("></span>"):a.markup("<button role='separator' class='"+j+"' type='button'").attr("aria-expanded",!b.collapsed).optionalAttr(r,b.collapsed?b.restoreText:b.collapseText).markup("></button>"),a.markup("</div>")},_getPos:function(){var a=this.element,b=this.horiz?"left":"top",c=this.bar$.position()[b];return this.fromEnd&&(c=(this.horiz?a.width():a.height())-c-this.barSize),c},_isCollapsed:function(){return this.bar$.hasClass(o)},_getMaxPos:function(){var a=this.options,b=this.element;return this.horiz?b.width()-this.barSize-a.minSize:b.height()-this.barSize-a.minSize},_setPos:function(a,c){var d,e,f,g,h,i,j=this.options,l=this.element,m=this.horiz?"left":"top",n=this._isCollapsed(),p=this.lastPos;j.noCollapse&&(c=!1),n&&!c&&(a=this.lastPos,a<j.minSize&&(a=j.minSize)),a<j.minSize?j.noCollapse?a=j.minSize:c=!0:(d=this._getMaxPos(),a>d&&(a=d)),j.noCollapse&&a<=0&&(a=0),a>0&&(this.lastPos=a),c&&(a=0,j.position=0),e=this.horiz?l.width():l.height(),h=a,this.fromEnd&&(h=e-a-this.barSize),this.bar$.css(m,h),i=this.bar$.find(k),this.fromEnd?(f=this.after$,g=e-h-this.barSize):(f=this.before$,g=h),c?(this.bar$.addClass(o),j.disabled||i.attr("aria-expanded",!1).attr(r,j.restoreText),f.hide()):(j.noCollapse?f.toggle(0!==a):(this.bar$.removeClass(o),j.noCollapse||j.disabled||i.attr("aria-expanded",!0).attr(r,j.collapseText),f.show()),this.horiz?b.setOuterWidth(f,g):b.setOuterHeight(f,g)),this.fromEnd?(f=this.before$,g=h):(f=this.after$,g=e-h-this.barSize),this.horiz?b.setOuterWidth(f,g):b.setOuterHeight(f,g),j.noCollapse&&f.toggle(0!==g),this.after$.css(m,h+this.barSize+"px"),this.before$.css(m,0),(!c&&a!==p||n!==c)&&(j.collapsed=c,j.position=a,l.children(".resize").filter(":visible").trigger("resize"),this._trigger("change",{},{position:j.position,collapsed:j.collapsed,lastPosition:this.lastPos}))}});var s=0,t=0;a.apex.splitter.nextSplitter=function(b){var c,d,i,j=b?-1:1,l=a(document.activeElement);if(!(s>0||t>0))return d=a(e+" >."+f+","+e+" >."+g).filter(":visible").not(".ui-state-disabled").add(l),i=d.index(l),i>=0&&(i+=j,b&&l.parent().is(h)&&(i+=j),i>=0&&i<d.length&&(c=d.eq(i))),(c&&0===c.length&&!l.parent().is(h)||l.is("html,body"))&&(c=a(e+" >."+f+","+e+" >."+g).filter(":visible").not(".ui-state-disabled")[b?"last":"first"]()),c&&c.length>0?(c.children(k).focus(),!0):void 0},a(function(){a(document.body).on("menubeforeopen",function(){t+=1}).on("menuafterclose",function(){t-=1}).on("dialogopen",function(){s+=1}).on("dialogclose",function(){s-=1})}),apex.message&&apex.message.addVisibilityCheck(function(b){var c=a("#"+b);c.parents(".a-Splitter").each(function(){c.is(":visible")||a(this).splitter("option","collapsed",!1)})})}(apex.jQuery,apex.util,apex.debug);
!function(a,b,c,d,e,f){"use strict";function g(a){return d.getMessage("APEX.GV."+a)}function h(a){var b=Array.prototype.slice.call(arguments);return b[0]="APEX.GV."+a,d.formatMessage.apply(d,b)}var i="a-GV-noDataMsg",j="a-GV-moreDataMsg",k="a-GV-altMessage",l="."+k,m=k+"-text",n="."+m,o=k+"-icon",p="a-GV-footer",q="a-GV--hideDeleted",r="a-GV-scrollFiller",s="."+r,t="is-deleted",u="."+t,v="aria-selected",w="is-active",x="is-selected",y="is-expanded",z="."+x,A="aria-labelledby",B="js-tabbable",C="."+B,D=":tabbable",E="data-start",F="data-end",G="disabled",H=300,I="apexbeginrecordedit",J="apexendrecordedit",K={};f.widget("apex.tableModelViewBase",{version:"19.1",widgetEventPrefix:"tableModelViewBase",options:{modelName:null,noDataMessage:null,moreDataMessage:null,editable:!1,autoAddRecord:!1,hasSize:!1,progressOptions:null,stickyFooter:!1,pagination:{scroll:!1,loadMore:!1,showPageLinks:!1,maxLinks:5,showPageSelector:!1,showRange:!0,firstAndLastButtons:!1},highlights:{},highlighter:null,highlighterContext:null,rowsPerPage:null,selectionStatusMessageKey:"APEX.GV.SELECTION_COUNT",hideDeletedRows:!1,footer:!0,scrollParentOverride:null},firstPage:function(){var a;return!this.renderInProgress&&(this.options.pagination.scroll?(a=this.scrollParent$,a.scrollTop(this.scrollDelta)):this.pageOffset>0&&(this.pageOffset=0,this.refresh(!1)),!0)},previousPage:function(){var a,b;return!this.renderInProgress&&(this.options.pagination.scroll?(a=this.scrollParent$,b=a.scrollTop()-this.scrollDelta-this.displayPageHeight,b<0&&(b=0),a.scrollTop(b+this.scrollDelta)):this.pageOffset>0&&(this.pageOffset-=this.pageSize,this.pageOffset<0&&(this.pageOffset=0),this.refresh(!1)),!0)},nextPage:function(){var a,b,c,d;return!this.renderInProgress&&(this.options.pagination.scroll?(a=this.scrollParent$,b=this._getDataContainer().first().height()-this.displayPageHeight,c=a.scrollTop()-this.scrollDelta+this.displayPageHeight,c>b&&(c=b),a.scrollTop(c+this.scrollDelta)):(d=this.model.getTotalRecords(),(d<0||this.pageOffset+this.pageCount<d)&&(this.pageOffset+=this.pageSize,this.refresh(!1))),!0)},lastPage:function(){var a,b,c,d;return!this.renderInProgress&&(this.options.pagination.scroll?(b=this.scrollParent$,c=this._getDataContainer().first().height()-this.displayPageHeight,b.scrollTop(c+this.scrollDelta)):(d=this.model.getTotalRecords(),d>0&&(a=Math.ceil(d/this.pageSize),this.pageOffset=(a-1)*this.pageSize,this.refresh(!1))),!0)},loadMore:function(){var a=this.model.getTotalRecords();return!this.renderInProgress&&(this.options.pagination.scroll&&!this.scrollPaging?(a<0||this.pageOffset+this.pageCount<a-1)&&(this.pageOffset+=this.pageSize,this._addPageOfRecords()):this.nextPage(),!0)},gotoPage:function(a){var b,c=this.model.getTotalRecords();return!this.renderInProgress&&(c>0&&(b=Math.ceil(c/this.pageSize),a>=0&&a<b&&(this.pageOffset=a*this.pageSize,this.refresh(!1))),!0)},getActiveRecordId:function(){return this.activeRecordId},getActiveRecord:function(){return this.activeRecord},setActiveRecordValue:function(a){var b=this.columnItems[a];this.activeRecord&&b&&(this.ignoreItemChange=!0,this._setModelValue(null,b.item,this.activeRecord,a,!0),this.ignoreItemChange=!1)},lockActive:function(){this.activeRecord&&(this.activeLockCount+=1)},unlockActive:function(){this.activeRecord&&(this.activeLockCount-=1,this.activeLockCount<0&&(this.activeLockCount=0),0===this.activeLockCount&&(this.activeUnlockCallback&&(this.activeUnlockCallback(),this.activeUnlockCallback=null),this.finishEditingCallback&&(this.finishEditingCallback(),this.finishEditingCallback=null)))},finishEditing:function(){function a(){b._finishEditing?b._finishEditing(c):c.resolve()}var b=this,c=f.Deferred();return this.activeLockCount>0?this.finishEditingCallback=a:a(),c.promise()},addStateIcon:function(b,c,d){var e=a.htmlBuilder();this.stateIconMessages[b]=d,0===this.stateIcons$.find("[data-state='"+b+"']").length&&(e.markup("<span tabindex='0'").attr("class",c).attr("data-state",b).markup("></span>"),this.stateIcons$.append(e.toString()))},removeStateIcon:function(a){this.stateIcons$.find("[data-state='"+a+"']").remove(),delete this.stateIconMessages[a]},_create:function(){var a=this.options;a.hideDeletedRows&&this.element.addClass(q),this.pageOffset=0,this.pageCount=0,this.pageSize=10,this.noData=!0,this.onLastPage=!1,this.lastScrollLeft=null,this.lastScrollTop=null,this.stateIconMessages={},this.reinitCallbacks=null,this.pendingRefresh=null,this.activeRecord=null,this.activeRecordId=null,this.activeLockCount=0,this.activeUnlockCallback=null,this.columnItems=null,this.columnItemsContainer$=null,a.progressOptions||(a.progressOptions={fixed:!a.hasSize}),a.pagination.scroll&&(a.rowsPerPage=null),a.rowsPerPage&&(this.pageSize=a.rowsPerPage)},_tableModelViewDestroy:function(){this.footer$.remove(),this.footer$=null,this.pageRange$=null,this.pageSelector$=null,this.status$=null,this.stateIcons$=null,this.element.removeClass(q),this._scrollHandler&&this.scrollParent$.off("scroll",this._scrollHandler)},_refreshCheckIfVisible:function(){return null===this.element[0].offsetParent?(this.pendingRefresh=!0,!1):(this.pendingRefresh=!1,!0)},_initModel:function(a,c){function d(a,b){var c,d,h,i,j,k,l,m,n,o;if(!g.pendingRefresh){if("refresh"===a)g.pageOffset=0,g.pageCount=0,g.refresh();else if("refreshRecords"===a||"revert"===a)for(d=g._elementsFromRecordIds(b.recordIds),c=0;c<d.length;c++)h=d[c],h&&(i=b.records[c],k=b.recordIds[c],j=b.newIds[k]||k,l=g.model.getRecordMetadata(j),g._replaceRecord(h,i,k,j,l));else if("move"===a)for(o=b.records,b.insertAfterId&&(d=g._elementsFromRecordIds([b.insertAfterId]),h=d.length>0?d[0]:null),c=o.length-1;c>=0;c--)i=o[c],j=g.model.getRecordId(i),l=g.model.getRecordMetadata(j),d=g._elementsFromRecordIds([j]),d.length>0&&d[0]&&g._removeRecord(d[0]),m=g._insertRecord(h,i,j,l,h?"after":"before");else if("insert"===a||"copy"===a)if(o="insert"===a?[b.record]:b.records,b.insertAfterId&&(d=g._elementsFromRecordIds([b.insertAfterId]),h=d.length>0?d[0]:null),g.noData)setTimeout(function(){g.refresh(),d=g._elementsFromRecordIds([g.model.getRecordId(o[0])]),d.length>0&&d[0]&&g._afterInsert(d)},1);else{for(n=[],c=o.length-1;c>=0;c--)i=o[c],j=g.model.getRecordId(i),l=g.model.getRecordMetadata(j),m=g._insertRecord(h,i,j,l,h?"after":"before"),n.push(m);g._afterInsert(n)}else if("clearChanges"===a){if(e)for(d=g._elementsFromRecordIds(b.deletedIds),c=0;c<d.length;c++)d[c]&&g._removeRecord(d[c]);for(d=g._elementsFromRecordIds(b.changedIds),c=0;c<d.length;c++)h=d[c],h&&(j=b.changedIds[c],l=g.model.getRecordMetadata(j),i=g.model.getRecord(j),g._updateRecordState(h,j,i,l))}else if(b.recordIds){for(d=g._elementsFromRecordIds(b.recordIds),c=0;c<d.length;c++)h=d[c],h&&(j=b.recordIds[c],l=g.model.getRecordMetadata(j),i=b.records[c],"delete"===a?(!f.hideDeletedRows&&e||g._removeFocus(h),e&&null!==l?g._updateRecordState(h,j,i,l):g._removeRecord(h)):g._updateRecordState(h,j,i,l));"delete"===a&&(0===g.model.getTotalRecords()?g.refresh():f.hideDeletedRows&&(g.element.find(u).removeClass(x).removeAttr(v),g._updateStatus()))}else"set"===a||"metaChange"===a?g.ignoreFieldChange||(i=b.record,j=g.model.getRecordId(i),b.oldIdentity&&g._identityChanged(b.oldIdentity,j),l=g.model.getRecordMetadata(j),d=g._elementsFromRecordIds([j]),d.length>0&&d[0]&&("set"===a&&g._updateRecordField(d[0],i,b.field,l),g._updateRecordState(d[0],j,i,l))):"instanceRename"===a&&g.modelName[1]===b.oldInstance&&(g.modelName[1]=b.newInstance);g._updateTotalRecords()}}var e,f=this.options,g=this;if(this.model&&(this.model.unSubscribe(this.modelViewId),this.modelName!==a&&b.release(this.modelName),this.model=null,this.modelName=null),a){if(this.modelName=a,this.model=b.get(a),!this.model)throw new Error("Model not found: "+a);this.modelViewId=this.model.subscribe({onChange:c||d,progressView:this.element,progressOptions:f.progressOptions}),e=this.model.getOption("onlyMarkForDelete")}},_renderButton:function(a,b,c,d){a.markup("<button class='"+b+"' type='button'").attr("aria-label",d).attr("title",d).markup("><span aria-hidden='true' class='a-Icon ").attr(c).markup("'></span></button>")},_renderAltDataMessages:function(a,b){function c(c,d,e){a.markup("<div class='"+c+" "+k+"' style='display:none;'><div class='"+o+"'>").markup("<span aria-hidden='true' class='a-Icon "+d+"'></span>").markup("</div><span class='"+m+"'").optionalAttr("id",b?b+"_msg":null).markup(">").markup(e).markup("</span></div>")}c(i,"icon-irr-no-results",this.options.noDataMessage),c(j,"icon-warning",this.options.moreDataMessage)},_renderLoadMore:function(a){var b=this.options;b.pagination.scroll&&b.pagination.loadMore&&!this.scrollPaging&&a.markup("<div class='a-GV-loadMore'><button type='button' class='js-load a-GV-loadMoreButton'>").content(g("LOAD_MORE")).markup("</button></div>")},_renderFooter:function(a,b){function c(){var c=g("PAGE_RANGE");a.markup("<span").optionalAttr("id",b?b+"_pageRange":null).attr("title",c).markup("><span class='u-vh'>").content(c).markup("</span><span class='a-GV-pageRange'></span></span>")}var d,e,f=this.options;f.footer&&(a.markup("<div class='"+p+"'><div class='a-GV-stateIcons'></div><div").optionalAttr("id",b?b+"_status":null).markup(" class='a-GV-status'></div><div class='a-GV-pagination'>"),f.pagination&&(d=!1,e=this.model.getOption("hasTotalRecords"),f.pagination.scroll||(e&&f.pagination.firstAndLastButtons&&this._renderButton(a,"a-GV-pageButton a-GV-pageButton--nav js-pg-first","icon-first",g("FIRST_PAGE")),this._renderButton(a,"a-GV-pageButton a-GV-pageButton--nav js-pg-prev","icon-prev",g("PREV_PAGE"))),e&&(f.pagination.showPageLinks||f.pagination.showPageSelector)?a.markup("<span class='a-GV-pageSelector'></span>"):f.pagination.showRange&&(c(),d=!0),f.pagination.scroll||(this._renderButton(a,"a-GV-pageButton a-GV-pageButton--nav js-pg-next","icon-next",g("NEXT_PAGE")),e&&f.pagination.firstAndLastButtons&&this._renderButton(a,"a-GV-pageButton a-GV-pageButton--nav js-pg-last","icon-last",g("LAST_PAGE"))),!d&&f.pagination.showRange&&c()),a.markup("</div></div>"))},_refreshPagination:function(a){var b=this.options;this.scrollPaging=b.pagination.scroll&&(this.model.getOption("hasTotalRecords")||!b.pagination.loadMore),this.lastScrollTop=0,this.lastScrollLeft=0,a.length&&(b.hasSize||(a=f(b.scrollParentOverride?b.scrollParentOverride:window)),this.lastScrollLeft=a.scrollLeft(),this.lastScrollTop=a.scrollTop())},_paginationHasFocus:function(){var a,b=f(document.activeElement);if(b.closest("."+p).length>0){if(b.parent().hasClass("a-GV-pageSelector-item"))return b.parent().attr("data-value");if(a=/js-pg-\S+/.exec(b.attr("class")))return"."+a[0]}return!1},_restorePaginationFocus:function(a){var b,c;a&&(b=a,b>=0&&(b="[data-value='"+a+"'] button"),c=this.footer$.find(b),c[0]&&c[0].disabled&&(c=this.footer$.find(":focusable").eq(0)),c.focus())},_initPaginationFooter:function(a){var b=this,c=this.options,d=this.element.hasClass("u-RTL")?"right":"left";this.pageKey=null,this.footer$=this.element.find("."+p),this.status$=this.footer$.find(".a-GV-status"),this.stateIcons$=this.footer$.find(".a-GV-stateIcons"),this.pageRange$=this.footer$.find(".a-GV-pageRange"),this.pageSelector$=this.footer$.find(".a-GV-pageSelector"),this.noData$=this.element.find("."+i),this.moreData$=this.element.find("."+j),f.ui.tooltip&&this.stateIcons$.tooltip({content:function(){var a=f(this).attr("data-state");return b.stateIconMessages[a]},items:"[data-state]",show:apex.tooltipManager.defaultShowOption(),tooltipClass:"a-GV-tooltip",position:{my:d+" bottom",at:d+" top-10",collision:"flipfit"}}),c.hasSize?(this.scrollParent$=a,b.scrollPaging&&a.on("scroll.tmv",function(){b._scrollPage()}),this.scrollDelta=0):this._updateScrollHandler(),c.pagination.scroll&&(this.pageOffset=0,this.pageCount=0),!c.hasSize&&c.footer&&c.stickyFooter&&f.apex.stickyWidget&&this.footer$.stickyWidget({isFooter:!0,toggleWidth:!0,stickToEnd:!0,top:function(){return b.element.offset().top+b._getHeaderHeight()}}),c.pagination.showPageLinks?this.pageSelector$.click(function(a){var c=f(a.target).parent();c.length&&b.gotoPage(parseInt(c.attr("data-value"),10)),a.preventDefault()}):c.pagination.showPageSelector&&this.pageSelector$.change(function(a){b.gotoPage(parseInt(f(a.target).val(),10))}),this.footer$.find(".js-pg-first").click(function(){b.firstPage()}),this.footer$.find(".js-pg-prev").click(function(){b.previousPage()}),this.footer$.find(".js-pg-next").click(function(){b.nextPage()}),this.footer$.find(".js-pg-last").click(function(){b.lastPage()}),this.element.find(".js-load").click(function(){b.loadMore()})},_footerHeight:function(){return this.footer$?this.footer$.outerHeight()||0:0},_addPageOfRecords:function(a){function b(){var b,d,e,l,n,o=null,p=j.displayPageHeight/j.displayPageSize;if(j.pageCount=c,0===j.pageOffset&&0===c)j.noData=!0,i.hide(),j.moreData$.hide(),j.noData$.show(),k.autoAddRecord&&j.model.allowAdd()&&j._autoAddRecord();else{if(0===c)return void(k.pagination.scroll||(j.pageOffset-=j.pageSize,j.pageOffset<0&&(j.pageOffset=0),j._addPageOfRecords()));j.noData=!1,j.noData$.hide(),j.model.getDataOverflow()&&k.moreDataMessage?(j.moreData$.show(),i.hide()):(j.moreData$.hide(),i.show()),j.scrollPaging&&j.model.getOption("hasTotalRecords")?(b=h.last().find(s),e=j.model.getTotalRecords(),n=e,0===b.length?(d=j._getDataRenderContext(),j._renderFillerRecord(d,r),b=j._insertFiller(d,null),b.attr(E,0),b.attr(F,e),b=b.last()):0===b.last().next().length&&(n=parseInt(b.last().attr(F),10)),2===h.length&&(o=h.first().find(s)),e!==n&&(b.last().attr(F,e),o&&o.last().attr(F,e)),l=j._getRecordsPerRow(),b.each(function(a){var e,h,i=f(o?[o[a],this]:this),k=!1,n=parseInt(i.last().attr(E),10),q=parseInt(i.last().attr(F),10);if(j.pageOffset<=n?(k=!0,j._insertData(m,g,c,i,"before"),n=j.pageOffset+c):j.pageOffset+c<=q?(d=j._getDataRenderContext(),j._renderFillerRecord(d,r),h=j._insertFiller(d,i),e=Math.floor((j.pageOffset-n)/l)*p,h.attr(E,n),h.attr(F,j.pageOffset-1),h.css("height",e),j.scrollParent$.scrollTop(j.scrollParent$.scrollTop()-j.scrollParent$.height()),k=!0,j._insertData(m,g,c,i,"before"),n=j.pageOffset+c):j.pageOffset+c!==q+1&&a!==b.length-1||(k=!0,j._insertData(m,g,c,i,"after"),q=j.pageOffset-1),k)return n>=q?i.remove():(i.attr(E,n),i.attr(F,q),e=Math.floor((q-n)/l)*p,i.css("height",e)),!1})):j._insertData(m,g,c)}j._updateTotalRecords(),a&&a()}var c,d,e,g,h,i,j=this,k=this.options,m=this._getDataRenderContext();this.renderInProgress||(i=j.noData$.parent().children().not(l),(this.noData||this.moreData$.is(":visible"))&&(this.noData$.hide(),this.moreData$.hide(),i.show(),this.resize()),h=j._getDataContainer(),0!==this.pageOffset&&k.pagination.scroll||(this.lastControlBreak=null,this.pageFirstOffset="",this.pageLastOffset=""),this.controlBreakCollapsed=!1,k.pagination.scroll&&this.pageLastOffset>=this.pageOffset&&h.find(".a-GV-controlBreak").last().each(function(){j.controlBreakCollapsed=!f(this).hasClass(y)}),c=0,e=this.pageSize,g=this.pageOffset,this.renderInProgress=!0,this.model.forEachInPage(this.pageOffset,e,function(a,f,g){var h,i,j;return!k.pagination.scroll&&f>=0&&(f<this.pageOffset||f>=this.pageOffset+e)?(c+=1,void(c!==e&&a||(this.renderInProgress=!1))):(a&&(h=g?this.model.getRecordMetadata(g):{},j=h.serverOffset,this._hasControlBreaks()&&!h.agg&&(i=!0,d=this._controlBreakLabel(a),null===this.lastControlBreak&&(this.lastControlBreak=d,this._renderBreakRecord(m,i,d,j),this.controlBreakCollapsed=!1),h.endControlBreak&&(this.lastControlBreak=null)),this._renderRecord(m,a,f,g,h),void 0!==j&&(j+=1,""===this.pageFirstOffset&&(this.pageFirstOffset=j),this.pageLastOffset=j),c+=1),void(c!==e&&a||(this.renderInProgress=!1,b())))},this))},_initPageSize:function(){var b,c,d,e,g=this.options,h=g.hasSize?this.scrollParent$[0]:document;h||(h=document),b=this._getRecordHeight(),h===document?(c=f(window).height(),this.footer$.hasClass("js-stickyWidget-toggle")&&(c-=this._footerHeight()),e=this._getStickyTop(),e>0&&(c-=e+this._getHeaderHeight())):c=h.offsetHeight,c-=a.getScrollbarSize().height,b<=0&&(b=24),d=Math.floor(c/b),d<1&&(d=1),this.displayPageSize=d,this.displayPageHeight=d*b,d*=this._getRecordsPerRow(),this.options.rowsPerPage||(this.pageSize=g.pagination.scroll?Math.max(40,2*d):d)},_updateStatus:function(){var a,b=this._selectedCount(),c="";this.options.hideDeletedRows&&(a=this._deletedCount()),b>0&&(c+=d.format(this._selectedStatusMessage(),b)),a>0&&(c&&(c+=", "),c+=h("DELETED_COUNT",a)+" "),this.status$.text(c)},_setModelValue:function(a,b,c,d,e){var f,h,i,j,k,l;a&&a.removeClass(w),h=b.getValue(),e||(this.ignoreFieldChange=!0),l=this.model.getRecordId(c),i=this.model.getValue(c,d),null!==i&&"object"==typeof i&&i.hasOwnProperty("v")&&(h={v:h,d:b.displayValueFor(h)}),f=this.model.setValue(c,d,h),"DUP"===f?(this._setColumnItemValue(b,c,d),apex.message.alert(g("DUP_REC_ID"))):(j=b.getValidity(),k=this.model.getRecordId(c),j.valid?this.model.setValidity("valid",k,d):this.model.setValidity("error",k,d,b.getValidationMessage()),k!==l&&this._identityChanged(l,k)),e||(this.ignoreFieldChange=!1)},_initColumnItems:function(a){var b,d,g,h,i,j=!0;for(this.columnItems={},this.columnItemsContainer$=null,b=0;b<a.length;b++)d=a[b],h=d.elementId,i=null,h&&(K[h]?(i=this.columnItems[d.property]=K[h],g=i.item):(g=e(h),g.node&&(j=!1,K[h]=i=this.columnItems[d.property]={element$:f("#"+h).closest(".a-GV-columnItem"),item:g})),i&&!this.columnItemsContainer$&&(this.columnItemsContainer$=i.element$.parent()));this.columnItemsContainer$?j||this.columnItemsContainer$.find(D).addClass(B).attr("tabindex",-1):this.editable&&c.error("An editable "+this.widgetName+" must have at least one column with a column item.")},_activateColumnItem:function(a,b){var c=a.element$;c.find(C).attr("tabindex",0).removeClass(B),c.find(D).first().attr(A,b)},_deactivateColumnItem:function(a,b){var c=a.element$,d=c.find(D);d.first().removeAttr(A),this.columnItemsContainer$.append(c),d.addClass(B).attr("tabindex",-1)},_renderFieldDataValue:function(b,c,d,e,f){var g,h,i,j=null,k=this.options;(f&&f.url||c.linkTargetColumn)&&!e.agg&&(j=c.linkTargetColumn?this.model.getValue(d,c.linkTargetColumn)||null:f.url),g=this.model.getValue(d,c.property),(e.agg||e.inserted&&c.readonly)&&this.model.isIdentityField(c.property)&&(g=""),(c.linkText||c.linkAttributes||c.cellTemplate)&&(h={model:this.model,record:d}),j&&(b.markup("<a").attr("href",j),c.linkAttributes&&b.markup(a.applyTemplate(c.linkAttributes,h)),b.markup(" tabindex='-1'>")),j&&c.linkText?b.markup(a.applyTemplate(c.linkText,h)):c.cellTemplate?e.agg?b.content(""):(g=a.applyTemplate(c.cellTemplate,h),k.highlighter&&(g=k.highlighter(k.highlighterContext,g,c)),b.markup(g)):null!==g&&""!==g||!(k.showNullAs||e.agg||j)?(null===g&&(g=""),"object"==typeof g&&g.hasOwnProperty("d")?g=g.d:(i=this.columnItems[c.property],i&&(g=i.item.displayValueFor(g))),c.escape!==!1&&(g=a.escapeHTML(""+g)),k.highlighter&&(g=k.highlighter(k.highlighterContext,g,c)),b.markup(g)):(g=e.agg||e.inserted||f&&(f.changed||f.error||f.warning)?"":j?j:k.showNullAs,b.content(g)),j&&b.markup("</a>")},_beginSetColumnItems:function(){this.reinitCallbacks=[]},_setColumnItemValue:function(a,b,c,d){var e,f=null,g=this.model.getValue(b,c);null!==g&&"object"==typeof g&&g.hasOwnProperty("d")&&(f=g.d,g=g.v),this.reinitCallbacks?(e=a.reinit(g,f),e&&this.reinitCallbacks.push(e)):a.setValue(g,f),d&&(d.fields&&d.fields[c]&&d.fields[c].disabled?a.disable():a.enable())},_endSetColumnItems:function(){var a,b=this.reinitCallbacks;if(b)for(a=0;a<b.length;a++)b[a]();this.reinitCallbacks=null},_autoAddRecord:function(a){var b=this.model.insertNewRecord(null,a);this.model.getRecordMetadata(b).autoInserted=!0},_triggerBeginEditing:function(a,b){this.element.trigger(I,[{model:this.model,record:a,recordId:b}])},_triggerEndEditing:function(a,b){this.element.trigger(J,[{model:this.model,record:a,recordId:b}])},_updateHighlights:function(){var a,b,c=this.options,d=[],e="";for(a in c.highlights)c.highlights.hasOwnProperty(a)&&(b=c.highlights[a],b.id=a,d.push(b));for(d.sort(function(a,b){return b.seq-a.seq}),a=0;a<d.length;a++)b=d[a],b.cssClass||(b.cssClass=(b.row?"hlr_":"hlc_")+b.id),(b.color||b.background)&&(e+=b.row?"."+b.cssClass+" td":"td."+b.cssClass,e+=" { ",b.color&&(e+="color: "+b.color+" !important; "),b.background&&(e+="background-color: "+b.background+" !important; "),e+="}\n");!this.gridStyles$&&e&&(this.gridStyles$=f("<style type='text/css'></style>"),f("head").append(this.gridStyles$)),this.gridStyles$&&(this.gridStyles$=this.gridStyles$.text(e))},_setOption:function(a,b){var d=this.options;this._super(a,b),"noDataMessage"===a?this.element.find(l+" > "+n).text(b):"rowsPerPage"===a?(d.pagination.scroll&&(d.rowsPerPage=null),d.rowsPerPage&&(this.pageSize=d.rowsPerPage)):"hideDeletedRows"===a?(this.element.toggleClass(q,b),b===!0&&this.element.find(u).removeClass(x).removeAttr(v),this._updateStatus()):"scrollParentOverride"===a&&(d.hasSize?c.warn("Ignoring scrollParentOverride when hasSize is true."):this._updateScrollHandler())},_updateScrollHandler:function(){var a=this,b=this.scrollParent$,c=this.options.scrollParentOverride;this.scrollParent$=f(c?c:window),this.scrollPaging&&(b&&this._scrollHandler?b.off("scroll",this._scrollHandler):this._scrollHandler=function(){a.element[0].clientWidth>0&&a._scrollPage()},this.scrollParent$.on("scroll",this._scrollHandler)),this.scrollDelta=this.element.offset().top-this._getStickyTop()},_scrollPage:function(){function a(a){return Math.floor(a/b.pageSize)*b.pageSize}var b=this,c=!this.model.getOption("hasTotalRecords"),d=this.scrollParent$.scrollTop();d!==this.lastScrollTop&&(this.lastScrollTop=d,this.scrollPageTimer||(this.scrollPageTimer=setTimeout(function(){var d,e,g,h,i,j,k,l,m=(b.options,b.displayPageHeight/b.displayPageSize);b.scrollPageTimer=null,b.renderInProgress||(j=b.scrollParent$.height(),j=2*j,k=0-j/2,l=k+2*j,c?(e=b._getDataContainer().first(),h=e.height(),g=(b.scrollParent$[0]===window?e.offset().top:e.position().top)-b.scrollParent$.scrollTop(),0-g+1.5*j>h&&(b.pageOffset+=b.pageSize,b._addPageOfRecords())):(d=b._getDataContainer().find(s),d.length||b.scrollParent$.off("scroll.tmv"),i=b.pageOffset,d.each(function(){var c,d,e=f(this),g=e.height(),h=parseInt(e.attr(E),10),n=parseInt(e.attr(F),10);if(h!==n)return d=(b.scrollParent$[0]===window?e.offset().top:e.position().top)-b.scrollParent$.scrollTop(),c=d+g,d<=l&&c>=k?(g<3*j||d+j>l?b.pageOffset=h:c-j<=l?b.pageOffset=a(n):b.pageOffset=a(h+Math.floor((g-c)/m)),b.pageOffset!==i&&b._addPageOfRecords(),!1):void 0})))},H)))},_updateTotalRecords:function(){var a,b,c,d,e,g,i,j,k=null,l=null,m=this.options,n=m.pagination,o=this.model.getTotalRecords(),p=this.model.getServerTotalRecords();if(o>=0&&(k=Math.ceil(o/this.pageSize),l=Math.floor(this.pageOffset/this.pageSize)),null!==this.lastScrollLeft&&(this.scrollParent$.scrollLeft(this.lastScrollLeft),this.scrollParent$.scrollTop(this.lastScrollTop),this.lastScrollLeft=null,this.lastScrollTop=null),this.onLastPage=!1,0===this.pageCount&&0===this.pageOffset?(d="",this.onLastPage=!0,this.footer$.find(".js-pg-prev,.js-pg-next,.js-pg-first,.js-pg-last").attr(G,!0)):(this.footer$.find(".js-pg-prev,.js-pg-next,.js-pg-first,.js-pg-last").attr(G,!1),this.element.find(".js-load").attr(G,!1),0===this.pageOffset&&this.footer$.find(".js-pg-prev,.js-pg-first").attr(G,!0),o>0&&l===k-1&&(this.onLastPage=!0,this.footer$.find(".js-pg-next,.js-pg-last").attr(G,!0),this.element.find(".js-load").attr(G,!0)),i=this.model.getOption("hasTotalRecords"),d=this.scrollPaging&&i?h("TOTAL_PAGES",p):i?h("PAGE_RANGE_XYZ",this.pageFirstOffset,this.pageLastOffset,p):h("PAGE_RANGE_XY",this.pageFirstOffset,this.pageLastOffset)),document.activeElement&&document.activeElement.disabled&&f(document.activeElement).hasClass("js-load")&&this.focus(),this.pageRange$.text(d),k>0){if(n.showPageLinks){if(g=o+"_"+this.pageSize+"_"+l,this.pageKey!==g){for(j="<li class='a-GV-pageSelector-item'>&hellip;</li>",this.pageKey=g,e="<ul class='a-GV-pageSelector-list'>",b=l-Math.floor(n.maxLinks/2),b<0&&(b=0),c=b+n.maxLinks,c>=k&&(c=k,b=c-n.maxLinks,b<0&&(b=0)),b>0&&(e+=j),a=b;a<c;a++)e+="<li class='a-GV-pageSelector-item' data-value='"+a+"'><button class='a-GV-pageButton' type='button'>"+(a+1)+"</button></li>";c<k&&(e+=j),e+="</ul>",this.pageSelector$.html(e)}this.pageSelector$.find(z).removeClass(x),this.pageSelector$.find("[data-value="+l+"]").addClass(x)}else if(n.showPageSelector){if(g=o+"_"+this.pageSize,this.pageKey!==g){for(this.pageKey=g,e="<select class='a-GV-pageSelectlist' size='1'>",a=0;a<k;a++)e+="<option value='"+a+"'>"+h("SELECT_PAGE_N",a+1)+"</option>";e+="</select>",this.pageSelector$.html(e)}this.pageSelector$.children("select").val(l)}}else this.pageSelector$.empty(),this.pageKey=null},_getHeaderHeight:function(){return 0},_getStickyTop:function(){return 0},_getRecordsPerRow:function(){return 1},_getDataRenderContext:function(){return a.htmlBuilder()},_getDataContainer:function(){return f()},_selectedCount:function(){return 0},_selectedStatusMessage:function(){return d.getMessage(this.options.selectionStatusMessageKey)},_deletedCount:function(){return 0},_hasControlBreaks:function(){return!1},_elementsFromRecordIds:function(a){return[]},_renderFillerRecord:function(a,b){},_insertFiller:function(a,b){return f()},_insertData:function(a,b,c,d,e){},_controlBreakLabel:function(a){return""},_renderBreakRecord:function(a,b,c,d){a.markup("<h3>").content(c).markup("</h3>")},_renderRecord:function(a,b,c,d,e){},_removeRecord:function(a){},_insertRecord:function(a,b,c,d,e){return f()},_afterInsert:function(a){},_identityChanged:function(a,b){},_replaceRecord:function(a,b,c,d,e){},_updateRecordField:function(a,b,c,d){},_removeFocus:function(a){},_updateRecordState:function(a,b,c,d){}});var L="a-TMV",M="a-TMV-body",N="a-TMV-w-scroll",O="."+N,P="is-disabled",Q=f.ui.keyCode;f.widget("apex.tableModelView",f.apex.tableModelViewBase,{version:"19.1",widgetEventPrefix:"tableModelView",options:{beforeTemplate:"<ul>",recordTemplate:null,afterTemplate:"</ul>",collectionClasses:null,iconClassColumn:null,imageURLColumn:null,imageAttributes:null,labelColumn:null,linkTarget:!1,linkTargetColumn:null,linkAttributes:null,useIconList:!1,iconListOptions:{},constrainNavigation:!0,selectionChange:null,pageChange:null},_create:function(){var a=this.options,b=this.element;c.info("TabelModelView '"+b[0].id+"' created. Model: "+a.modelName),b.addClass(L),this.rowHeight=null,this.recPerRow=null,this._super(),this._initModel(a.modelName),this._on(this._eventHandlers),this._initRecordTemplate(),this.refresh(),a.disabled&&this._setOption("disabled",a.disabled)},_eventHandlers:{keydown:function(a){var b,c=this.options,d=a.which;c.useIconList&&!a.isDefaultPrevented()&&(b=this.getIconList().options,!b.navigation&&b.noNavKeyContent&&f(a.target).closest(b.noNavKeyContent).length||(d!==Q.DOWN&&d!==this.getIconList().forwardKey||!c.pagination.loadMore?(d===Q.UP||d===this.getIconList().backwardKey)&&c.pagination.loadMore&&f(a.target).hasClass("js-load")&&(this.getIconList().focus(),a.preventDefault()):this.element.find(".js-load").not(":disabled").focus()[0]&&a.preventDefault(),!c.constrainNavigation||d!==Q.DOWN&&d!==Q.UP&&d!==Q.LEFT&&d!==Q.RIGHT&&d!==Q.PAGE_UP&&d!==Q.PAGE_DOWN||a.preventDefault()))},resize:function(a){a.target===this.element[0]&&(this.resize(),a.stopPropagation())}},_destroy:function(){this._tableModelViewDestroy(),this.element.removeClass(L+" "+P).empty(),this.data$=null,this._initModel(null)},_setOption:function(a,b){this.options;if(c.info("TabelModelView '"+this.element[0].id+"' set option '"+a+"' to: ",b),"iconListOptions"===a)throw new Error("TabelModelView "+a+" cannot be set. Set options directly on the iconList widget");if(this._super(a,b),"disabled"===a){if(this.element.toggleClass(P,b),this.options.useIconList)return this.getIconList().option(a,b);b&&this.resize()}else"modelName"===a?(this._initModel(b),this.refresh(!1)):"highlights"===a?this._updateHighlights():"beforeTemplate"===a||"recordTemplate"===a||"afterTemplate"===a||"collectionClasses"===a||"iconClassColumn"===a||"imageURLColumn"===a||"imageAttributes"===a||"labelColumn"===a||"linkTarget"===a||"linkTargetColumn"===a||"linkAttributes"===a?(this._initRecordTemplate(),this.refresh()):"footer"!==a&&"useIconList"!==a&&"pagination"!==a||this.refresh()},refresh:function(a){var b,c=!1,d=this,e=this.element;a!==!0&&(c=this._paginationHasFocus()),void 0===a&&(a=f(document.activeElement).closest(e).length>0),this._refreshCheckIfVisible()&&(this.data$&&(b=this.getSelectedRecords()),this._refreshPagination(e.find(O)),this._initView(),this._updateStatus(),this.resize(),this._addPageOfRecords(function(){c&&(d._restorePaginationFocus(c),a=!1),b&&b.length>0&&d.setSelectedRecords(b,a)}))},resize:function(){var a,b,c,d,e=this.element,g=this.options,h=e.height(),i=e.children().first(),j=e.find(O);if(null!==e[0].offsetParent){if(!i.length||this.pendingRefresh)return void this.refresh();a=e.width(),j.width(a),this.rowHeight=null,this.recPerRow=null,g.hasSize&&(b=h-this._footerHeight(),i.height(b),j.height(b)),g.useIconList&&(this.data$.iconList("resize"),this.scrollPaging&&(c=this._getRecordsPerRow(),d=this._getRecordHeight(),this.data$.find(s).each(function(){var a,b=f(this),e=parseInt(b.last().attr(E),10),g=parseInt(b.last().attr(F),10);a=Math.floor((g-e)/c)*d,b.css("height",a)}))),this._initPageSize()}},focus:function(){var a=this.getIconList();return a?a.focus():void this.data$.find(":focusable").first().focus()},getSelection:function(){var a=this.getIconList();return a?a.getSelection():null},setSelection:function(a,b,c){var d=this.getIconList();if(d)return d.setSelection(a,b,c)},getRecords:function(a){var b,c,d=this,e=[];return a.each(function(){b=f(this).attr("data-id"),b&&(c=d.model.getRecord(b),c&&e.push(c))}),e},getSelectedRecords:function(){return this.options.useIconList&&this.data$?this.getRecords(this.getSelection()):null},setSelectedRecords:function(a,b,c){var d,e=[],g={};if(this.options.useIconList&&this.data$){for(d=0;d<a.length;d++)g[this.model.getRecordId(a[d])]=1;this.data$.children().each(function(){var a=f(this).attr("data-id");g[a]&&e.push(this)}),this.setSelection(f(e),b,c)}},getIconList:function(){return this.options.useIconList&&this.data$?this.data$.data("apex-iconList"):null},_initRecordTemplate:function(){var a,b,c,d,e=/^\s*<[\w]+[^>]*>/,f=this.options;if(!f.recordTemplate){if(f.collectionClasses||(f.collectionClasses="a-TMV-defaultIconView"),!f.labelColumn)throw new Error("Option recordTemplate or labelColumn is required");f.beforeTemplate="<ul>",f.afterTemplate="</ul>",b="<li data-id='&APEX$ROW_ID.' class='&APEX$ROW_STATE_CLASSES.'>",f.linkTarget||f.linkTargetColumn?(d=f.linkTargetColumn?f.linkTargetColumn:"APEX$ROW_URL",b+="<a href='&"+d+".' class='a-IconList-content'"+(f.linkAttributes?" "+f.linkAttributes+" ":"")+">",c="</a>"):(b+="<span class='a-IconList-content'>",c="</span>"),(f.iconClassColumn||f.imageURLColumn)&&(b+="<span class='a-IconList-icon'>",b+=f.iconClassColumn?"<span class='&"+f.iconClassColumn+".'></span>":"<img src='&"+f.imageURLColumn+".'"+(f.imageAttributes?" "+f.imageAttributes+" ":"")+"/>",b+="</span>"),b+="<span class='a-IconList-label'>&"+f.labelColumn+".</span>",b+=c+"</li>",f.recordTemplate=b}a=e.exec(f.recordTemplate),a||(f.beforeTemplate.toLowerCase().match(/<ul|<ol/)?f.recordTemplate="<li>"+f.recordTemplate+"</li>":f.recordTemplate="<div>"+f.recordTemplate+"</div>")},_initView:function(){var a,b=this,c=this.options,d=this._getDataRenderContext();this.recordElement="div",a=/<([^ <>]*)/.exec(c.recordTemplate),a&&a.length>1&&(this.recordElement=a[1].toLowerCase()),d.markup("<div").attr("class",M).markup(">"),this._renderAltDataMessages(d),d.markup("<div").attr("class",N).optionalAttr("tabindex",c.useIconList?"-1":null).markup(">").markup(c.beforeTemplate).markup("<"+this.recordElement+" class='js-data-placeholder' style='display:none;'></"+this.recordElement+">").markup(c.afterTemplate),this._renderLoadMore(d),d.markup("</div></div>"),this._renderFooter(d),
this.element.html(d.toString()),this.data$=this.element.find(".js-data-placeholder").parent(),this.data$.empty().addClass(c.collectionClasses||""),c.useIconList&&(this.data$.iconList(c.iconListOptions),this.data$.on("iconlistselectionchange",function(a){b._updateStatus(),b._trigger("selectionChange",a)})),this._initPaginationFooter(this.element.find(O))},_initRecordMetrics:function(){var a,b=this.options;this.recPerRow=1,a=this.data$.children().filter(":visible").first(),a.length?(b.useIconList&&(this.recPerRow=this.getIconList().getColumns()),this.rowHeight=a.outerHeight()):(a=f(apex.util.applyTemplate(b.recordTemplate,{})),a=this.data$.append(a),b.useIconList&&(this.getIconList().refresh(),this.recPerRow=this.getIconList().getColumns()),this.rowHeight=a.outerHeight(),this.data$.empty())},_getRecordHeight:function(){return this.rowHeight||this._initRecordMetrics(),this.rowHeight},_getRecordsPerRow:function(){return this.recPerRow||this._initRecordMetrics(),this.recPerRow},_getDataContainer:function(){return this.data$},_selectedCount:function(){return this.options.useIconList?this.getIconList().getSelection().length:0},_hasControlBreaks:function(){return!1},_elementsFromRecordIds:function(a){var b,c,d=[];for(b=0;b<a.length;b++)c=this.data$.children("[data-id='"+a[b]+"']"),c[0]&&d.push(c);return d},_renderFillerRecord:function(a,b){a.markup("<"+this.recordElement+" class='"+b+"'></"+this.recordElement+">")},_insertFiller:function(a,b){var c=f(a.toString());return b?b.before(c):this.data$.html(c),c},_insertData:function(a,b,c,d,e){var f,g,h;d?d[e](a.toString()):this.data$.append(a.toString()),this.options.useIconList&&(g=this.element.find(O),h=g.scrollTop(),f=this.getIconList(),f.refresh(),g.scrollTop(h)),this._trigger("pageChange",null,{offset:b,count:c})},_controlBreakLabel:function(a){return""},_renderBreakRecord:function(a,b,c,d){a.markup("<h3>").content(c).markup("</h3>")},_renderRecord:function(a,b,c,d,e){var f,g,h=this.options,i="",j={};e.agg||(j.APEX$ROW_ID=""+d,j.APEX$ROW_INDEX=""+(c+1),e.url&&(j.APEX$ROW_URL=e.url),e.deleted?i+=" "+t:(e.inserted?i+=" is-inserted":e.updated&&(i+=" is-updated"),e.error?i+=" is-error":e.warning&&(i+=" is-warning"),e.highlight&&(f=h.highlights[e.highlight],i+=f&&f.cssClass?" "+f.cssClass:" "+e.highlight)),i&&(j.APEX$ROW_STATE_CLASSES=i),g=apex.util.applyTemplate(this.options.recordTemplate,{extraSubstitutions:j,model:this.model,record:b}),h.highlighter&&(g=h.highlighter(h.highlighterContext,g)),a.markup(g))},_removeRecord:function(a){a.remove()},_insertRecord:function(b,c,d,e,g){var h,i=a.htmlBuilder();return this._renderRecord(i,c,null,d,e),h=f(i.toString()),"after"===g&&b?b.after(h):this.data$.prepend(h),this.options.useIconList&&this.getIconList().refresh(),h},_afterInsert:function(a){},_identityChanged:function(a,b){var c,d,e=this._elementsFromRecordIds([a])[0];e&&(c=this.model.getRecord(b),d=this.model.getRecordMetadata(b),this._replaceRecord(e,c,a,b,d))},_replaceRecord:function(b,c,d,e,f){var g,h=a.htmlBuilder();this._renderRecord(h,c,g,e,f),b.replaceWith(h.toString()),this.options.useIconList&&this.getIconList().refresh()},_removeFocus:function(a){},_updateRecordState:function(a,b,c,d){this._replaceRecord(a,c,b,b,d)}})}(apex.util,apex.model,apex.debug,apex.lang,apex.item,apex.jQuery);
!function(a,b,c,d,e,f,g,h){"use strict";function i(a,b){var c="";return"start"===a?c=" u-tS":"end"===a?c=" u-tE":"left"===a?c=" u-tL":"right"===a?c=" u-tR":"center"!==a||b||(c=" u-tC"),c}function j(a,b,c){var d;return a.highlight&&(d=b.highlights[a.highlight],c+=d&&d.cssClass?" "+d.cssClass:" "+a.highlight),c}function k(a,b,c,d,e){var f=N;return a.agg?(f+=" "+Ka,f+=" a-GV-aggregate--"+a.agg,a.grandTotal&&(f+=" is-grandTotal")):((a.sel||c)&&(f+=" "+xa),a.deleted?f+=" "+Ha:(a.inserted?f+=" is-inserted":a.updated&&(f+=" is-updated"),a.error?f+=" is-error":a.warning&&(f+=" is-warning"),f=j(a,b,f),d.allowEdit(e)||(f+=" "+Ia))),f}function l(a,b,c,d,e,f,g){var h=!1,k=S;return k+=i(a.alignment),a.columnCssClasses&&(k+=" "+a.columnCssClasses),a.cellCssClassesColumn&&(k+=" "+f.getValue(g,a.cellCssClassesColumn)),e&&(e.hasClass(xa)&&(k+=" "+xa),e.hasClass(za)&&(k+=" "+za),e.hasClass(Ea)&&(k+=" "+Ea)),c&&(b.deleted||(c.error?k+=" is-error":c.warning?k+=" is-warning":c.changed&&(k+=" is-changed")),k=j(c,d,k),c.disabled&&(k+=" is-disabled"),h=c.ck),(h||a.readonly)&&(k+=" "+Ia),a.usedAsRowHeader&&!b.agg&&(k+=" "+ba),k}function m(a){return d.getMessage("APEX.GV."+a)}function n(a){var b=Array.prototype.slice.call(arguments);return b[0]="APEX.GV."+a,d.formatMessage.apply(d,b)}function o(a,b,c){for(var d,e,f=0,g=a.length-1;f<=g;)if(d=g+f>>1,e=c(b,a[d]),e>0)f=d+1;else{if(!(e<0))return d;g=d-1}return f}function p(a,b){return a.offset-b.offset}function q(a){return a.parent().children().index(a)}function r(a){var b=h(a.toString());return b.find("a,button,input,select,textarea").prop(tb,-1),b}function s(a){return h(a).closest(ia)}function t(a){return h(a).closest(na)}function u(a){return h(a).closest(T)}function v(a,b){var c,d,e=a.children();return e.last().hasClass(X)?(d=0,e.each(function(){if(d+=parseInt(h(this).attr(pb),10)||1,d>b)return c=h(this),!1})):c=e.eq(b),c}function w(a){var b;return a.hasClass(X)?(b=0,a.parent().children().each(function(){return this!==a[0]&&void(b+=parseInt(h(this).attr(pb),10)||1)})):b=q(a),b}function x(a){h(nb).on(Bb,function(b){b.which===vb.ESCAPE&&(h(nb).off(Bb),a())})}function y(){h(nb).off(Bb)}function z(a){var b=a.groupName||null;return b&&a.useGroupFor&&a.useGroupFor.indexOf("heading")<0&&(b=null),b}function A(a,b){var c=a.parent()[0],d={h:!1,v:!1};return a.outerHeight()+(b||parseInt(a.css("margin-top"),10))>c.clientHeight&&(d.v=!0),a.outerWidth()>c.clientWidth&&(d.h=!0),d}var B="a-GV",C="a-GV-hdr",D="."+C,E="a-GV-bdy",F="."+E,G="a-GV-w-frozen",H="."+G,I="a-GV-w-hdr",J="."+I,K="a-GV-w-scroll",L="."+K,M="a-GV-table",N="a-GV-row",O="."+N,P="."+M,Q="tr",R="td,th",S="a-GV-cell",T="."+S,U="a-GV-scrollFiller",V="a-GV-header",W="."+V,X="a-GV-headerGroup",Y="."+X,Z="a-GV-headerLabel",$="a-GV-columnControls",_="."+$,aa="a-GV-columnHandle",ba="a-GV-rowHeader",ca="u-selector",da=ca+" "+ca+"--single",ea="."+ca,fa="a-GV-selHeader",ga="."+fa,ha=ga+W,ia=".a-GV-header,.a-GV-headerGroup,.a-GV-cell,.a-GV-controlBreakHeader",ja=".a-GV-header,.a-GV-headerGroup",ka="a-GV-controlBreak",la="a-GV-controlBreakHeader",ma="."+la,na="."+S+",."+la,oa="js-tabTrap",pa="."+oa,qa="js-autoAdd",ra=".a-GV-floatingItem",sa="a-GV-floatingItemContent",ta="."+sa,ua="a-GV-expandCollapse",va="."+ua,wa=".a-GV-loadMoreButton",xa="is-selected",ya="."+xa,za="is-focused",Aa="is-hover",Ba="."+Aa,Ca="is-disabled",Da="is-expanded",Ea="is-active",Fa="."+Ea,Ga=Fa+T,Ha="is-deleted",Ia="is-readonly",Ja="tr."+Ha,Ka="is-aggregate",La="aria-selected",Ma="aria-multiselectable",Na="aria-readonly",Oa="aria-label",Pa="aria-expanded",Qa="aria-labelledby",Ra="aria-checked",Sa="u-RTL",Ta=":visible",Ua=":tabbable",Va=":disabled,.js-asc,.js-desc",Wa="none",Xa="sequence",Ya="label",Za="true",$a="false",_a="selectionChange",ab="modeChange",bb="sortChange",cb="columnReorder",db="columnResize",eb="activateColumnHeader",fb="cancelColumnHeader",gb="pageChange",hb="activateCell",ib=10,jb=40,kb=200,lb=10,mb=10,nb="body",ob="title",pb="colspan",qb="data-idx",rb="data-id",sb="data-rownum",tb="tabIndex",ub="tabindex",vb=h.ui.keyCode,wb=0,xb=a.invokeAfterPaint,yb="wheel";"onwheel"in document.body||(yb=void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll");var zb={begin:function(a,b,c){this.text=""},beginRow:function(a,b,c){a>0&&(this.text+="\r\n")},cell:function(a,b,c,d){a>0&&(this.text+="\t"),this.text+=d},endRow:function(){},end:function(){},toString:function(){return this.text}},Ab={begin:function(a,b,c){return 1===c.length&&b.records&&1===b.records.length?void(this.text=""):(this.table=!0,void(this.text="<table><tbody>"))},beginRow:function(a,b,c){this.table&&(this.text+="<tr>")},cell:function(b,c,d,e){this.table?this.text+="<td>"+a.escapeHTML(e)+"</td>":this.text+=a.escapeHTML(e)},endRow:function(){this.table&&(this.text+="</tr>")},end:function(){this.table&&(this.text+="</tbody></table>")},toString:function(){return this.text}},Bb="keydown.gridGlobalEscape",Cb=function(a,b,c){a.element.hasClass(B)&&(a._updateStatus(),b&&a._trigger(_a,c))},Db=a.debounce(Cb,1),Eb=a.debounce(Cb,350);h.widget("apex.grid",h.apex.tableModelViewBase,h.extend(!0,{version:"19.1",widgetEventPrefix:"grid",options:{showNullAs:"-",stickyTop:!1,columns:null,columnGroups:null,columnSort:!0,columnSortMultiple:!0,resizeColumns:!0,reorderColumns:!0,collapsibleControlBreaks:!0,aggregateLabels:{},aggregateTooltips:{},tabbableCellContent:"a,button",allowEditMode:!0,allowDelete:!0,allowInsert:!0,allowCopy:!0,skipReadonlyCells:!1,rowHeader:Wa,rowHeaderCheckbox:!1,rowHeaderLabelColumn:null,rowHeaderWidth:null,selectCells:!1,multiple:!1,multipleCells:!0,selectAll:!0,allowSelectHidden:!1,persistSelection:!1,tooltip:{tooltipClass:"a-GV-tooltip"},dataTransferFormats:[{format:"text/plain",writer:Object.create(zb)},{format:"text/html",writer:Object.create(Ab)}],constrainNavigation:!0,selectionChange:null,activateColumnHeader:null,activateCell:null,cancelColumnHeader:null,sortChange:null,columnReorder:null,columnResize:null,modeChange:null,pageChange:null},_create:function(){var a=this,b=this.options,d=this.element;c.info("Grid '"+d[0].id+"' created. Model: "+b.modelName),d.addClass(B).attr("role","grid"),b.multiple&&d.attr(Ma,Za),b.editable||d.attr(Na,Za),this.forwardKey=vb.RIGHT,this.backwardKey=vb.LEFT,"rtl"===d.css("direction")&&(d.addClass(Sa),this.forwardKey=vb.LEFT,this.backwardKey=vb.RIGHT),this._enforceOptionConstraints(),this._super(),this.origLabelBy=d.attr(Qa),this.idPrefix=d[0].id||"agv_"+wb++,this.accContextId=this.idPrefix+"_ctx",this.curRowHeaders="",this.tableFrozenHeader$=null,this.tableHeader$=null,this.tableFrozenData$=null,this.tableData$=null,this.lastEditModeCell=null,this.frozenColumnCount=0,this.controlBreaks=[],this.editMode=!1,this.columns=null,this.columnsStale=!0,this.columnGroups=null,this.lastFrozenColIndex=-1,this.lastFocused=null,this.lastRow$=null,this.focusInHeader=!1,this.lastHoverCell=null,this.lastHoverRow=null,this.lastColIndex=null,this.columnControls$=null,this.scrollTimerId=null,this.deactivateDelayTimer=null,this.lastFloatingPos={},this.allSelected=!1,this.gotoCellPending=null,this._initContextMenu(Q,function(b){return h(b.target).closest("a").length>0||a.editMode},function(b){var c;if(c=u("keydown"===b.type?this.lastFocused:b.target),c.length){if(a.options.selectCells){if(!c.hasClass(xa))return c}else if(!c.parent().hasClass(xa))return c;return!0}return!1},function(b){a.options.selectCells?b.selectedRange=a.getSelectedRange():b.selectedRecords=a.getRecords(b.selection)}),this._initModel(b.modelName),this._on(this._eventHandlers),b.allowCopy&&f.addHandler(d[0],function(b){return!a.editMode&&(a._copy(b),!0)}),this._updateHighlights(),this.refresh(),this._setSelectionMode(),b.disabled&&this._setOption("disabled",b.disabled)},_eventHandlers:{resize:function(a){a.target===this.element[0]&&(this.resize(),a.stopPropagation())},click:function(a){var b,c,d=this.options,e=h(a.target);if(e.closest("a,button,.a-GV-footer").length)return b=e.closest(ja),void(b.length?(this.focusInHeader=!0,this.lastColIndex=null,this._select(b,a,!0,!1)):(b=e.closest(na),b.length&&!this.editMode&&(this.focusInHeader=!1,this.lastColIndex=null,this._select(b,"none",!1,!1),e.focus())));if(!(e.closest(ra).length>0)){if(b=e.closest(ha),b.length)return this.focusInHeader=!0,this.lastColIndex=null,void(d.rowHeaderCheckbox&&d.multiple&&d.selectAll&&!d.selectCells?(c=b.find(ea).attr(Ra)===Za,c?this.setSelection(h()):this.selectAll(),this._select(b,a,!0,!1),this._setFocusable(b[0])):this._select(b,a,!0,!1));if(b=e.closest(Y),b.length)return this.focusInHeader=!0,this.lastColIndex=null,this._select(b,a,!0,!1),void a.preventDefault();if(b=e.closest(W),b.length&&0===e.closest("button").length)return this.focusInHeader=!0,this.lastColIndex=null,this._select(b,a,!0,!1),this._activateColumnHeader(a,b),void a.preventDefault();if(b=e.closest(ga),b.length)return d.rowHeaderCheckbox&&!d.selectCells&&(a.ctrlKey=!0,a.shiftKey=!1),this.focusInHeader=!1,this.lastColIndex=null,this._select(b,a,!0,!1),void a.preventDefault();b=e.closest(T),b.length&&(this.focusInHeader=!1,this.lastColIndex=null,b.hasClass(Ea)||(this._select(b,a,!0,!1),a.preventDefault())),b=e.closest(ma),b.length&&(this.focusInHeader=!1,this.lastColIndex=null,this._select(b,a,!0,!1),a.preventDefault())}},dblclick:function(a){var b=this.options,c=h(a.target).closest(T).not(ga);c.length&&(b.editable&&b.allowEditMode?this.editMode||this.setEditMode(!0):this._fireActivate(a,c))},mousedown:function(a){var b=h(a.target);return 0!==a.originalEvent.button||b.closest("a,button,.a-GV-footer").length?void(this.focusInHeader=b.closest(ja).length>0):void(!b.closest(va).length&&this.editMode||a.preventDefault())},keydown:function(a){function b(){f.hasClass(fa)?f.find(ea).click():(n._activateColumnHeader(a,f),a.preventDefault())}function c(a,b){var c,d=null;for(a+=b,c=a;c>=0&&c<n.columns.length;c+=b)if(!n.columns[c].hidden){d=c;break}return d}var d,e,f,g,i,j,k,l,m,n=this,o=this.options,p=null,r=a.which,v=h(a.target);if(!(v.closest(".a-GV-footer").length>0)){if(r!==vb.PAGE_UP&&r!==vb.PAGE_DOWN||(j=this.displayPageSize),r===vb.HOME)!this.editMode&&this.lastFocused&&(this.lastColIndex=null,p=this.lastRow$.first(),a.preventDefault());else if(r===vb.END)!this.editMode&&this.lastFocused&&(this.lastColIndex=null,p=this.lastRow$.last(),a.preventDefault());else if(r===vb.PAGE_DOWN)this.focusInHeader||this.editMode&&!s(this.lastFocused).hasClass(fa)||a.altKey||(p=this._getNextCellDown(t(this.lastFocused),j),!p&&o.pagination.loadMore&&this.element.find(".js-load").focus(),a.preventDefault());else if(r===vb.PAGE_UP)this.focusInHeader||this.editMode&&!s(this.lastFocused).hasClass(fa)||a.altKey||(p=this._getPrevCellUp(t(this.lastFocused),j,!0),a.preventDefault());else if(r===vb.DOWN){if(f=s(this.lastFocused),o.columnSort&&a.altKey&&f.hasClass(V))return void n._sortChange(a,f,"desc");(!this.editMode||this.focusInHeader||f.hasClass(fa)||f.hasClass(la))&&this.lastFocused&&!a.altKey&&(p=this._getNextCellDown(f,1),!p&&o.pagination.loadMore&&this.element.find(".js-load").focus()[0]&&a.preventDefault(),(p||o.constrainNavigation)&&a.preventDefault()),v.closest(".js-menuButton").length&&a.stopPropagation()}else if(r===vb.UP){if(f=s(this.lastFocused),o.columnSort&&a.altKey&&f.hasClass(V))return void n._sortChange(a,f,"asc");(!this.editMode||this.focusInHeader||f.hasClass(fa)||f.hasClass(la))&&this.lastFocused&&!a.altKey&&(v.hasClass("js-load")?(this.focus(),a.preventDefault()):p=this._getPrevCellUp(f,1),(p||o.constrainNavigation)&&a.preventDefault(),a.stopPropagation())}else if(r===this.backwardKey){if(a.altKey)return;if(f=s(this.lastFocused),(a.ctrlKey||a.shiftKey)&&(f.hasClass(V)||f.hasClass(X))&&(!f.hasClass(fa)||o.rowHeader===Xa||o.rowHeader===Ya)&&(i=parseInt(f.attr(qb),10),!isNaN(i)||a.ctrlKey||o.rowHeader===Xa||o.rowHeader===Ya))if(i>=0&&(g=this.columns[i]),a.shiftKey&&o.reorderColumns){if(a.preventDefault(),f.hasClass(X))k=q(f.parent()),i>0&&(this.moveColumnGroup(k,i,i-1),f=h(this.lastFocused).closest(Y));else if(i=c(i,-1))return void this.moveColumn(g,i)}else if(a.ctrlKey&&o.resizeColumns&&!f.hasClass(X))return void(g?f.outerWidth()>jb&&(m=f.outerWidth()-ib,m<jb&&(m=jb),this.setColumnWidth(g,m)):n.rowHeaderWidth>jb&&(m=n.rowHeaderWidth-ib,m<jb&&(m=jb),n.rowHeaderWidth=m,this._calculateColumnWidths(f,!0)));(!this.editMode||this.focusInHeader||f.hasClass(la))&&this.lastFocused&&(this.lastColIndex=null,e=this.lastRow$.index(f),e>0&&(e-=1,p=this.lastRow$.eq(e)),a.preventDefault())}else if(r===this.forwardKey){if(a.altKey)return;if(f=s(this.lastFocused),(a.ctrlKey||a.shiftKey)&&(f.hasClass(V)||f.hasClass(X))&&(!f.hasClass(fa)||o.rowHeader===Xa||o.rowHeader===Ya)&&(i=parseInt(f.attr(qb),10),!isNaN(i)||a.ctrlKey||o.rowHeader===Xa||o.rowHeader===Ya))if(i>=0&&(g=this.columns[i]),a.shiftKey&&o.reorderColumns){if(a.preventDefault(),f.hasClass(X))k=q(f.parent()),i<this.columnGroups[k].length-1&&(this.moveColumnGroup(k,i,i+1),f=h(this.lastFocused).closest(Y));else if(i=c(i,1))return void this.moveColumn(g,i)}else if(a.ctrlKey&&o.resizeColumns&&!f.hasClass(X))return void(g?this.setColumnWidth(g,f.outerWidth()+ib):(n.rowHeaderWidth+=ib,this._calculateColumnWidths(f,!0)));(!this.editMode||this.focusInHeader||f.hasClass(la))&&this.lastFocused&&(this.lastColIndex=null,e=this.lastRow$.index(f),e<this.lastRow$.length-1&&(e+=1,p=this.lastRow$.eq(e)),a.preventDefault())}else if(65===r&&a.ctrlKey&&!this.editMode)this.selectAll(null),a.preventDefault();else if(r===vb.SPACE){if("BUTTON"===a.target.nodeName)return;if(f=v.filter(ga).find(ea),f.length)return f.click(),void a.preventDefault();f=s(this.lastFocused),f.hasClass(V)?b():!f.hasClass(S)||this.editMode&&!f.hasClass(fa)||(this._select(f,a,!0,!0),a.preventDefault())}else if(r===vb.ENTER){if(!v.hasClass(ua)&&v.closest("a,button,.js-uses-enter").length>0)return;if(f=v.filter(ga).find(ea),f.length)return void f.click();f=s(this.lastFocused),this.editMode&&(f.hasClass(S)||f.hasClass(la))?a.shiftKey?(p=this._getPrevCellUp(f,1,!0),a.shiftKey=!1):p=this._getNextCellDown(f,1):(a.preventDefault(),o.editable&&o.allowEditMode&&f.hasClass(S)&&!f.hasClass(fa)?this.setEditMode(!0):f.hasClass(V)?b():o.editable&&o.allowEditMode||!f.hasClass(S)||this._fireActivate(a,f))}else if(113===r)f=u(this.lastFocused),f.length&&o.editable&&o.allowEditMode&&!this.editMode&&this.setEditMode(!0);else if(r===vb.ESCAPE)o.editable&&o.allowEditMode&&this.editMode&&this._doEscapeKey(a);else if(r===vb.DELETE){if(o.editable&&o.allowDelete&&!this.editMode&&!this.focusInHeader){for(l=this.getSelectedRecords(),d=0;d<l.length;d++)this.model.allowDelete(l[d])||(l.splice(d,1),d-=1);l.length>0&&this.model.deleteRecords(l)}}else 45===r?o.editable&&o.allowInsert&&!this.editMode&&!o.selectCells&&this.model.allowAdd()&&(l=this.getSelectedRecords(),l.length>0?this.model.insertNewRecord(null,l[l.length-1]):this.model.insertNewRecord()):112===r&&a.altKey?this._doHelpKey():r===vb.TAB&&this.editMode&&(this.lastKeyTab=!0);p&&(this._select(p,a,!0,!0),a.preventDefault())}},focusin:function(a){var b,c,d=null,e=this,f=h(a.target);return f.closest(ra).length?void this._clearDeactivate():(b=f.closest(ia),0===b.length?void(f.hasClass(oa)||(this.lastEditModeCell=null)):(b.addClass(za),this.lastEditModeCell===b[0]?void this._clearDeactivate():(this.editMode?(this.focusInHeader=!1,c=h(this.lastEditModeCell),this._clearDeactivate(),c.length&&this._deactivateCell(c),b.hasClass(S)||b.hasClass(la)?!b.hasClass(fa)&&!b.hasClass(la)||this.lastKeyTab?(f.closest("a,button").length&&(d=a.target),setTimeout(function(){e.editMode&&!b.hasClass(Ea)&&e._activateCell(b,d)},1)):(this._clearTabTraps(),this.lastEditModeCell=null,this._setFocusable(a.target),this._setTabTraps(b)):(this.focusInHeader=!0,this.lastEditModeCell=null,this._setFocusable(a.target))):this._setFocusable(a.target),void(this.lastKeyTab=!1))))},focusout:function(a){var b=h(a.target),c=b.closest(ia);c.removeClass(za),this.editMode&&c.hasClass(S)&&(null===this.lastEditModeCell&&this._clearTabTraps(),this._beginDeactivate(c))},mousemove:function(a){var b,c,d,e,f,g=h(a.target),i=this.options,j=g.closest(ia);j.length?j[0]!==this.lastHoverCell&&(b=j.parent(),b[0]!==this.lastHoverRow&&(this._clearHoverStates(),this.lastHoverRow=b[0],!b.hasClass(N)&&!b.hasClass(ka)||this.columnReordering||this.columnWidthDragging||this._setRowHoverState(b)),this.lastHoverCell=j[0],this.columnControls$.hide(),this.columnHandle$.hide(),"TH"!==j[0].nodeName||j.hasClass(S)||b.hasClass(ka)||(e=this.columns[j.attr(qb)],!i.columnSort||this.columnReordering||this.columnWidthDragging||j.hasClass(fa)||j.hasClass(X)||!e.canSort||(j.append(this.columnControls$.show()),this._updateColumnControls(e)),!i.reorderColumns||this.columnReordering||this.columnWidthDragging||j.hasClass(fa)||(this.columnReorderCell$=j,j.append(this.columnHandle$.show().css("left",""))),!i.resizeColumns||this.columnReordering||this.columnWidthDragging||j.hasClass(fa)&&i.rowHeader!==Xa&&i.rowHeader!==Ya||(c=j.closest("div")[0],d=j[0].offsetLeft+c.offsetLeft-c.scrollLeft,this.element.hasClass(Sa)||(d+=j.outerWidth()),this.columnWidthHandle$.show().css("left",d-this.columnWidthHandle$.width()/2),f=j.attr(qb),f?this.columnWidthCell$=this._columnFromIndex(f):this.columnWidthCell$=this.element.find(W+ga)))):null!==this.lastHoverCell&&(this.lastHoverCell=null,this.lastHoverRow=null,this._clearHoverStates())},mouseleave:function(){null!==this.lastHoverCell&&(this.lastHoverCell=null,this.lastHoverRow=null,this._clearHoverStates())}},_doEscapeKey:function(a){var b=u(this.lastFocused);b.length&&this._setFocusable(b[0]),b.focus(),this.setEditMode(!1),b.length&&this._setFocus(this._getCellFocusable(b)),a.stopPropagation()},_doHelpKey:function(){var a,b=s(this.lastFocused);b.hasClass(fa)||b.hasClass(X)||b.hasClass(la)||(a=this._getColumnMetadata(b),a&&a.helpid&&(this.editMode&&b.focus(),apex.theme.popupFieldHelp(a.helpid,$v("pInstance"))))},_initTooltips:function(b){var d,e=this;return h.ui.tooltip?(this.tooltipOptions&&(this.element.find(F).filter(":data('ui-tooltip')").tooltip("destroy"),this.tooltipOptions=null),void(b&&(d=this.tooltipOptions=h.extend(!0,{show:apex.tooltipManager.defaultShowOption(),tooltipClass:"a-GV-tooltip"},b),d.items=R,d._originalContent=d.content,d.content=function(b){var c,f,g,i=h(this),j=i.parent(),k=null,l=null,m=e._getColumnMetadata(i);if(c=j.attr(rb),c&&(k=e.model.getRecordMetadata(c)),m&&k&&k.fields&&(l=k.fields[m.property]),k&&!k.deleted){if(l&&(l.error||l.warning))return f=l.error?"is-error":"is-warning","<span class='"+f+"'>"+a.escapeHTML(l.message)+"</span>";if((k.error||k.warning)&&i.hasClass(fa))return f=k.error?"is-error":"is-warning","<span class='"+f+"'>"+a.escapeHTML(k.message)+"</span>";if(k.agg&&m&&(g=e.options.aggregateTooltips[k.agg+"|"+m.property]))return"<span class='"+f+"'>"+a.escapeHTML(g)+"</span>"}return d._originalContent?d._originalContent.call(this,b,e.model,k,l,m):null},d.open=function(a,b){b.tooltip.find(".is-error").length&&b.tooltip.addClass("is-error"),b.tooltip.find(".is-warning").length&&b.tooltip.addClass("is-warning")},this.element.find(F+","+D).tooltip(d)))):void c.warn("tooltip option ignored because missing tooltip widget dependency")},_destroy:function(){var a=this.element;this._tableModelViewDestroy(),a.removeClass(B+" "+Ca+" "+Sa).removeAttr("role").removeAttr(Ma).removeAttr(Na).attr(Qa,this.origLabelBy).empty(),f.removeHandler(a[0]),c.info("Grid '"+a[0].id+"' destroyed. Model: "+this.options.modelName),this.tableData$=null,this.tableFrozenData$=null,this._initModel(null),this.gridStyles$&&this.gridStyles$.remove(),this._destroyContextMenu()},_setOption:function(a,b){var d=this.element,e=this.options;if(c.info("Grid '"+d[0].id+"' set option '"+a+"' to: ",b),this._checkContextMenuOptions(a,b),"allowCopy"===a)throw new Error("Grid "+a+" cannot be set");"editable"===a&&!b&&this.editMode?this.setEditMode(!1):"multiple"===a&&this.setSelection(h()),this._super(a,b),this._enforceOptionConstraints(),"disabled"===a?(d.toggleClass(Ca,b),this.lastFocused&&(b?this.lastFocused.tabIndex=-1:this._setFocusable(this.lastFocused)),b&&this.resize()):"selectCells"===a?this._setSelectionMode():"multiple"===a?(b?d.attr(Ma,Za):d.removeAttr(Ma),e.rowHeader!==Wa&&e.rowHeaderCheckbox&&this.refreshColumns(),this.refresh()):"modelName"===a?(this.editMode&&this.setEditMode(!1),this._initModel(b),this.refresh(!1,!0)):"highlights"===a?this._updateHighlights():"tooltip"===a?this._initTooltips(b):"rowHeader"!==a&&"rowHeaderCheckbox"!==a&&"rowHeaderLabelColumn"!==a&&"columnSort"!==a&&"resizeColumns"!==a&&"reorderColumns"!==a&&"editable"!==a&&"pagination"!==a&&"selectAll"!==a&&"footer"!==a&&"autoAddRecord"!==a||("editable"===a&&(b?d.removeAttr(Na):d.attr(Na,Za)),this._refreshGrid())},_enforceOptionConstraints:function(){var a=this.options;a.rowHeaderCheckbox&&a.rowHeader===Wa&&(c.warn("Option rowHeaderCheckbox cannot be true when rowHeader is 'none'."),a.rowHeaderCheckbox=!1),!a.multiple||a.rowHeader!==Wa&&a.rowHeaderCheckbox||!apex.userHasTouched()||(a.rowHeader===Wa&&(a.rowHeader="plain"),a.rowHeaderCheckbox=!0),a.editable&&a.allowEditMode||(a.autoAddRecord=!1),a.rowHeader!==Wa&&(a.rowHeaderWidth?this.rowHeaderWidth=a.rowHeaderWidth:(a.rowHeaderCheckbox?this.rowHeaderWidth=34:this.rowHeaderWidth=16,a.rowHeader!==Xa&&a.rowHeader!==Ya||(this.rowHeaderWidth+=38)))},refresh:function(a){var b,d,e,f,g,i,j,k,l=!1,m=null,n=null,o=null,p=this,r=this.options,s=this.element;if(c.info("Grid '"+s[0].id+"' refreshed. Model: "+r.modelName),a!==!0&&(l=this._paginationHasFocus()),void 0===a&&(a=h(document.activeElement).closest(s[0]).length>0),this._refreshCheckIfVisible()){if(m=s.find(Ga),m.length&&this._deactivateCell(m),this.focusInHeader?this.columnsStale&&this.columns&&(o=q(h(this.lastFocused).closest(Q)),d=h(this.lastFocused).closest("th").attr(qb),d&&(d=this.columns[d].property),this.lastFocused=null):this.lastFocused=null,this.tableData$&&(!r.persistSelection||r.selectCells))if(r.selectCells)e=this.getSelection(),e.length>0&&(m=e[0].first(),f=q(m),this.tableFrozenData$&&0===m.closest(this.tableFrozenData$).length&&(f+=this.tableFrozenData$.find(Q).first().children().length),n={rowIndex:q(m.parent()),colIndex:f});else{for(e=this.getSelection(),n=[],b=0;b<e.length;b++)i=e[b].first().attr(rb),void 0!==i&&n.push(i);0===n.length&&(n=null)}this._refreshPagination(s.find(L)),this.columnsStale||!this.columns?this._initGrid():(this.tableFrozenData$&&this.tableFrozenData$.empty(),this.tableData$.empty(),this._clearChildrenRowCache()),this.controlBreaks=[],this._updateStatus(),this.noData||this.resize(),j=s.find(D),null!==o&&d&&(k=r.columns[0][d],k&&(d=k.seq-1,j.find("thead").each(function(){if(m=h(this).children().eq(o).find("th[data-idx='"+d+"']"),m.length)return!1})),m&&m.length||(m=j.find("thead").first().find(Q).eq(o).children().first()),m&&m.length&&(p._select(m,null,a,!1,!0),a=!1)),this.allSelected=!1,this._addPageOfRecords(function(){var b,c,d,i,k=!1;if(l&&(p._restorePaginationFocus(l),a=!1),s.find(W+" "+ea).attr("aria-disabled",p.noData?Za:$a).toggleClass(Ca,p.noData),p._updateAccLabel(),r.hasSize&&p._calculateColumnWidths(null,!0,!0),p.lastHoverCell=null,p.lastHoverRow=null,p.lastFocused&&h(p.lastFocused).is(Ta)||(p.lastRow$=null,p.lastFocused=p._getCellFocusable(s.children(F).find("tbody tr").first().children().first()),p.lastFocused?(p.selectAnchor=p.lastFocused,p.focusInHeader=!1):(p.lastFocused=p._getCellFocusable(j.find("thead").first().find(Q).last().children().first()),p.focusInHeader=!0),p.lastFocused&&!r.disabled&&(p._setFocusable(p.lastFocused),p._setCurrentRow(p.lastFocused))),n){if(r.selectCells)p.tableData$.find(O).length>n.rowIndex&&(f=n.colIndex,g=p.tableData$,p.tableFrozenData$&&(d=p.tableFrozenData$.find(Q).first().children().length,f>d?f-=d:g=p.tableFrozenData$),c=g.find(O).eq(n.rowIndex).children(),f>=c.length&&(f=c.length-1),p.setSelection([c.eq(f)],a),k=!0);else{for(e=[],b=0;b<n.length;b++)i=p.model.getRecord(n[b]),i&&e.push(i);e.length>0&&(k=0!==p.setSelectedRecords(e,a))}k||(p._trigger(_a,{}),a&&p.focus())}else a&&p.focus()})}},focus:function(){this.lastFocused&&this.lastFocused.focus()},gotoCell:function(a,b){var d,e,f,g,h=this.options,i=!1,j=null,k=null,l=this.element.find("[data-id='"+a+"']");if(this.gotoCellPending=null,this.tableData$){if(b&&(j=h.columns[0][b],j?j.hidden&&j.canHide&&(j.hidden=!1,i=!0,this.refreshColumns(),this.gotoCellPending={record:a,column:b}):c.warn("Warning column not found "+b)),!l.length){if(d=this.model.getRecord(a),!d)return void c.warn("Warning record not found "+a);e=this.model.indexOf(d),this.gotoCellPending={record:a,column:b},h.pagination.scroll?(f=this.scrollParent$,g=Math.floor(e/this.displayPageSize)*this.displayPageHeight,f.scrollTop(g)):(this.pageOffset=Math.floor(e/this.pageSize)*this.pageSize,i=!0)}i&&this.refresh(!1),this.gotoCellPending||(b&&j&&(k=this._cellFromColumn(l,b)),k||(k=l.children().first()),this._select(k,null,!0,!1))}},getActiveCellFromColumnItem:function(a){var b,c=this,d=null;return this.activeRecordId&&(b=this.element.find("[data-id='"+this.activeRecordId+"']"),h.each(this.columnItems,function(e,f){a===f.item.node&&(d=c._cellFromColumn(b,e))})),d},inEditMode:function(){return this.editMode},setEditMode:function(a){function b(){g.columnItemsContainer$.off("change.gridedit"),g.activeRecord=null,g.activeRecordId=null}var d,e,f=!1,g=this;this.tableData$&&(this.options.editable?(a=!!a,this.lastFloatingPos={},d=a!==this.editMode,this.editMode=a,this.element.toggleClass("a-GV--editMode",a),e=u(this.lastFocused),e.length&&(a?this._activateCell(e):(this.lastEditModeCell=null,this._clearDeactivate(),this._deactivateCell(e),this.activeRecord&&(this._deactivateRow(b),f=!0))),d&&(a?this.columnItemsContainer$.on("change.gridedit",function(a){var b,c,d;if(g.activeRecord)for(b=0;b<g.columns.length;b++)if(c=g.columns[b],c.elementId===a.target.id){d=c.property,g.setActiveRecordValue(d);break}}):f||b(),this._trigger(ab,null,{editMode:a}))):a&&c.warn("Grid is not editable."))},getSelection:function(){var a,b,c=[];return this.tableData$&&(this.options.selectCells?(b=this.tableData$.find(ya).parent(Q),this.tableFrozenData$&&(a=this.tableFrozenData$.find(ya).parent(Q)),a&&a.length?a.each(function(a){c.push(h(this).find(ya).filter(R).add(b.eq(a).find(ya).filter(R)))}):b.each(function(){c.push(h(this).find(ya).filter(R))})):(b=this.tableData$.find(ya).filter(Q),this.tableFrozenData$?(a=this.tableFrozenData$.find(ya).filter(Q),a.each(function(a){c.push(h([this,b[a]]))})):b.each(function(){c.push(h(this))}))),c},setSelection:function(a,b,c){var d,e,f=null,g=this.lastFocused,i=this.focusInHeader,j=[];if(this.tableData$){if(this.options.selectCells)h.isArray(a)||(a=[a]),e=a[0].first()[0],j.push(a[a.length-1].last()[0]),e!==j[0]&&(this._select(h(e),null,null,!1,!1),f={type:"click",shiftKey:!0});else if(h.isArray(a))for(d=0;d<a.length;d++)e=a[d].children(R)[0],e&&j.push(e);else a.each(function(){e="TR"===this.nodeName?h(this).children(R)[0]:h(this).closest(R)[0],e&&j.push(e)});this.focusInHeader=!1,this._select(h(j),f,b,!1,c),b||(this.focusInHeader=i,i&&(this._setFocusable(g),this._setCurrentRow(g)))}},selectAll:function(a,b){var c=[],d=this.options,e=this.tableFrozenData$||this.tableData$;e&&d.multiple&&d.selectAll&&!d.selectCells&&(e.children().each(function(){c.push(h(this).children()[0])}),this.setSelection(h(c),a,b))},getRecords:function(a){var b,c,d,e=[];for(b=0;b<a.length;b++)c=a[b].first().attr(rb),void 0!==c&&(d=this.model.getRecord(c),d&&e.push(d));return e},getSelectedRange:function(){var a,b,c,d,e,f,g,h=this.options,i=null;if(h.selectCells)for(i={columns:[],recordIds:[],values:[]},a=this.getSelection(),b=0;b<a.length;b++){if(e=a[b],0===b)for(c=0;c<e.length;c++)g=this._getColumnMetadata(e.eq(c)),i.columns.push(g?g.property:null);for(f=e.first().parent().attr(rb),i.recordIds.push(void 0!==f?f:null),d=[],c=0;c<e.length;c++)d.push(e.eq(c).text());i.values.push(d)}return i},getSelectedRecords:function(){var a=this.options;return a.selectCells?[]:a.persistSelection?this.model.getSelectedRecords():this.getRecords(this.getSelection())},setSelectedRecords:function(a,b,c){var d,e=0,f=[],g={},i=this.tableFrozenData$||this.tableData$;if(!i)return-1;if(this.options.selectCells)return-1;for(d=0;d<a.length;d++)g[this.model.getRecordId(a[d])]=!0;return i.children().each(function(){var a=h(this),b=a.attr(rb);g[b]&&(f.push(a),e+=1)}),this.setSelection(f,b,c),e},activateRow:function(a,b){var c=!1,d=h(this.lastEditModeCell),e=a.parent(),f=e.attr(rb);this.editMode&&f===this.activeRecordId||(this.element.one("apexbeginrecordedit",function(){b()}),c=!0),this.editMode?(d.length&&(d.removeClass(za),this._deactivateCell(d)),a.addClass(za),this._activateCell(a)):(this.lastFocused=a[0],this.setEditMode(!0)),c||b()},activateCell:function(a){var b=h(this.lastEditModeCell);return!!this.editMode&&(a[0]===this.lastEditModeCell||(b.length&&(b.removeClass(za),this._deactivateCell(b)),a.addClass(za),this._activateCell(a)))},copyDownSelection:function(a,b){return this._setSelectionValues(1,a,b)},fillSelection:function(a,b,c){return this._setSelectionValues(0,b,c,a)},_setSelectionValues:function(a,b,c,d){function e(){j=[],k.each(function(c){var e,f,g,i=h(this),k=l._getColumnMetadata(i);k&&b.indexOf(k.property)>=0&&k.elementId&&!k.readonly&&!i.hasClass(Ia)&&(e=l.columnItems[k.property].item,f={index:c,item:e},1===a?(f.value=e.getValue(),g=e.displayValueFor(f.value),f.value!==g&&(f.displayValue=g)):f.value=d,j.push(f))}),o=a,f()}function f(){for(var a,b,d;;){if(o>=i.length||!j.length){d=h(l.lastEditModeCell),d.removeClass(za),m?d.length&&l._deactivateCell(d):l.setEditMode(!1),l.setSelection(i),h(n).focus(),c&&c();break}if(o>0&&(k=p.selectCells?i[o]:i[o].children()),o+=1,a=k.first().parent().attr(rb),l.model.allowEdit(l.model.getRecord(a))){b=k.first(),!p.selectCells&&p.rowHeader!==Wa&&k.length>=2&&(b=k.eq(1)),l.activateRow(b,g);break}}}function g(){var a,b;for(a=0;a<j.length;a++)b=j[a],l.activateCell(k.eq(b.index))&&b.item.setValue(b.value,b.displayValue);f()}var i,j,k,l=this,m=this.editMode,n=this.lastFocused,o=0,p=this.options;return i=this.getSelection(),!(i.length<=a)&&(b||(b=[],p.selectCells?this.getSelectedRange().columns.forEach(function(a){a&&b.push(a)}):this.columns.forEach(function(a){var c=a.property;!c||a.hidden||a.virtual||a.noCopy||l.model.isIdentityField(c)||!a.elementId||a.readonly||b.push(c)})),k=p.selectCells?i[o]:i[o].children(),this.activateRow(k.first(),e),!0)},resize:function(){var a,b,c,d,e=this.element,f=this.options,g=e.height(),i=e.width(),j=e.children(D),k=e.children(F);if(null!==e[0].offsetParent){if(!k.length||this.pendingRefresh)return void this.refresh();d=this.tableData$.prev().height(),e.find(F+" "+P).css("margin-top",-(d+parseInt(this.tableHeader$.find("th").first().css("border-bottom-width"),10))),a=i,this.tableFrozenData$&&(c=this.tableFrozenData$.closest(H).width(),e.find(H).width(c).toggleClass("a-GV-w-frozen--showLabels",c>kb),this.tableData$.parent().parent().find(wa).css("visibility",c>kb?"hidden":"visible"),a-=c),e.find(L+","+J).width(a),h.apex.stickyWidget&&e.find(".js-stickyWidget-toggle").stickyWidget("refresh"),f.hasSize&&(b=g-j.height()-this._footerHeight(),k.children(L).addBack().height(b)),this._calculateColumnWidths(null,!0,f.hasSize||this.tableData$.parent().width()>a),this._initPageSize()}},expandControlBreak:function(a){this._expandCollapseControlBreak(a,!0)},collapseControlBreak:function(a){this._expandCollapseControlBreak(a,!1)},getColumns:function(){return this.columns},refreshColumns:function(){this.columnsStale=!0},setColumnWidth:function(a,b){var c=this._updateColumnWidth(a,b,!0);this._trigger(db,null,{header$:c[1],column:c[0],width:b})},hideColumn:function(a){var b=this._columnName(a);this.options.columns[0][b].hidden=!0,this._refreshGrid()},showColumn:function(a){var b=this._columnName(a);this.options.columns[0][b].hidden=!1,this._refreshGrid()},freezeColumn:function(a){var b,c,d=this.columns,e=this._columnName(a);for(b=0;b<d.length&&(c=d[b],b<d.length-1&&(c.frozen=!0),c.property!==e);b++);this._refreshGrid();
},unfreezeColumn:function(a){var b,c,d=this._columnName(a);for(b=this.columns.length-1;b>=0&&(c=this.columns[b],c.frozen=!1,c.property!==d);b--);this._refreshGrid()},moveColumn:function(a,b){var c=this._moveColumn(a,b);this._refreshGrid(),c.header$=this._columnFromIndex(b),this._trigger(cb,null,c)},moveColumnGroup:function(a,b,c){var d,e,f,g,h,i,j,k=[];if(f=this.columnGroups[a],!f)throw new Error("Invalid column group level: "+a);for(g=-1,d=0;d<f.length;d++)e=f[d],d===b&&(g=e.start,h=e.end),d===c&&(i=g===-1?e.start:e.end);if(c>b)for(d=g;d<=h;d++)j=this._moveColumn(this.columns[g],i),j.newPosition=i-(h-d),j.oldPosition=d,k.push(j),this._updateColumns();else for(d=h;d>=g;d--)j=this._moveColumn(this.columns[h],i),j.newPosition=i+(d-g),j.oldPosition=d,k.push(j),this._updateColumns();for(this._refreshGrid(),d=0;d<k.length;d++)j=k[d],j.header$=this._columnFromIndex(j.newPosition),this._trigger(cb,null,j)},_refreshGrid:function(){var a;a=this.element.find(Ga),a.length&&this._deactivateCell(a),this.refreshColumns(),this.refresh()},_cellFromColumn:function(a,b){var d,e,f,g=this.columns,h=this.options,i=null,j=0;if(e=h.columns[0][b],!e)return c.warn("Warning column not found "+b),null;for(h.rowHeader!==Wa&&(j=1),d=0;d<g.length;d++)if(f=g[d],!f.hidden){if(f.property===b){i=a.children().eq(j);break}j+=1}return d>=g.length&&c.warn("Warning column is hidden "+b),i},_columnFromIndex:function(a){return this.element.find(".a-GV-header[data-idx='"+a+"']")},_columnName:function(a){var b;if(b="object"==typeof a?a.property:a,!this.options.columns[0].hasOwnProperty(b))throw new Error("Unknown column: "+b);return b},_moveColumn:function(a,b){var c,d,e,f,g=this.columns,h=this._columnName(a);for(e=-1,c=0;c<g.length;c++)if(d=g[c],d.property===h){e=c;break}if(f=g[b].seq,e!==b){if(e<b)for(c=b;c>e;c--)g[c].seq=g[c-1].seq;else for(c=b;c<e;c++)g[c].seq=g[c+1].seq;return g[e].frozen=b<=this.lastFrozenColIndex,g[e].seq=f,{column:d,newPosition:b,oldPosition:e}}},_updateColumns:function(){var a,b,c,d,e,f,g,i,j,k,l,m,n,o={},p=this.options,q=p.columns[0];this.columns=[],this.columnsStale=!1,this.columnGroups=[],this.breakColumns=[],this.fieldToColumnIndex={};for(d in q)q.hasOwnProperty(d)&&(c=q[d],c.property=d,c.domId=c.elementId?c.elementId+"_HDR":this.idPrefix+"_h_"+c.property,c.seq=c.seq||"0",this.columns.push(c));for(this.columns.sort(function(a,b){return a.seq-b.seq}),this.lastFrozenColIndex=-1,a=0;a<this.columns.length;a++)if(c=this.columns[a],!c.hidden){if(!c.frozen)break;this.lastFrozenColIndex=a}for(l=p.rowHeader!==Wa?1:0,a=0;a<this.columns.length;a++)c=this.columns[a],c.controlBreakIndex>0&&this.breakColumns.push(c),c.hidden||(this.fieldToColumnIndex[c.property]=l,l+=1);for(this.breakColumns.sort(function(a,b){return a.controlBreakIndex-b.controlBreakIndex}),f=null,i=null,j=null,m=!0,l=0,g=0,b=0,n=[],a=0;a<this.columns.length;a++)if(c=this.columns[a],!c.hidden){if(null===f&&(f=[],this.columnGroups.push(f)),k=z(c),k!==i||a===this.lastFrozenColIndex+1){if(i=k,j&&(j.span=l-g,j.end=b,j.children=n,n=[]),g=l,k){if(j=h.extend({},p.columnGroups[k]),!j)throw new Error("Unknown column group name: "+k);j.heading&&(m=!1,o[k]||(j.domId=this.idPrefix+"_g_"+k)),j.property=k,f.push(j)}else j={},f.push(j);j.start=a,a<=this.lastFrozenColIndex&&(j.frozen=!0,o[k]=1)}n.push(c),l+=1,b=a,null===j&&(j={start:a},this.lastFrozenColIndex>=0&&(j.frozen=!0),f.push(j))}for(j&&(j.span=l-g,j.end=b,j.children=n),m&&(this.columnGroups=[],f=null);f;){for(e=f,f=null,i=null,j=null,m=!0,l=0,n=[],a=0;a<e.length;a++){if(c=e[a],k=c.parentGroupName||null,k!==i||c.frozen!==(!!j&&j.frozen)){if(i=k,null===f&&(f=[],this.columnGroups.unshift(f),l>0&&(j={},c.frozen&&(j.frozen=!0),f.push(j))),j&&(j.span=l-g,j.children=n,n=[]),g=l,k){if(j=h.extend({},p.columnGroups[k]),!j)throw new Error("Unknown column group name: "+k);j.heading&&(m=!1,o[k]||(j.domId=this.idPrefix+"_g_"+k)),j.property=k,f.push(j)}else j={},f.push(j);j.start=c.start,c.frozen&&(j.frozen=!0,o[k]=1)}n.push(c),j.end=c.end,l+=c.span}j&&(j.span=l-g,j.end=c.end,j.children=n),m&&(this.columnGroups.shift(),f=null)}},_initGrid:function(){function b(){y!==A&&(f[0].scrollLeft=y=A,i[0].scrollLeft=y,s.css("left",y)),z!==B&&(z=B,j[0]&&(j[0].scrollTop=z),i[0].scrollTop=z),C=null}function d(a){var b,c;if(v){if(c=a-v,b=w*c,w/=1.6,b>-2&&b<2)return void(w=0);j[0].scrollTop=i[0].scrollTop=z=B=j[0].scrollTop-b}v=a,xb(d)}function e(){var a=E.element.find(Ga);E.floatingItem$.hasClass(Da)?E._collapseFloatingItem(a):E._expandFloatingItem(a)}var f,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=0,z=0,A=0,B=0,C=null,E=this,G="scroll.gvss",I=this.options,K=this.element,M="a-GV-table--checkbox";c.info("Grid render and initialize."),this._updateColumns(),this.columnItems||this._initColumnItems(this.columns),this._renderGrid(),K.find(D+" "+Ua).prop(tb,-1),I.tooltip&&this._initTooltips(I.tooltip),I.rowHeader!==Wa&&I.rowHeaderCheckbox&&(this.tableFrozenHeader$.parent().addClass(M),this.tableFrozenData$.parent().addClass(M)),f=K.find(J),i=K.find(L),j=K.find(H).last(),k=K.children(F),p=k.find("col"),q=k.find("thead").find(".a-GV-header"),x=this.tableData$.width()-a.getScrollbarSize().width,this.tableFrozenData$&&(x-=this.tableFrozenData$.width()),f.add(i).width(x),p.each(function(a){var b=h(this),c=E.columns[b.attr(qb)];c&&(c.width?c.curWidth=c.width:c.curWidth=c.defWidth=q.eq(a).width(),c.curWidth<jb&&(c.curWidth=jb))}),s=this.tableData$.parent().parent().find(wa),i.on(G,function(){A=this.scrollLeft,B=this.scrollTop,C||(C=xb(b))}),f.on(G,function(){A=this.scrollLeft,C||(C=xb(b))}),j.on(G,function(){B=this.scrollTop,C||(C=xb(b))}),I.hasSize&&j.length&&(j.on(yb,function(a){var c=a.originalEvent.deltaY||a.originalEvent.detail||-.025*a.originalEvent.wheelDelta;void 0!==a.originalEvent.deltaMode&&1!==a.originalEvent.deltaMode||(c=30*c),B=this.scrollTop+c,C||(C=xb(b)),a.preventDefault()}),apex.userHasTouched()&&(t=new Hammer(j[0]),t.get("pan").set({direction:Hammer.DIRECTION_VERTICAL}),t.on("panup pandown",function(a){B=u-a.deltaY,C||(C=xb(b)),w=0,a.isFinal&&(a.velocityY>=.1||a.velocityY<=-.1)&&(v=0,w=a.velocityY,xb(d))}),t.on("panstart",function(a){u=j[0].scrollTop}))),m=this.element.find(pa),this.tabTraps$=m,2===m.length?n=0:(3===m.length?(n=1,o=0):(n=4,o=3,m.eq(0).on("focus",function(){E.lastEditModeCell?E.tableData$.find(Ua).first().focus():E._prevCellWithWrap(h(E.lastFocused)).focus()}),m.eq(1).on("focus",function(){E.tableData$.find(Ua).last().focus()}),m.eq(2).on("focus",function(){E.tableFrozenData$.find(Ua).first().focus()})),m.eq(o).on("focus",function(){h(this).hasClass(qa)?E._autoAddRecord(E.activeRecord):(E.tableFrozenData$?E.tableFrozenData$:E.tableData$).find(Ua).last().focus()})),m.eq(n).on("focus",function(){var a,b,c=h(E.lastEditModeCell).closest("tbody"),d=c.find(Ua).add(E.lastEditModeCell),e=d.index(E.lastEditModeCell);e>0?d.first().focus():E.tableFrozenData$&&0===m.eq(0).prop(tb)?(c=c[0]===E.tableFrozenData$[0]?E.tableData$:E.tableFrozenData$,c.find(Ua).first().focus()):(a=h(Ua),b=E.element.find(Ua).first(),e=a.index(b),a.eq(e-1).focus())}),m.eq(n+1).on("focus",function(){var a=h(E.lastEditModeCell).closest("tbody"),b=a.find(Ua).add(E.lastEditModeCell),c=b.index(E.lastEditModeCell);h(this).hasClass(qa)?E._autoAddRecord(E.activeRecord):c<b.length-1?b.last().focus():E.tableFrozenData$&&(a=a[0]===E.tableFrozenData$[0]?E.tableData$:E.tableFrozenData$,a.find(Ua).last().focus())}),m.prop(tb,-1),I.reorderColumns&&this._initColumnReorder(),this.columnWidthHandle$=h(),I.resizeColumns&&this._initColumnResize(),this.columnControls$.on("click","button",function(a){var b=h(a.target);E._sortChange(a,b.closest(W),b.closest("button").hasClass("js-asc")?"asc":"desc")}),this.floatingItem$.draggable({handle:".a-GV-cellMoveHandle",containment:"body",stop:function(a,b){var c=E._getColumnMetadata(E.element.find(Ga)).property;E.lastFloatingPos[c]={left:b.position.left,top:b.position.top}}}).on("keydown",function(a){var b=a.which;return a.ctrlKey&&117===b?(e(),!1):void(112===b&&a.altKey?E._doHelpKey():b===vb.ESCAPE&&E._doEscapeKey(a))}).on("mousedown",function(a){h(a.target).hasClass("a-GV-cellMoveHandle")&&E._clearDeactivate()}).on("focusin",function(a){E._clearDeactivate()}).on("focusout",function(a){E.lastEditModeCell&&E._beginDeactivate(h(E.lastEditModeCell))}).children(va).click(e),g.TouchProxy.addTouchListeners(this.floatingItem$[0]),this._initPaginationFooter(i),!I.hasSize&&I.stickyTop&&h.apex.stickyWidget&&(r={stickToEnd:!0,toggleWidth:!0,bottom:function(){return K.offset().top+K.outerHeight()-E._footerHeight()}},h.isFunction(I.stickyTop)&&(r.top=I.stickyTop),K.find(D).css("overflow","hidden").stickyWidget(r)),this.breakColumns.length>0&&I.collapsibleControlBreaks&&K.find(F).on("click",".js-toggleBreak",function(){l=h(this).closest("."+ka),E._expandCollapseControlBreak([l],!l.hasClass(Da))})},_initColumnReorder:function(){var a,b,c,d,e,f,i,j,k,l,m,n,o,p,r=this.element.hasClass(Sa),s=this.element.find(D),t=this;s.append(this.columnMoveMarker$),p=parseInt(t.columnHandle$.css("margin-left"),10),r&&(p=-p),t.columnHandle$.draggable({appendTo:this.element,containment:s,cursor:"move",cursorAt:r?{right:-2*p}:{left:0},axis:"x",delay:100,distance:4,helper:function(){var a=h("<div class='a-GV-header-dragHelper'></div>"),b=t.columnReorderCell$;return a.append(b.find(".a-GV-headerLabel,."+aa).clone()),a.width(b.outerWidth()),a},start:function(g,p){t.columnControls$.hide(),t._trigger(fb,g,{}),a=t.columnReorderCell$.parent().offset().top-t.element.offset().top,b=a+t.element[0].offsetTop,f=s.css("position"),j="absolute",i=2,k=-s.offset().left,"relative"!==f&&("fixed"===f&&(k=0,a=b=t.columnReorderCell$.parent()[0].offsetTop+s[0].offsetTop,j="fixed",p.helper.css("margin-left",t.element.offset().left+"px")),i=parseInt(s.css("z-index"),10)+1),l=-t.columnMoveMarker$.width()/2,p.helper.css({top:b+"px",position:j,"z-index":i}),n=p.helper.outerWidth(),t.columnMoveMarker$.show().css({top:a+"px",left:t.columnReorderCell$.offset().left+k+(r?t.columnReorderCell$.width():0)+"px",position:j,"z-index":i}),t.columnReorderCell$.find(".a-GV-headerLabel,.a-GV-header-sort").hide(),t.columnHandle$.hide(),t.columnWidthHandle$.hide(),x(function(){t.columnReorderCancel=!0}),m=parseInt(t.columnReorderCell$.attr(qb),10),t.hdrScrollParent=t.element.find(J)[0],o=t.hdrScrollParent.scrollLeft,c=[],e=null,d=t._getRowForCell(t.columnReorderCell$),d.children().each(function(){var a=h(this),b=!0,d=a.offset().left+k;a.parent().parent().parent().parent()[0]===t.hdrScrollParent&&(d+=o,b=!1),c.push({colIdx:parseInt(a.attr(qb),10),start:d,end:d+a.outerWidth(),frozen:b})}),t.columnReordering=!0,t.columnReorderCancel=!1},drag:function(a,b){function d(){var b,d,h,i=!1,j=a.pageX-p+k+t.hdrScrollParent.scrollLeft;for(b=0;b<c.length;b++)if(d=c[b],j>=d.start&&j<d.end){b!==e&&(e=b,h=r?(d.colIdx<m?d.end:d.start)+l:(d.colIdx<m?d.start:d.end)+l,d.frozen||(h-=t.hdrScrollParent.scrollLeft),g=h,f=t.hdrScrollParent.scrollLeft,t.columnMoveMarker$.css("left",h+"px"),i=!0);break}i||f===t.hdrScrollParent.scrollLeft||(h=g-(t.hdrScrollParent.scrollLeft-f),t.columnMoveMarker$.css("left",h+"px"))}var f=t.hdrScrollParent.scrollLeft,g=parseInt(t.columnMoveMarker$.css("left"),10);return t.columnReorderCancel?void a.preventDefault():(d(),void(t._headerScrollCheck(a.pageX-p,n)?t.scrollTimerId||t._headerScrollStart(a.pageX-p,n,d):t.scrollTimerId&&t._headerScrollStop()))},stop:function(a,b){var f=null;null!==e&&(f=c[e].colIdx),isNaN(f)&&e+1<c.length&&(f=c[e+1].colIdx),isNaN(f)||(t.columnReordering=!1,t.columnReorderCell$.find(".a-GV-headerLabel,.a-GV-header-sort").show(),f===m&&(t.columnHandle$.show(),t.columnWidthHandle$.show(),t.columnControls$.show()),t.columnMoveMarker$.hide(),t.lastHoverCell=null,y(),t.scrollTimerId&&t._headerScrollStop(),t.columnReorderCancel||null===f||f===m||(t.columnReorderCell$.hasClass(X)?t.moveColumnGroup(q(d),m,f):t.moveColumn(t.columns[m],f),t.focus()))}}),g.TouchProxy.addTouchListeners(t.columnHandle$[0])},_initColumnResize:function(){var a,b,c,d=this,e=this.element.hasClass(Sa)?-1:1,f=this.element.find(D),i=f.find(Q).last();this.columnWidthHandle$=h("<div class='a-GV-columnWidthHandle'></div>").appendTo(f).css("top",i[0].offsetTop).height(i.height()),this.columnWidthHandle$.draggable({axis:"x",containment:f,start:function(e,f){d.columnWidthDragging=!0,d.columnWidthCancel=!1,d.columnWidthStartPos=f.position.left,d.columnWidthStartWidth=d.columnWidthCell$.first().outerWidth(),a=f.helper.outerWidth(),d.hdrScrollParent=d.element.find(J)[0],c=d.columnWidthCell$.parent().parent().parent().parent()[0]!==d.hdrScrollParent,b=d.hdrScrollParent.scrollLeft,x(function(){d.columnWidthCancel=!0})},drag:function(f,g){function h(a){var f,h,i=d.columnWidthStartWidth+e*(g.position.left-d.columnWidthStartPos);f=d.hdrScrollParent.scrollWidth,c||(i+=d.hdrScrollParent.scrollLeft-b),i>jb&&(d.columnWidthCell$.hasClass(fa)?(d.rowHeaderWidth=i,d._calculateColumnWidths()):d._updateColumnWidth(d._getColumnMetadata(d.columnWidthCell$.first()),i)),h=d.hdrScrollParent.scrollWidth-f,h<0&&!a&&d.hdrScrollParent.scrollLeft!==b&&(d.hdrScrollParent.scrollLeft+=h,b+=h)}return d.columnWidthCancel?void f.preventDefault():(h(),void(d._headerScrollCheck(g.offset.left,a)?d.scrollTimerId||d._headerScrollStart(g.offset.left,a,function(){h(!0)}):d.scrollTimerId&&d._headerScrollStop()))},stop:function(a,f){var g=d.columnWidthStartWidth+e*(f.position.left-d.columnWidthStartPos);c||(g+=d.hdrScrollParent.scrollLeft-b),d.columnWidthDragging=!1,y(),d.scrollTimerId&&d._headerScrollStop(),d.columnWidthCancel&&(g=d.columnWidthStartWidth),g<jb&&(g=jb),d.columnWidthCell$.hasClass(fa)?(d.rowHeaderWidth=g,d._calculateColumnWidths(null,!0)):d.setColumnWidth(d._getColumnMetadata(d.columnWidthCell$.first()),g)}}),g.TouchProxy.addTouchListeners(this.columnWidthHandle$[0])},_updateColumnWidth:function(a,b,c){var d,e,f,g=this._columnName(a);return d=this.options.columns[0][g],d.width=b,d.curWidth=b,f=this.columns.indexOf(d),e=this._columnFromIndex(f),this._calculateColumnWidths(e,c),[d,e]},_calculateColumnWidths:function(b,c,d){function e(a){var b,c;for(b=a+1;b<v.columns.length;b++)if(c=v.columns[b],!c.hidden&&!c.noStretch&&b!==q)return!1;return!0}function f(a,b){var c,d=b.parent().find("col"),e=a.parent().find("col");return c=0,e.each(function(a){var b,e,f=h(this),g=f.attr(qb);g?(e=v.columns[g],b=e.curWidth):b=v.rowHeaderWidth,f[0].width=b,d[a].width=b,c+=b}),b.parent().width(c),a.parent().width(c),c}var g,i,j,k,l,m,n,o,p,q,r,s,t=this.options.hasSize,u=this.element,v=this;if(d)for(g=0;g<this.columns.length;g++)i=this.columns[g],i.curWidth=i.width||i.defWidth,i.curWidth<jb&&(i.curWidth=jb);if(c&&this.tableFrozenHeader$&&this.tableData$.prev().add(this.tableFrozenData$.prev()).add(this.tableHeader$).add(this.tableFrozenHeader$).each(function(){h(this).find(W).first().css("height","")}),b&&(m=b.parent().parent()[0],q=parseInt(b.attr(qb),10)),!this.tableFrozenData$||m&&m!==this.tableFrozenHeader$[0]||(f(this.tableFrozenData$,this.tableFrozenHeader$),k=this.tableFrozenData$.parent().outerWidth(),u.find(H).width(k),j=u.width()-k,u.find(L+","+J).width(j)),j=m&&m!==this.tableHeader$[0]?this.tableData$.parent().width():f(this.tableData$,this.tableHeader$),c){if(l=u.find(L)[0].clientWidth,t&&0===this.tableData$.children().length&&(l-=a.getScrollbarSize().width),j<l){if(l=l-j-1,l>10)for(p=l,g=0;g<this.columns.length;g++)i=this.columns[g],i.hidden||i.frozen||i.noStretch||g===q||(e(g)?i.curWidth+=p:(o=Math.floor(l*(i.curWidth/j)),i.curWidth+=o,p-=o));else for(g=this.columns.length-1;g>0;g--)if(i=this.columns[g],!(i.hidden||i.frozen||i.noStretch||g===q)){i.curWidth=i.curWidth+l;break}f(this.tableData$,this.tableHeader$)}this.tableFrozenHeader$&&(s=this.tableFrozenHeader$.find(W).outerHeight(),r=this.tableHeader$.find(W).outerHeight(),s!==r&&(r=Math.max(s,r),this.tableData$.prev().add(this.tableFrozenData$.prev()).add(this.tableHeader$).add(this.tableFrozenHeader$).each(function(){h(this).find(W).first().css("height",r+"px")})))}t&&(n=u.children(F),this._adjustSizeForScrollBars(n.height(),n.find(L).width()))},_renderGrid:function(){function b(a,b){var c,d;for(b&&l.rowHeader!==Wa&&a.markup("<col").optionalAttr("width",j.rowHeaderWidth).markup("/>"),c=0;c<j.columns.length;c++)d=j.columns[c],(d.frozen||!1)!==b||d.hidden||a.markup("<col").optionalAttr("width",d.width).attr(qb,c).markup("/>")}function c(a,b,c){var d,e,f,h,k,o,p,q,r,s=j.columns,t=j.lastFrozenColIndex+1,u=s.length;for(e=0;e<j.columnGroups.length;e++){for(o=j.columnGroups[e],a.markup("<tr class='"+N+"' role='row'>"),d=0;d<o.length;d++)for(b&&l.rowHeader!==Wa&&(a.markup("<th role='columnheader' class='"+X+" "+fa+"'"),c&&a.markup(" style='visibility: hidden;'"),a.markup(">")),d=0;d<o.length;d++)f=o[d],(f.frozen||!1)===b&&(h=X,h+=i(f.headingAlignment||"center",!0),r=c?null:f.domId,a.markup("<th role='columnheader' ").attr("class",h).attr(pb,f.span).attr(qb,d),c&&a.markup(" style='visibility: hidden;'"),a.markup(" tabindex='-1'><span class='"+Z+"'").optionalAttr("id",r).markup(">"+(f.heading||"")).markup("</span></th>"));a.markup("</tr>")}for(a.markup("<tr class='"+N+"' role='row'>"),b&&(l.rowHeader!==Wa&&(q=null,c&&(q="visibility: hidden;"),a.markup("<th role='columnheader' class='"+V+" "+fa+"'").optionalAttr("style",q).markup("><span class='u-vh "+Z+"'").optionalAttr("id",c?null:j.idPrefix+"_shh").markup(">").markup(m("ROW_HEADER")).markup("</span>"),l.rowHeaderCheckbox&&l.multiple&&l.selectAll&&a.markup("<span class='"+ca+"' role='checkbox' aria-checked='false'").attr("title",m("SELECT_ALL")).markup("></span>"),l.rowHeader===Xa?a.markup("<span class='a-GV-rownum' aria-hidden='true'></span>"):l.rowHeader===Ya&&a.markup("<span class='a-GV-rowLabel'></span>"),a.markup("</th>")),t=0,u=j.lastFrozenColIndex+1),d=t;d<u;d++)f=s[d],f.hidden||(h=V,h+=i(f.headingAlignment||"center",!0),f.isRequired&&(h+=" is-required"),f.elementId&&!f.readonly||(h+=" "+Ia),f.headingCssClasses&&(h+=" "+f.headingCssClasses),p=null,1===f.sortIndex&&("asc"===f.sortDirection?p="ascending":"desc"===f.sortDirection&&(p="descending")),q=null,c?(q="visibility: hidden;",r=null):r=f.domId,a.markup("<th role='columnheader' ").attr("class",h).attr(qb,d).optionalAttr("style",q).optionalAttr("aria-sort",p).optionalAttr("aria-haspopup",l.activateColumnHeader?Za:null).markup(" tabindex='-1'><span class='"+Z+"'").optionalAttr("id",r).markup(">").markup(f.heading).markup("</span>"),f.sortDirection&&(k=n("asc"===f.sortDirection?"SORTED_ASCENDING":"SORTED_DESCENDING",g>1?f.sortIndex:""),a.markup("<span class='a-GV-header-sort'><span aria-hidden='true'").attr("class","a-Icon "+("asc"===f.sortDirection?"icon-irr-sort-asc":"icon-irr-sort-desc")).attr(ob,k).markup("></span><span class='u-vh'>").content(" "+k).markup("</span>"),g>1&&a.markup("<span aria-hidden='true'>").content(f.sortIndex).markup("</span>"),a.markup("</span>")),a.markup("</th>"));a.markup("</tr>")}var d,e,f,g,j=this,k=this.element,l=this.options,o=a.htmlBuilder(),p="<table role='presentation' class='"+M+"'>",q="<thead role='rowgroup'>",r="<span class='"+oa+" u-vh is-focusable' aria-hidden='true' tabindex='-1'></span>";for(f=this.lastFrozenColIndex>=0||l.rowHeader!==Wa,g=0,d=0;d<this.columns.length;d++)this.columns[d].sortDirection&&(g+=1);o.markup("<div class='"+C+"'>"),f&&(o.markup("<div class='"+G+"'>"+p),b(o,!0),o.markup(q),c(o,!0,!1),o.markup("</thead></table></div>")),o.markup("<div class='"+I+"'>"+p),b(o,!1),o.markup(q),c(o,!1,!1),o.markup("</thead></table></div></div><div class='"+E+"'>"),this._renderAltDataMessages(o,this.idPrefix),o.markup("<div class='u-vh'").attr("id",this.accContextId).markup("></div>"),f&&(o.markup(r+"<div class='"+G+"'>"+p),b(o,!0),o.markup(q),c(o,!0,!0),o.markup("</thead><tbody></tbody></table>"),this._renderLoadMore(o),o.markup("</div>"+r+r)),o.markup("<div class='"+K+"' tabindex='-1'>"+p),b(o,!1),o.markup(q),c(o,!1,!0),o.markup("</thead><tbody></tbody></table>"),this._renderLoadMore(o),o.markup("</div>"),(f||l.autoAddRecord&&this.model.allowAdd())&&o.markup(r),o.markup("</div>"),l.editable&&o.markup("<div class='a-GV-floatingItem' tabindex='-1' style='display: none;'>").markup("<div class='a-GV-cellMoveHandle'></div>").markup("<button type='button' class='"+ua+"' tabindex='-1'><span aria-hidden='true' class='a-Icon'></span></button>"+r+"<div class='"+sa+"'></div>"+r+"</div>"),this._renderFooter(o,this.idPrefix),l.columnSort&&(o.markup("<div class='"+$+"' style='display:none'>"),this._renderButton(o,"a-Button js-asc","icon-up-chevron",m("SORT_ASCENDING")),this._renderButton(o,"a-Button js-desc","icon-down-chevron",m("SORT_DESCENDING")),o.markup("</div>")),l.reorderColumns&&o.markup("<div class='"+aa+"' style='display:none'></div>").markup("<div class='a-GV-colMoveMarker' style='display:none'>").markup("<span class='a-GV-colMoveMarker-x'></span></div>"),this.floatingItem$&&this.floatingItem$.remove(),k.html(o.toString()),this._updateAccLabel(),this.pageKey=null,e=k.find(".a-GV-table>tbody,.a-GV-table>thead"),f?(this.tableFrozenHeader$=e.eq(0),this.frozenColumnCount=this.tableFrozenHeader$.children().last().children().length,this.tableHeader$=e.eq(1),this.tableFrozenData$=e.eq(3),this.tableData$=e.eq(5)):(this.tableFrozenHeader$=null,this.frozenColumnCount=0,this.tableFrozenData$=null,this.tableHeader$=e.eq(0),this.tableData$=e.eq(2)),this._clearChildrenRowCache(),this.accContext$=h("#"+this.accContextId),this.columnControls$=k.find(_),this.columnControls$.find("button").attr(ub,-1),this.columnHandle$=k.find("."+aa),this.columnMoveMarker$=k.find(".a-GV-colMoveMarker"),this.floatingItem$=k.find(ra)},_updateAccLabel:function(){var a=this.origLabelBy;this.noData?a+=" "+this.idPrefix+"_msg":this.options.footer&&(a+=" "+this.idPrefix+"_pageRange "+this.idPrefix+"_status"),this.element.attr(Qa,a)},_calcSpanAllColumns:function(a){var b,c,d,e;for(c=0,a?(d=0,e=this.lastFrozenColIndex+1,this.options.rowHeader!==Wa&&(c+=1)):(d=this.lastFrozenColIndex+1,e=this.columns.length),b=d;b<e;b++)this.columns[b].hidden||(c+=1);return c},_getHeaderHeight:function(){return this.element.find(D).outerHeight()},_getStickyTop:function(){return h.isFunction(this.options.stickyTop)?this.options.stickyTop():0},_selectedCount:function(){var a=0,b=this.options;if(this.tableData$)return b.selectCells?(a=this.tableData$.find(ya).filter(R).length,this.tableFrozenData$&&(a+=this.tableFrozenData$.find(ya).filter(R).length)):a=b.persistSelection?this.model.getSelectedCount():this.tableData$.find("tr.is-selected").length,a},_selectedStatusMessage:function(){var a=this.options;return d.getMessage(a.selectCells?"APEX.GV.SELECTION_CELL_COUNT":a.selectionStatusMessageKey)},_deletedCount:function(){return this.tableData$.find(Ja).length},_hasControlBreaks:function(){return this.breakColumns.length>0},_getRecordHeight:function(){var a,b;return a=this.tableData$.find(Q).filter(Ta).first(),a.length?b=a.outerHeight():(a=h("<tr class='"+N+"'><td class='"+S+"'></td></tr>"),a=this.tableData$.append(a),b=a.outerHeight(),this.tableData$.empty()),b},_getDataRenderContext:function(){return{hasFrozenColumns:this.lastFrozenColIndex>=0||this.options.rowHeader!==Wa,dataOut:a.htmlBuilder(),frozenOut:a.htmlBuilder()}},_getDataContainer:function(){return this.tableFrozenData$?h([this.tableFrozenData$[0],this.tableData$[0]]):this.tableData$},_insertFiller:function(a,b){var c,d;return a.hasFrozenColumns&&(d=h(a.frozenOut.toString()),b?b.first().before(d):this.tableFrozenData$.html(d)),c=h(a.dataOut.toString()),b?b.last().before(c):this.tableData$.html(c),a.hasFrozenColumns&&(c=h([d[0],c[0]])),this._clearChildrenRowCache(),c},_insertData:function(a,b,c,d,e){var f,g,i,j,k,l=this;a.hasFrozenColumns&&(i=r(a.frozenOut)),g=r(a.dataOut),d?(a.hasFrozenColumns&&d.first()[e](i),d.last()[e](g)):(a.hasFrozenColumns&&this.tableFrozenData$.append(i),this.tableData$.append(g)),this._clearChildrenRowCache(),this.allSelected&&this.options.pagination.scroll&&(j=g.map(function(a,b){return h(b).children()[0]}),k=this.focusInHeader,this.focusInHeader=!1,this._select(j,"add",null,!1),this.focusInHeader=k),this.options.hasSize&&(f=this.element.children(F),this._adjustSizeForScrollBars(f.height(),f.find(L).width())),this.gotoCellPending&&setTimeout(function(){l.gotoCell(l.gotoCellPending.record,l.gotoCellPending.column)},1),this._trigger(gb,null,{offset:b,count:c})},_controlBreakLabel:function(b){var c,d,e,f,g=this.options,h="";for(c=0;c<this.breakColumns.length;c++)d=this.breakColumns[c],c>0&&(h+=", "),e=this.model.getValue(b,d.property),null===e&&(e=""),"object"==typeof e&&e.hasOwnProperty("d")?e=e.d:(f=this.columnItems[d.property],f&&(e=f.item.displayValueFor(e))),""===e&&g.showNullAs&&(e=g.showNullAs),d.escape!==!1&&(e=a.escapeHTML(e)),(d.label||d.heading)&&(h+="<span class='a-GV-breakLabel'>"+(d.label?a.escapeHTML(d.label):d.heading)+":</span> "),h+="<span class='a-GV-breakValue'> "+e+"</span>";return h},_renderBreakRecord:function(a,b,c,d){a.hasFrozenColumns&&(this._renderBreakRow(a.frozenOut,!0,b,c,d),b=!1),this._renderBreakRow(a.dataOut,!1,b,c,d)},_renderFillerRecord:function(a,b){a.hasFrozenColumns&&a.frozenOut.markup("<tr class='"+b+"'><td ").attr(pb,this._calcSpanAllColumns(!0)).markup("></td></tr>"),a.dataOut.markup("<tr class='"+b+"'><td ").attr(pb,this._calcSpanAllColumns(!1)).markup("></td></tr>")},_renderRecord:function(a,b,c,d,e){a.hasFrozenColumns&&this._renderRow(a.frozenOut,b,c,d,e,!0),this._renderRow(a.dataOut,b,c,d,e,!1)},_insertRecord:function(b,c,d,e,f){var g,i,j=this.lastFrozenColIndex>=0||this.options.rowHeader!==Wa,k=a.htmlBuilder(),l=[];return j&&(this._renderRow(k,c,null,d,e,!0),g=r(k),l.push(g[0]),"after"===f&&b?(i=b.first(),i.after(g)):this.tableFrozenData$.prepend(g),k.clear()),this._renderRow(k,c,null,d,e,!1),g=r(k),l.push(g[0]),"after"===f&&b?(i=b.last(),i.after(g)):this.tableData$.prepend(g),this._clearChildrenRowCache(),h(l)},_afterInsert:function(a){var b,c,d=this,e=!!this.element.find("."+za).length||h(document.activeElement).hasClass(qa),f=a[0].find(".a-GV-cell").first();for(b=0;b<this.columns.length;b++)if(c=this.columns[b],!c.hidden&&!c.readonly&&this.columnItems[c.property]){f=v(a[0],this.fieldToColumnIndex[c.property]);break}setTimeout(function(){d._select(f,null,e,!1,!1),e&&d.options.editable&&!d.editMode&&d.setEditMode(!0)},1)},_updateRecordField:function(b,c,d,e){var f,g,h,i,j=this.fieldToColumnIndex[d],k=a.htmlBuilder();void 0!==j&&(f=v(b,j),this.editMode&&c===this.activeRecord&&!this.ignoreItemChange&&(g=this.columnItems[d],g&&this._setColumnItemValue(g.item,c,d)),f.hasClass(Ea)||(h=this.options.columns[0][d],i=null,e.fields&&(i=e.fields[h.property]),k=a.htmlBuilder(),this._renderFieldDataValue(k,h,c,e,i),f.html(k.toString())))},_updateRecordState:function(a,b,c,d){var e,f,g,h,i,j=this.options,m=!this.tooltipOptions;if(h=k(d,j,a.hasClass(xa),this.model,c),a.attr("class",h),m&&(d.message?a.first().find(ga).attr(ob,d.message):a.first().find(ga).removeAttr(ob)),d.fields)for(e in d.fields)if(d.fields.hasOwnProperty(e)){if(f=d.fields[e],i=this.fieldToColumnIndex[e],void 0===i)continue;g=v(a,i),h=l(j.columns[0][e],d,f,j,g,this.model,c),g.attr("class",h),m&&(f.message&&!d.deleted?g.attr(ob,f.message):g.removeAttr(ob))}},_removeRecord:function(a){a.remove()},_identityChanged:function(a,b){var c=this._elementsFromRecordIds([a])[0];c.attr(rb,b),this.activeRecordId===a&&(this.activeRecordId=b)},_replaceRecord:function(b,c,d,e,f){var g,i,j,k,l,m,n,o,p=null,u=null,w=[],x=b.first().children().first().find(".a-GV-rownum").text()||null,y=this.lastFrozenColIndex>=0||this.options.rowHeader!==Wa,z=a.htmlBuilder();x&&(x=parseInt(x,10)-1),this.activeRecordId===d&&(this.activeRecord=this.activeRecordId=null),i=b.hasClass(xa),j=b.find(this.lastFocused).length,j&&(o=this.lastFocused,l=s(o).hasClass(za)),k=b.find(this.lastEditModeCell).length&&h(this.lastEditModeCell).hasClass(za),k&&(o=this.lastEditModeCell),o&&(p=0,u=q(t(o))),y&&(o&&b.last().find(o).length&&(p=1),this._renderRow(z,c,x,e,f,!0),g=r(z),w.push(g[0]),b.first().replaceWith(g),z.clear()),this._renderRow(z,c,x,e,f,!1),g=r(z),w.push(g[0]),b.last().replaceWith(g),this._clearChildrenRowCache(),g=h(w),i&&g.add(g.find(".a-GV-selHeader .u-selector")).addClass(xa).attr(La,!0),k?this._activateCell(v(g.eq(p),u)):j&&(n=v(g.eq(p),u),m=this._getCellFocusable(n),this._setFocusable(m),this._setCurrentRow(n[0]),l&&this._setFocus(m))},_removeFocus:function(a){var b,c,d;b=h(this.lastFocused).closest(Q),(b[0]===a[0]||a.length>1&&b[0]===a[1])&&(c=u(this.lastFocused),d=this._getNextCellDown(c,1),d||(d=this._getPrevCellUp(c,1)),d&&this._select(d,null,!0,!1))},_elementsFromRecordIds:function(a){var b,c,d=!0,e=[],f={};for(b=0;b<a.length;b++)f[a[b]]=b,e[b]=null;return this.tableFrozenData$||(d=!1),d&&(c=this.tableFrozenData$.children()),this.tableData$.children().each(function(a){var b=h(this),g=b.attr(rb);void 0!==f[g]&&(d?e[f[g]]=h([c[a],this]):e[f[g]]=b)}),e},_renderBreakRow:function(a,b,c,d,e){var f;f=this._calcSpanAllColumns(b),a.markup("<tr role='row' class='"+ka+" is-expanded'><th role='rowheader' class='a-GV-controlBreakHeader'").attr(pb,f).markup(">"),c&&this.options.collapsibleControlBreaks&&this._renderButton(a,"a-Button js-toggleBreak","icon-down-arrow",m("BREAK_COLLAPSE")),a.markup("<span class='a-GV-controlBreakLabel'>").markup(d).markup("</span></th></tr>"),b||(this.controlBreaks.push({offset:e+1,label:d}),this.controlBreaks.sort(p))},_getControlBreak:function(a){var b,c=null;return this.breakColumns.length>0&&(b=o(this.controlBreaks,{offset:a},p),c=this.controlBreaks[b],c&&c.offset===a||(c=this.controlBreaks[b-1])),c},_renderRow:function(a,b,c,d,e,f){var g,h,i,j,n,o,p,q=null,r=null,s=null,t=this.options,u=this.columns,v=this.lastFrozenColIndex+1,w=u.length,x=!this.tooltipOptions;for(i=k(e,t,null,this.model,b),e.agg?q=e.grandTotal?t.aggregateLabels[e.agg].overallLabel:t.aggregateLabels[e.agg].label:!e.deleted&&e.message&&x&&(r=e.message),o=void 0!==e.serverOffset?e.serverOffset+1:"",a.markup("<tr role='row'").attr(rb,d).optionalAttr(sb,o).attr("class",i).optionalAttr(ob,q).optionalAttr(La,e.sel?Za:null).optionalAttr("style",this.controlBreakCollapsed?"display:none;":null).markup(">"),f&&t.rowHeader!==Wa&&(p=e.agg||t.rowHeader===Ya,a.markup("<th role='rowheader'").attr("class",S+" "+fa+(p?" "+ba:"")).optionalAttr(ob,r).markup(">"),e.agg||(t.rowHeaderCheckbox&&(j=t.multiple?ca:da,e.sel&&(j+=" "+xa),a.markup("<span class='"+j+"'").attr("title",m("SELECT_ROW")).markup("></span>")),t.rowHeader===Xa&&a.markup("<span class='a-GV-rownum' aria-hidden='true'>").content(o).markup("</span>")),p&&(a.markup("<span class='a-GV-rowLabel'>"),e.agg?a.content(t.aggregateLabels[e.agg][e.grandTotal?"overallLabel":"label"]):t.rowHeaderLabelColumn&&a.markup(this.model.getValue(b,t.rowHeaderLabelColumn)),a.markup("</span>")),a.markup("</th>")),f&&(v=0,w=this.lastFrozenColIndex+1),g=v;g<w;g++)h=u[g],n=null,e.fields&&(n=e.fields[h.property]),h.hidden||(i=l(h,e,n,t,null,this.model,b),s=null,x&&(n&&n.message?s=n.message:e.agg&&(s=t.aggregateTooltips[e.agg+"|"+h.property])),a.markup("<td role='gridcell' tabindex='-1'").attr("class",i).optionalAttr(ob,s).markup(">"),this._renderFieldDataValue(a,h,b,e,n),a.markup("</td>"));a.markup("</tr>")},_getColumnMetadata:function(a){var b,c,d;if(a.hasClass(S))b=q(a),c=a.closest(H).length?this.tableFrozenHeader$:this.tableHeader$,d=c.children().last().children().eq(b);else{if(!a.hasClass(V))return null;d=a}return b=parseInt(d.attr(qb),10),isNaN(b)?null:this.columns[b]},_activateColumnHeader:function(a,b){var c=this._getColumnMetadata(b);c.noHeaderActivate||this._trigger(eb,a,{header$:b,column:c})},_activateRow:function(a){var b,c,d,e,f,g,h,i=a.parent(),j=i.attr(rb),k=this;for(e=this.model.getRecord(j),f=this.model.getRecordId(e),h=this.model.allowEdit(e),g=this.model.getRecordMetadata(f),i.addClass(Ea),this._beginSetColumnItems(),b=0;b<this.columns.length;b++)d=this.columns[b].property,c=this.columnItems[d],c&&this._setColumnItemValue(c.item,e,d,h?g:null);this.activeRecord=e,this.activeRecordId=f,this._endSetColumnItems(),setTimeout(function(){k._triggerBeginEditing(k.activeRecord,k.activeRecordId);
},1)},_deactivateRow:function(a){var b,c,d,e,f,g,h,i=this.element.find(".a-GV-row.is-active");if(this.activeLockCount>0)return void(this.activeUnlockCallback=a);if(i.removeClass(Ea),f=this.model.getRecordMetadata(this.activeRecordId),f&&!f.deleted&&this.model.allowEdit(this.activeRecord))for(b=0;b<this.columns.length;b++)d=this.columns[b].property,c=this.columnItems[d],c&&(h=c.item.isDisabled(),h?this.model.setValidity("valid",this.activeRecordId,d):(e=c.item.getValidity(),e.valid||this.model.setValidity("error",this.activeRecordId,d,c.item.getValidationMessage())),g=f.fields?f.fields[d]:null,(g&&g.hasOwnProperty("disabled")||h)&&(g||(f.fields||(f.fields={}),g={},f.fields[d]=g),g.disabled=h));this._triggerEndEditing(this.activeRecord,this.activeRecordId),this.activeRecord=null,this.activeRecordId=null,a()},_beginDeactivate:function(a,b){var c=this;this.deactivateDelayTimer||(this.deactivateDelayTimer=setTimeout(function(){c.lastEditModeCell=null,c._deactivateCell(a),b&&(c.dontFocusEditableItem=!0,a.focus()),c.deactivateDelayTimer=null},10))},_clearDeactivate:function(){this.deactivateDelayTimer&&(clearTimeout(this.deactivateDelayTimer),this.deactivateDelayTimer=null)},_setTabTraps:function(a){var b,c,d,e,f,g=this.options.autoAddRecord&&this.model.allowAdd(),h=this.tabTraps$;a.attr(ub,-1),b=this._nextCellWithWrap(a).attr(ub,0),c=this._prevCellWithWrap(a).attr(ub,0),e=null,this.tableFrozenData$?(e=3,d=5,h.eq(0).prop(tb,c.length?0:-1),f=1===a.parent().children().length,h.eq(1).prop(tb,f?0:-1),h.eq(2).prop(tb,f?0:-1)):g?(e=0,d=2):d=1,null!==e&&(g&&this.onLastPage&&0===b.length?h.eq(e).prop(tb,0).addClass(qa):h.eq(e).prop(tb,b.length?0:-1).removeClass(qa)),g&&this.onLastPage&&0===b.length?h.eq(d).prop(tb,0).toggleClass("js-last",!b.length).addClass(qa):h.eq(d).prop(tb,b.length?0:-1).toggleClass("js-last",!b.length).removeClass(qa)},_clearTabTraps:function(){this.element.find(".a-GV-cell[tabindex='0'],.a-GV-controlBreakHeader[tabindex='0']").attr(ub,-1),this.tabTraps$.prop(tb,-1)},_activateCell:function(a,b){function c(a){b=b||g._getCellFocusable(a),b!==a[0]&&b.focus()}function d(){e=g._getColumnMetadata(a),e&&(j=g.columnItems[e.property]),j&&g.model.allowEdit(g.activeRecord)&&!e.readonly&&!a.hasClass(Ia)?(a.addClass(Ea),f=j.item.getPopupSelector(),f&&h(document.body).on("focusin.gridpopup",function(a){h(a.target).closest(f).length&&g._clearDeactivate()}).on("focusout.gridpopup",function(a){var b;h(a.target).closest(f).length&&(b=h(g.lastEditModeCell),g._beginDeactivate(b,!0))}),j.element$.height()>a.height()?(a.empty(),g.floatingItem$.children(ta).append(j.element$),g._expandFloatingItem(a)):a.empty().append(j.element$),g._activateColumnItem(j,e.domId),g.dontFocusEditableItem||j.item.setFocus(),g.dontFocusEditableItem=!1,i=!0):c(a)}var e,f,g=this,i=!1,j=null,k=a.hasClass(la);if(this.lastEditModeCell=a[0],a.parent().hasClass(xa)?this.lastRow$&&this.lastRow$.index(a)>=0||this._setCurrentRow(a[0]):this._select(a,null,!1,!1),this._setFocusable(a[0]),this._setTabTraps(a),!this.activeRecord||this.activeRecordId!==a.parent().attr(rb)){if(this.activeRecord)return void this._deactivateRow(function(){k?c(a):(g._activateRow(a),d())});k?c(a):this._activateRow(a)}return k?c(a):d(),i},_expandFloatingItem:function(a){var b,c,d,e=this.element.hasClass(Sa)?"right top":"left top",f=a.outerWidth(),g=this._getColumnMetadata(a).property;this.floatingItem$.css("position","").css("min-width",f+"px").appendTo(nb).show().addClass(Da).draggable("enable").attr("data-owning-region",this.element[0].id).find(va+" span").removeClass("icon-ig-expand").addClass("icon-ig-restore"),this.floatingItem$.children(ta).show().css({width:"",height:""}),d=this.lastFloatingPos[g],d?this.floatingItem$.css({left:d.left,top:d.top}):this.floatingItem$.position({my:e,at:e,of:a,collision:"fit fit"}),this.floatingItem$.find(pa).not(".js-last").attr(ub,0),b=this._getColumnMetadata(a),b&&(c=this.columnItems[b.property],c.item.setFocus())},_collapseFloatingItem:function(a){var b=a.innerWidth(),c=a.innerHeight();this.floatingItem$.css({position:"relative",left:"",top:""}).appendTo(a).draggable("disable").removeClass(Da+" ui-state-disabled").removeAttr("data-owning-region").find(va+" span").removeClass("icon-ig-restore").addClass("icon-ig-expand"),this.floatingItem$.children(ta).hide().width(b).height(c),this.floatingItem$.find(va).focus(),this.floatingItem$.find(pa).not(".js-last").attr(ub,-1)},_deactivateCell:function(b){var c,d,e,f,g=null;b.length<=0||(this._clearTabTraps(),this._setFocusable(b[0]),c=this._getColumnMetadata(b),c&&(g=this.columnItems[c.property]),g&&b.hasClass(Ea)&&(h(document.body).off(".gridpopup"),this._setModelValue(b,g.item,this.activeRecord,c.property),e=this.model.getRecordMetadata(this.activeRecordId),f=null,e.fields&&(f=e.fields[c.property]),this.debugDontDeactivateCell?b.addClass(za+" "+Ea):(this.floatingItem$.appendTo(nb),this.floatingItem$.hide(),this._deactivateColumnItem(g),d=a.htmlBuilder(),this._renderFieldDataValue(d,c,this.activeRecord,e,f),b.html(d.toString())),this._updateRecordState(this.lastRow$.parent(),this.activeRecordId,this.activeRecord,e)))},_finishEditing:function(a){var b,c=h(this.lastEditModeCell);c.length&&(b=c.hasClass(za),this._clearDeactivate(),this._deactivateCell(c),b&&this._activateCell(c)),a.resolve()},_setFocus:function(a){a.tabIndex=0,a.focus()},_setFocusable:function(a){function b(a){var b,c,d,e;for(b=0;b<t.columnGroups.length;b++)for(d=t.columnGroups[b],c=0;c<d.length;c++)if(e=d[c],e.property===a)return e;return null}var c,d,e,f,g,i,j,k,l,o,p,q,r,t=this,u=this.options.tabbableCellContent,v=s(a);if(this.lastFocused&&(h(this.lastFocused).removeAttr(Qa).closest(R).removeAttr("id"),d=s(this.lastFocused),v[0]!==d[0]&&d.add(d.find(u).not(Va)).prop(tb,-1)),q=v.closest(Q),k=q.attr(sb),l=null,(v.hasClass(la)||v.hasClass(X))&&(l=this.lastColIndex),null===l&&(l=w(v)),this.tableFrozenHeader$&&!v.closest(Q).closest(P).parent().hasClass(G)&&(l+=this.frozenColumnCount),l+=1,q.hasClass(ka)?o=m("BREAK_CONTEXT"):q.hasClass(Ka)?o=m("AGG_CONTEXT"):v.hasClass(V)?o=m("HEADER_CONTEXT"):v.hasClass(X)?o=m("GROUP_CONTEXT"):(k!==this.curRowNum&&l!==this.curColNum?o=n("ROW_COLUMN_CONTEXT",k,l):k!==this.curRowNum?o=n("ROW_CONTEXT",k):l!==this.curColNum&&(o=n("COLUMN_CONTEXT",l)),r=this._getControlBreak(parseInt(k,10)),r&&r.offset!==this.curControlBreak&&(o+=" "+m("BREAK_CONTEXT")+" "+r.label+".")),o&&this.accContext$.text(o),e=0,v.children(".a-GV-columnItem")[0]||(e=v.find(u).not(Va).prop(tb,0).length),e||v.prop(tb,0),this.lastFocused=a,f="",k!==this.curRowNum&&(this.curRowHeaders&&h(this.curRowHeaders).removeAttr("id"),this.curRowHeaders="",q=this._getRowForCell(v),q.find("."+ba).not(v).each(function(a){var b=t.idPrefix+"_rh_"+a;h(this).attr("id",b),f+=b+" ",t.curRowHeaders&&(t.curRowHeaders+=","),t.curRowHeaders+="#"+b})),l!==this.curColNum&&!this.focusInHeader)if(c=this._getColumnMetadata(v),c&&c.domId){for(g="",i=z(c);i;)j=b(i),j&&j.domId&&(g=j.domId+" "+g),i=j.parentGroupName;g+=c.domId,f+=g+" "}else v.hasClass(fa)&&(f+=this.idPrefix+"_shh ");p=this.idPrefix+"_cur",f+=p,f=this.accContextId+" "+f,h(a).attr(Qa,f).closest(R).attr("id",p),this.curRowNum=k,this.curColNum=l,this.curControlBreak=r?r.offset:null},_getCellFocusable:function(a){var b=a.find(this.options.tabbableCellContent).not(Va);return b.length?b[0]:a[0]},_getPrevCellUp:function(a,b,c){var d,e=null,f=null;return(a.hasClass(la)||a.hasClass(X))&&(f=this.lastColIndex),null===f&&(f=w(a),this.lastColIndex=f),a.closest(Q).prevAll(Ta).each(function(a){var c=h(this);return!c.hasClass(U)&&(d=c,a<b-1)}),this.focusInHeader||c||d||(this.focusInHeader=!0,d=a.closest(Q).closest(P).parent().hasClass(G)?this.tableFrozenHeader$.children().last():this.tableHeader$.children().last()),d&&(e=d.hasClass(ka)?d.children().first():v(d,f)),e},_getNextCellDown:function(a,b){var c,d=null,e=null;return(a.hasClass(la)||a.hasClass(X))&&(e=this.lastColIndex),null===e&&(e=w(a),this.lastColIndex=e),a.closest(Q).nextAll(Ta).each(function(a){var d=h(this);return!d.hasClass(U)&&(c=d,a<b-1)}),this.focusInHeader&&!c&&(this.focusInHeader=!1,c=a.closest(Q).closest(P).parent().hasClass(G)?this.tableFrozenData$.children().first():this.tableData$.children().first()),c&&(d=c.hasClass(ka)?c.children().first():v(c,e)),d},_copy:function(a){var b,c,d,e,f,g,h,i,j,k,l=this.model,m=this.options,n=m.dataTransferFormats;if(m.selectCells){if(i=[],d=this.getSelectedRange(),!d||!d.values.length)return;for(i=d.columns.map(function(a){return a?m.columns[0][a]:null}),n.forEach(function(a){a.writer.begin(l,d,i)}),b=0;b<d.values.length;b++){for(j=d.recordIds[b],h=null!==j?l.getRecord(j):null,n.forEach(function(a){a.writer.beginRow(b,h,j)}),g=d.values[b],c=0;c<g.length;c++)k=h&&i[c]?l.getValue(h,i[c].property):"",n.forEach(function(a){a.writer.cell(c,i[c],k,g[c])});n.forEach(function(a){a.writer.endRow()})}}else{if(d=this.getSelection(),!d.length)return;for(i=[],"NONE"!==m.rowHeader&&i.push(null),this.getColumns().forEach(function(a){a.hidden||i.push(a)}),n.forEach(function(a){a.writer.begin(l,d,i)}),b=0;b<d.length;b++){for(e=d[b],j=e.first().attr(rb),h=null!==j?l.getRecord(j):null,n.forEach(function(a){a.writer.beginRow(b,h,j)}),f=e.children(),c=0;c<f.length;c++)k=h&&i[c]?l.getValue(h,i[c].property):"",n.forEach(function(a){a.writer.cell(c,i[c],k,f.eq(c).text())});n.forEach(function(a){a.writer.endRow()})}n.forEach(function(a){a.writer.end()})}n.forEach(function(b){b.writer.end(),a.setData(b.format,b.writer.toString())})},_setSelectionMode:function(){var a=this.options,b=this.element.children(F).find(ya);this.element.toggleClass("a-GV--selectCells",a.selectCells),b.removeClass(xa).removeAttr(La),a.persistSelection&&this.model.clearSelection(),this.allSelected=!1,this.lastFocused&&b[0]&&this._select(h(this.lastFocused),null,!1)},_select:function(b,c,d,e,f){function g(a,b){var c;K.persistSelection&&(c=a.length,M.tableFrozenHeader$&&(c/=2),a.each(function(a){var d;return!(a>=c)&&(d=h(this).attr(rb),void(b&&z[d]===!1?delete z[d]:z[d]=b))}))}function i(a,b){var c=h(b);return!(a>m)&&void(a>=l&&c.hasClass(N)&&!c.hasClass(Ka)&&(K.allowSelectHidden||c.is(Ta))&&c.children().slice(E,G).addClass(xa).attr(La,!0))}function j(a,b){var c=h(b);c.hasClass(N)&&!c.hasClass(Ka)&&(K.allowSelectHidden||c.is(Ta))&&x.push(b)}var k,l,m,n,o,p,r,s,t,u,v,w,x,y,z,A,B,C,D,E,G,H,I,J=!1,K=this.options,L="set",M=this;if(K.persistSelection&&(z={}),"unset"===c||K.allowSelectHidden||(b=b.filter(Ta)),s=b.parent(Q),A=this.lastRow$&&this.lastRow$.index(b.first())>=0,this.tableFrozenHeader$&&(x=[],w=M._getOtherTable(s.first()),s.each(function(){x.push(w[M._rowIndex(h(this))])}),s=s.add(h(x))),c&&(K.selectCells&&K.multipleCells||!K.selectCells&&K.multiple)&&("string"==typeof c?L=c:"click"===c.type?c.ctrlKey||c.metaKey?L="toggle":c.shiftKey&&(L="range"):"keydown"===c.type&&(c.which===vb.SPACE?L=c.ctrlKey?"toggle":c.shiftKey?"range":"add":c.ctrlKey?L="none":c.shiftKey&&(L="range")),K.selectCells&&"range"!==L&&(L="set"),c.target||(c=null)),"range"!==L||this.selectAnchor&&!this.focusInHeader||(L="set"),!this.focusInHeader)if("set"!==L&&"range"!==L||(H=this.element.children(F).find(K.selectCells?"td.is-selected,th.is-selected":"tr.is-selected"),K.rowHeaderCheckbox&&H.find(ea).removeClass(xa),H.removeClass(xa).removeAttr(La),K.persistSelection&&this.model.clearSelection()),K.selectCells)"range"===L?(B=h(this.selectAnchor),l=q(B.parent()),m=q(b.last().parent()),l>m&&(p=m,m=l,l=p),n=q(B),C=this.tableFrozenData$&&B.closest(this.tableFrozenData$).length>0,o=q(b.last()),D=this.tableFrozenData$&&b.last().closest(this.tableFrozenData$).length>0,(C===D&&n>o||C!==D&&!C)&&(p=o,o=n,n=p,p=D,D=C,C=p),this.tableData$&&!D&&(E=n,G=o+1,C!==D&&(E=0),this.tableData$.children().each(i)),C&&this.tableFrozenData$&&(E=n,G=o+1,C!==D&&(G=void 0),this.tableFrozenData$.children().each(i))):(b.addClass(xa).attr(La,!0),this.selectAnchor=b[0]);else if(k=s.hasClass(xa),t=s.filter(O).not("."+Ka),"set"===L||"add"===L||"toggle"===L&&!k?(t.addClass(xa).attr(La,!0),this.selectAnchor=t[0],J=!0):"range"===L?(l=this._rowIndex(h(this.selectAnchor)),m=this._rowIndex(s.last()),l>m&&(p=m,m=l,l=p),m+=1,x=[],this.tableDataChildren$.slice(l,m).each(j),this.tableFrozenData$&&this.tableFrozenDataChildren$.slice(l,m).each(j),t=h(x),t.addClass(xa).attr(La,!0),J=!0):("toggle"===L&&k||"unset"===L)&&(t.removeClass(xa).removeAttr(La),this.selectAnchor=t[0],K.rowHeaderCheckbox&&t.find(ea).removeClass(xa),g(t,!1)),J&&(K.rowHeaderCheckbox&&t.find(ea).addClass(xa),g(t,!0)),K.multiple&&K.selectAll&&(u=(this.tableFrozenData$||this.tableData$).children(O).not("."+Ka),K.allowSelectHidden||(u=u.filter(Ta)),this.allSelected=v=u.length===u.filter(ya).length,K.rowHeaderCheckbox&&this.tableFrozenHeader$.find(ea).first().toggleClass(xa,v).attr(Ra,v?Za:$a).closest(ga).toggleClass(xa,v)),K.persistSelection)for(y in z)z.hasOwnProperty(y)&&this.model.setSelectionState(y,z[y]);b.length>0&&null!==d&&(r=this._getCellFocusable(b.first()),d?this._setFocus(r):this._setFocusable(r),A||this._setCurrentRow(b[0])),this.focusInHeader||"toggle"!==L&&"unset"!==L&&("range"!==L||!K.selectCells&&k)&&("add"!==L||k)&&("set"!==L||!K.selectCells&&a.arrayEqual(H,t))||(I=!(f||K.navigation&&c&&"click"===c.type),e?Eb(this,I,c):Db(this,I,c))},_clearChildrenRowCache:function(){this.tableFrozenDataChildren$=this.tableDataChildren$=null},_getOtherTable:function(a){var b,c=a.closest(P).parent().hasClass(G);return a.parents(F).length?c?(this.tableDataChildren$||(this.tableDataChildren$=this.tableData$.children()),b=this.tableDataChildren$):(this.tableFrozenDataChildren$||(this.tableFrozenDataChildren$=this.tableFrozenData$.children()),b=this.tableFrozenDataChildren$):b=(c?this.tableHeader$:this.tableFrozenHeader$).children(),b},_rowIndex:function(a){var b,c=a.closest(P).parent().hasClass(G);return a.parents(F).length?(this.tableFrozenData$&&!this.tableFrozenDataChildren$&&(this.tableFrozenDataChildren$=this.tableFrozenData$.children()),this.tableDataChildren$||(this.tableDataChildren$=this.tableData$.children()),b=c?this.tableFrozenDataChildren$:this.tableDataChildren$,b.index(a)):q(a)},_getRowForCell:function(a){var b=a.closest(Q);return this.tableFrozenHeader$&&(b=b.add(this._getOtherTable(b).eq(this._rowIndex(b)))),b},_setCurrentRow:function(a){this.lastRow$=this._getRowForCell(h(a)).children()},_fireActivate:function(a,b){var c=this._getRowForCell(b);this._trigger(hb,a,{cell$:b,row$:c})},_nextCellWithWrap:function(a){function b(a){for(;e&&a.hasClass(Ka)||a.not(Ta).length;)a=a.next();return a.children().first()}function c(a){var c,d,e,g=a.next();return g.length||(c=a.closest(Q),f.tableFrozenHeader$?(d=f._getOtherTable(c),e=f._rowIndex(c),c.closest(P).parent().hasClass(G)?g=d.eq(e).children().first():(c=d.eq(e+1),g=b(c))):(c=c.next(),g=b(c))),g}var d,e=this.options.skipReadonlyCells,f=this;if(d=c(a),e)for(;d.hasClass(Ia);)d=c(d);return d},_prevCellWithWrap:function(a){function b(a){for(;e&&a.hasClass(Ka)||a.not(Ta).length;)a=a.prev();return a.children().last()}function c(a){var c,d,e,g=a.prev();return g.length||(c=a.closest(Q),f.tableFrozenHeader$?(d=f._getOtherTable(c),e=f._rowIndex(c),c.closest(P).parent().hasClass(G)?(e-=1,e>=0&&(c=d.eq(e),g=b(c))):g=d.eq(e).children().last()):(c=c.prev(),g=b(c))),g}var d,e=this.options.skipReadonlyCells,f=this;if(d=c(a),e)for(;d.hasClass(Ia);)d=c(d);return d},_clearHoverStates:function(){this.element.find(Ba).removeClass(Aa),this.columnControls$.hide(),this.columnHandle$.hide()},_setRowHoverState:function(a){this.element.find(Ba).removeClass(Aa),a=this._getRowForCell(a.children().eq(0)),a.addClass(Aa)},_sortChange:function(a,b,c){var d,e="set",f=this._getColumnMetadata(b);f.canSort&&(d=c===f.sortDirection,this.options.columnSortMultiple&&a.shiftKey?(e="add",e=d?"remove":f.sortDirection?"change":"add"):d&&(e="clear"),this._trigger(bb,a,{header$:b,column:f,direction:c,action:e}))},_updateColumnControls:function(a){var b,c,d=!1,e=!1;"asc"===a.sortDirection?(b=m("SORT_OFF"),c=m("SORT_DESCENDING"),d=!0):"desc"===a.sortDirection?(b=m("SORT_ASCENDING"),c=m("SORT_OFF"),e=!0):(b=m("SORT_ASCENDING"),c=m("SORT_DESCENDING")),this.columnControls$.find(".js-asc").attr(ob,b).attr(Oa,b).toggleClass(Ea,d),this.columnControls$.find(".js-desc").attr(ob,c).attr(Oa,c).toggleClass(Ea,e)},_adjustSizeForScrollBars:function(b,c,d){var e=this.element.children(),f=e.filter(F).children(H),g=e.filter(D).children(J),h=A(this.tableData$.parent(),d);h.h&&(b-=a.getScrollbarSize().height),f.height(b),h.v&&(c-=a.getScrollbarSize().width),g.width(c)},_headerScrollCheck:function(a,b,c){var d,e,f,g=0,i=this.hdrScrollParent;return i&&(f=h(this.hdrScrollParent).offset().left,this.element.hasClass(Sa)?(a-b-f<lb?g=-mb:f+i.offsetWidth-a<lb&&f+i.offsetWidth-a>0&&(g=mb),c&&g&&(d=i.scrollLeft+g,d>0?(i.scrollLeft=0,g=0):d>i.scrollWidth-i.clientWidth?(i.scrollLeft=i.scrollWidth-i.clientWidth,g=0):i.scrollLeft=d)):(f+i.offsetWidth-(a+b)<lb?g=mb:a-f<lb&&a-f>0&&(g=-mb),c&&g&&(d=i.scrollLeft+g,d<0?(i.scrollLeft=0,g=0):d>i.scrollWidth-i.clientWidth?(i.scrollLeft=i.scrollWidth-i.clientWidth,g=0):i.scrollLeft=d)),e=!!g),e},_headerScrollStart:function(a,b,c){function d(){e.scrollTimerId=setTimeout(function(){e._headerScrollCheck(a,b,!0)?(c(),d()):e._headerScrollStop()},g[f]),f<g.length-1&&(f+=1)}var e=this,f=0,g=[151,134,119,106,95,86,79,74,71];this.scrollTimerId&&this._headerScrollStop(),d()},_headerScrollStop:function(){clearTimeout(this.scrollTimerId),this.scrollTimerId=null},_expandCollapseControlBreak:function(a,b){function c(a,c){var d=h(c);return!(!d.hasClass(N)||d.hasClass(Ka))&&(!b&&k&&d.hasClass(xa)&&j.push(d.children(R)[0]),void d[b?"show":"hide"]())}var d,e,f,g,i,j=[],k=!this.options.allowSelectHidden;for(h.isArray(a)||(a=[a]),d=0;d<a.length;d++)e=a[d],e.hasClass(ka)&&(2!==e.length&&this.tableFrozenHeader$&&(f=this._getOtherTable(e),e=h([e[0],f[this._rowIndex(e)]])),e.first().nextAll().each(c),k=!1,2===e.length&&e.last().nextAll().each(c),b?(g=m("BREAK_COLLAPSE"),e.addClass(Da).find(".js-toggleBreak").attr(Pa,Za).attr(ob,g).attr(Oa,g).children(".a-Icon").removeClass("icon-right-arrow").addClass("icon-down-arrow")):(g=m("BREAK_EXPAND"),e.removeClass(Da).find(".js-toggleBreak").attr(Pa,$a).attr(ob,g).attr(Oa,g).children(".a-Icon").removeClass("icon-down-arrow").addClass("icon-right-arrow")));j.length&&(i=this.focusInHeader,this.focusInHeader=!1,this._select(h(j),"unset",h(document.activeElement).closest(this.element[0]).length>0,null),this.focusInHeader=i)},debugCellEdit:function(a){this.debugDontDeactivateCell=!!a}},apex.widget.contextMenuMixin))}(apex.util,apex.model,apex.debug,apex.lang,apex.item,apex.clipboard,apex.widget.util,apex.jQuery);
!function(a,b,c,d,e,f,g){"use strict";function h(a,b){var c="";return"start"===a?c=" u-tS":"end"===a?c=" u-tE":"left"===a?c=" u-tL":"right"===a?c=" u-tR":"center"!==a||b||(c=" u-tC"),c}function i(a){var b=a.groupName||null;return b&&a.useGroupFor&&a.useGroupFor.indexOf("srv")<0&&(b=null),b}var j="a-RV",k="a-RV-toolbar",l="a-RV-w-scroll",m="a-RV-body",n="a-RV--excludeHidden",o="a-RV--excludeNull",p="u-Form",q="u-Form-groupHeading",r="u-Form-fieldContainer",s="."+r,t=s+".is-active",u="u-Form-labelContainer",v="u-Form-label",w="."+v,x="u-Form-inputContainer",y="."+x,z="t-Form-error",A="."+z,B=".t-Alert",C="a-RV-field--hidden",D="a-RV-field--null",E="is-focused",F="is-disabled",G="is-active",H="."+G,I="is-required",J="is-readonly",K="is-error",L="is-warning",M="is-error is-warning is-readonly",N="u-RTL",O="aria-labelledby",P=":tabbable",Q="data-itemhelp",R=":visible",S="enable",T="disable",U="option",V="show",W="hide",X="record",Y="table",Z="tree",$="modeChange",_="recordChange",aa="delete-record",ba="duplicate-record",ca="next-record",da="previous-record",ea="exclude-null-values",fa="exclude-hidden",ga="insert-record",ha="refresh-record",ia="revert-record",ja=g.ui.keyCode,ka=[{align:"start",controls:[{type:"MENU",labelKey:"APEX.RV.SETTINGS_MENU",iconOnly:!0,icon:"icon-gear",menu:{items:[{type:"toggle",action:ea},{type:"toggle",action:fa}]}}]},{align:"end",controls:[{type:"STATIC",id:"status",label:""},{type:"BUTTON",iconOnly:!0,action:da},{type:"STATIC",id:"recordNumber",label:""},{type:"BUTTON",iconOnly:!0,action:ca}]}];g.widget("apex.recordView",g.apex.tableModelViewBase,{version:"19.1",widgetEventPrefix:"recordview",options:{idPrefix:null,actionsContext:null,recordOffset:0,recordParent:null,showNullAs:"-",fields:null,fieldGroups:null,alwaysEdit:!1,skipDeletedRecords:!1,toolbar:ka,showExcludeNullValues:!0,showExcludeHiddenFields:!0,formCssClasses:null,labelAlignment:"end",modeChange:null,recordChange:null},_create:function(){var a=this,b=this.options,c=this.element;c.addClass(j),this._super(),delete this.firstPage,delete this.previousPage,delete this.nextPage,delete this.lastPage,delete this.loadMore,delete this.gotoPage,this.editMode=!1,this.fields=null,this.excludeNullValues=!1,this.excludeHiddenFields=!1,this.lastFocused=null,this.lastField=null,this.toolbar$=null,this.currentRecord=null,this.currentRecordId=null,b.actionsContext?this.actions=b.actionsContext:this.actions=f.createContext("recordView",c[0]),this.actions.remove([ea,fa,ca,da,ga,ha,ia,aa,ba]),this.actions.add([{name:ea,labelKey:"APEX.RV.EXCLUDE_NULL",get:function(){return a.excludeNullValues},set:function(d){b.showExcludeNullValues&&(a.excludeNullValues=d,c.toggleClass(o,d))}},{name:fa,labelKey:"APEX.RV.EXCLUDE_HIDDEN",get:function(){return a.excludeHiddenFields},set:function(d){b.showExcludeHiddenFields&&(a.excludeHiddenFields=d,c.toggleClass(n,d))}},{name:ca,labelKey:"APEX.RV.NEXT_RECORD",shortcut:"Alt+Page Down",icon:"icon-next",action:function(){var c,d;if(a.modelShape===Z){if(d=a._nextTreeRecord(),!d)return;b.recordParent=d.parent,b.recordOffset=d.offset}else{if(c=a.model.getTotalRecords(),!(c<0||b.recordOffset+1<c))return;b.recordOffset+=1}a.direction=1,a.refresh(!1)}},{name:da,labelKey:"APEX.RV.PREV_RECORD",shortcut:"Alt+Page Up",icon:"icon-prev",action:function(){var c;if(a.modelShape===Z){if(c=a._previousTreeRecord(),!c)return;b.recordParent=c.parent,b.recordOffset=c.offset}else{if(!(b.recordOffset>0))return;b.recordOffset-=1}a.direction=-1,a.refresh(!1)}},{name:ga,labelKey:"APEX.RV.INSERT",action:function(){if(b.editable)return a.model.insertNewRecord(a.modelShape===Z?b.recordParent:null,a.getRecord()),a.actions.invoke(ca),a.editMode||a.setEditMode(!0),a.focus(),!0}},{name:ha,labelKey:"APEX.RV.REFRESH",action:function(){b.editable&&a.model.fetchRecords([a.getRecord()])}},{name:ia,labelKey:"APEX.RV.REVERT",action:function(){b.editable&&a.model.revertRecords([a.getRecord()])}},{name:aa,labelKey:"APEX.RV.DELETE",action:function(){b.editable&&a.model.deleteRecords([a.getRecord()])}},{name:ba,labelKey:"APEX.RV.DUPLICATE",action:function(){if(b.editable){var c=a.getRecord();return a.model.copyRecords([c],null,c),a.actions.invoke(ca),a.editMode||a.setEditMode(!0),a.focus(),!0}}}]),this._updateMenuActions(),this._initModel(b.modelName),this._on(this._eventHandlers),this.direction=1,this.refresh(),b.disabled&&this._setOption("disabled",b.disabled)},_eventHandlers:{resize:function(a){a.target===this.element[0]&&(this.resize(),a.stopPropagation())},dblclick:function(a){var b=this.options,c=g(a.target).closest(s);c.length&&!b.alwaysEdit&&b.editable&&!this.editMode&&(a.preventDefault(),this.setEditMode(!0))},click:function(a){var b,c=g(a.target).closest(w);c.length&&(b=c.closest(s),b.find(P).first().focus())},keydown:function(a){var b,c,d,e=this.options,f=a.which;if(f===ja.ENTER){if(g(a.target).closest("a,button").length>0)return;b=g(a.target).closest(s),b.length&&!e.alwaysEdit&&e.editable&&!this.editMode&&(a.preventDefault(),this.setEditMode(!0))}else if(113===f)b=g(a.target).closest(s),b.length&&!e.alwaysEdit&&e.editable&&!this.editMode&&(a.preventDefault(),this.setEditMode(!0));else if(f===ja.ESCAPE)!e.alwaysEdit&&e.editable&&this.editMode&&(g(a.target).closest(y).focus(),this.setEditMode(!1),a.stopPropagation());else if(112===f&&a.altKey&&(b=g(a.target).closest(s),c=b.find(".js-itemHelp"),c.length&&(d=c.attr(Q))))return apex.theme.popupFieldHelp(d,$v("pInstance")),!1},focusin:function(a){function b(){e.deactivateDelayTimer&&(clearTimeout(e.deactivateDelayTimer),e.deactivateDelayTimer=null)}var c,d,e=this,f=g(a.target);return d=f.closest(s),0===d.length?void(this.lastField=null):(d.addClass(E),this.lastFocused=d[0],d[0]===this.lastField?void b():(this.lastField=d[0],void(this.editMode&&(b(),c=this.element.find(H),c.length&&this._deactivateField(c),this._activateField(d)))))},focusout:function(a){var b=this,c=g(a.target).closest(s);0!==c.length&&(c.removeClass(E),this.editMode&&(this.deactivateDelayTimer=setTimeout(function(){b.lastField=null,b._deactivateField(c),b.deactivateDelayTimer=null},10)))}},_destroy:function(){this.element.removeClass(j+" "+F+" "+N+" "+n+" "+o).empty(),this._initModel(null)},_setOption:function(a,b){"editable"===a&&!b&&this.editMode&&this.setEditMode(!1),this._super(a,b),"disabled"===a?(this.element.toggleClass(F,b),b&&this.resize()):"showExcludeNullValues"===a||"showExcludeHiddenFields"===a?this._updateMenuActions():"recordOffset"===a||"recordParent"===a?this.refresh():"modelName"===a?(this.editMode&&this.setEditMode(!1),this._initModel(b),this.refresh()):"editable"!==a&&"alwaysEdit"!==a&&"toolbar"!==a&&"formCssClasses"!==a&&"labelAlignment"!==a||this._refreshView()},getActions:function(){return this.actions},getToolbar:function(){return this.toolbar$},refresh:function(a){var b,c=this,d=this.options,e=this.element;this._refreshCheckIfVisible()&&(b=e.find(t),b.length&&this._deactivateField(b),this.fields||this._initView(),!this.editMode&&d.alwaysEdit&&this.setEditMode(!0),this._updateRecord(null,null,function(){a&&c.focus()}))},focus:function(){this.lastField=null,this.body$.find(P).first().focus()},gotoField:function(a,b){var d,e,f,g,h,i=this.options,j=null;if(e=this.model.getRecord(a),!e)return void c.warn("Warning record not found "+a);if(a!==this.currentRecordId&&(i.recordOffset=this.model.indexOf(e),this.refresh()),b)if(g=i.fields[0][b]){for(g.hidden&&g.canHide&&this.excludeHiddenFields&&this.actions.set(fa,!1),h=this.model.getValue(e,b),null!==h&&""!==h||!this.excludeNullValues||this.actions.set(ea,!1),d=0;d<this.fields.length;d++)if(f=this.fields[d],!(f.virtual||!f.canHide&&f.hidden)&&f.property===b){j=this.element.find("[data-idx='"+d+"']");break}d>=this.fields.length&&c.warn("Warning field is hidden "+b)}else c.warn("Warning field not found "+b);j?(this.lastField=null,j.find(P).first().focus()):this.focus()},getFields:function(){return this.fields},refreshFields:function(){this.fields=null},fieldElement:function(a){return this.mapFieldToLabelId&&this.mapFieldToLabelId[a]?g("#"+this.mapFieldToLabelId[a]).closest(s):g()},inEditMode:function(){return this.editMode},setEditMode:function(a){var b,d,e,f=this.element,h=this,i="change.rvedit";this.scrollWrap$&&(this.options.editable?(a=!!a,e=this.editMode,b=a!==e,b&&(d=g(this.lastFocused),this._updateRecord(a,e,function(){h.editMode=a,f.toggleClass("a-RV--editMode",a),a&&!d.length&&(h.focus(),d=g(h.lastFocused)),d.length&&(d.find(P).first().focus(),h.deactivateDelayTimer&&(clearTimeout(h.deactivateDelayTimer),h.deactivateDelayTimer=null),a?h._activateField(d):h._deactivateField(d)),a?h.body$.on(i,function(a){var b,c,d;if(h.activeRecord&&!g(a.target).closest(t).length)for(b=0;b<h.fields.length;b++)if(c=h.fields[b],c.elementId===a.target.id){d=c.property,h.setActiveRecordValue(d);break}}):(h.body$.off(i),h.activeRecord=null,h.activeRecordId=null),h._trigger($,null,{editMode:a})}))):a&&c.warn("View is not editable."))},getRecord:function(){return this.currentRecord},resize:function(){var a,b=this.element,c=b.height();null!==b[0].offsetParent&&(this.scrollWrap$&&!this.pendingRefresh||(this.refresh(),this.fields))&&this.options.hasSize&&(a=c-(this.toolbar$?this.toolbar$.outerHeight():0),this.scrollWrap$.height(a))},expandGroup:function(a){},collapseGroup:function(a){},_initModel:function(b){function c(b,c){function g(a,g){var h,i;for(h=0;h<a.length;h++)i=a[h],i===f.currentRecordId&&("delete"===b?d&&e.skipDeletedRecords?(f.currentRecord=null,f.currentRecordId=null,f.activeRecord=null,f.activeRecordId=null,f.actions.invoke(ca),null===f.currentRecord&&f.actions.invoke(da)):f._updateRecord():"clearChanges"===b&&g?f.actions.invoke(ca):"refreshRecords"===b?(i=c.newIds[i]||i,f._updateRecord()):"revert"===b?f._updateRecord():f._updateRecordState())}var h,i,j,k,l,m,n,o;"refresh"===b?(f.modelShape===Z?(f.recordOffset=-1,f.recordParent=null):f.modelShape===Y&&f.currentRecordId?(n=f.model.getRecord(f.currentRecordId),o=f.model.indexOf(n),e.recordOffset=o>-1?o:0):e.recordOffset=0,f.refresh(!0)):"insert"===b||"copy"===b?f.noData&&f.refresh():"refreshRecords"===b?g(c.recordIds):"clearChanges"===b?(g(c.deletedIds,!0),g(c.changedIds)):c.recordIds?g(c.recordIds):"set"===b?f.ignoreFieldChange||(c.oldIdentity&&f._identityChanged(c.oldIdentity,f.model.getRecordId(c.record)),f.model.getRecordId(c.record)===f.currentRecordId&&(h=f.columnItems[c.field],f.editMode&&h?f.ignoreItemChange||f._setColumnItemValue(h.item,c.record,c.field):(k=f.fieldElement(c.field),k.length&&(j=f._getFieldMetadata(k),l=f.model.getRecordMetadata(f.currentRecordId),m=null,l.fields&&(m=l.fields[j.property]),i=a.htmlBuilder(),f._renderFieldDataValue(i,j,c.record,l,m),k.find(y).html(i.toString()))),f._updateRecordState())):"metaChange"===b&&(f.ignoreFieldChange||c.recordId!==f.currentRecordId||f._updateRecordState())}var d,e=this.options,f=this;this._super(b,c),b&&(d=this.model.getOption("onlyMarkForDelete"),this.modelShape=this.model.getOption("shape"),this.modelShape===X&&(this.actions.hide(ca),this.actions.hide(da),this.actions.hide(ga),this.actions.hide(ba),this.actions.hide(aa)))},_updateMenuActions:function(){var a=this.options;this.actions[a.showExcludeNullValues?V:W](ea),this.actions[a.showExcludeHiddenFields?V:W](fa)},_updateFields:function(){var a,b,c,d=this.options,e={},f=d.fields[0];this.fields=[];for(b in f)f.hasOwnProperty(b)&&(a=f[b],a.property=b,this.fields.push(a),c=i(a),c&&(!e[c]||a.seq<e[c])&&(e[c]=a.seq));this.fields.sort(function(a,b){var c,d;return i(a)===i(b)?a.seq-b.seq:i(a)?i(b)?(c=e[i(a)]||0,d=e[i(b)]||0,c-d):-1:1})},_initView:function(){var a=this.options,b=this.editMode;this._updateFields(),this.columnItems||this._initColumnItems(this.fields),this.toolbar$=null,b&&this.setEditMode(!1),this._renderView(),(b||a.alwaysEdit)&&this.setEditMode(!0),a.toolbar&&(this.toolbar$=this.element.children("."+k).toolbar({idPrefix:this._getIdPrefix()+"tb",actionsContext:this.actions,data:a.toolbar,small:!0}),this.modelShape===X&&this.toolbar$.toolbar("hideControl","recordNumber")),this.resize()},_refreshView:function(){this.refreshFields(),this.refresh()},_forEachField:function(a,b){var c,d,e,f,g,h=this.fields;for(a&&(f=this.element.find(y)),e=0,c=0;c<h.length;c++)d=h[c],d.virtual||!d.canHide&&d.hidden||(g=null,a&&(g=f.eq(e)),b.call(this,c,d,g),e+=1)},_getIdPrefix:function(){return(this.options.idPrefix||this.element[0].id||"rv")+"_"},_renderView:function(){function b(){o.markup("<div").attr("class",p+(j.formCssClasses?" "+j.formCssClasses:"")).markup(">"),e=!0}var c,e,f,j=this.options,n=this.element,o=a.htmlBuilder();j.toolbar&&o.markup("<div class='"+k+"'></div>"),this._renderAltDataMessages(o),o.markup("<div class='"+l+"'>").markup("<div class='"+m+"'>"),this.mapFieldToLabelId={},c=null,e=!1,this._forEachField(!1,function(a,g){var k,l,m,n,p,s,t;if(p=this._getIdPrefix()+a,this.mapFieldToLabelId[g.property]=p,f=i(g),c!==f){if(f){if(l=j.fieldGroups[f],!l)throw new Error("Unknown field group name: "+f);m=l.label||l.heading}else m=d.getMessage("APEX.RV.NOT_GROUPED_LABEL");e&&o.markup("</div>"),o.markup("<h3 class='"+q+"'><button type='button'>").content(m).markup("</button></h3>"),b(),c=f}e||b(),k=r,g.hidden&&(k+=" "+C),g.fieldCssClasses&&(k+=" "+g.fieldCssClasses),g.isRequired&&(k+=" "+I),n=g.label||g.heading,s=null,g.fieldColSpan&&(s=parseInt(g.fieldColSpan,10),s>0&&s<13?o.markup("<div class='apex-col apex-col-"+s+"'>"):s=null),o.markup("<div").optionalAttr("id",g.elementId?g.elementId+"_CONTAINER":null).attr("data-idx",a).attr("class",k).markup("><div").attr("id",p).attr("class",u+" "+h(j.labelAlignment)).markup(">"),o.markup("<span").optionalAttr("id",g.elementId?g.elementId+"_LABEL":null).attr("class",v).markup(">").content(n).markup("</span>"),g.helpid&&(t=d.formatMessage("APEX.ITEM.HELP_TEXT",n),o.markup("<button class='t-Button t-Button--noUI t-Button--helpButton js-itemHelp' tabindex='-1' type='button'").attr(Q,g.helpid).attr("aria-label",t).attr("title",t).markup("><span class='a-Icon icon-help' aria-hidden='true'></span></button>")),o.markup("</div><div tabindex='0' class='"+x+"'").attr(O,g.elementId+"_LABEL").markup("></div></div>"),s&&o.markup("</div>")}),e&&o.markup("</div>"),o.markup("</div></div>"),n.html(o.toString()).find("."+q).each(function(){var a=g(this);a.collapsible({heading:"."+q,controllingElement:"button",universalTheme:!0,collapsed:!1,content:a.next()})}),this.scrollWrap$=n.find("."+l),this.body$=n.find("."+m),this.noData$=n.find(".a-GV-noDataMsg")},_updateRecord:function(a,b,c){function d(){var a,b,c,d,e,f,h;for(e=g.model.getRecordMetadata(g.currentRecordId),a=0;a<g.fields.length;a++)b=g.fields[a].property,c=g.columnItems[b],c&&(h=c.item.isDisabled(),c.element$.is(R)&&!h?(d=c.item.getValidity(),d.valid||g.model.setValidity("error",g.currentRecordId,b,c.item.getValidationMessage())):g.model.setValidity("valid",g.currentRecordId,b),e&&(f=e.fields?e.fields[b]:null,(f&&f.hasOwnProperty("disabled")||h)&&(f||(e.fields||(e.fields={}),f={},e.fields[b]=f),f.disabled=h)));g._triggerEndEditing(g.currentRecord,g.currentRecordId),g.activeRecord=null,g.activeRecordId=null}function e(e,f,j){var k,l,m,n=g.body$;if(e){if(k=g.model.getRecordMetadata(j)||{},g.scrollWrap$.show(),g.noData$.hide(),k.agg||k.deleted&&i.skipDeletedRecords)return g.modelShape===Z?(l=g[g.direction>0?"_nextTreeRecord":"_previousTreeRecord"](),l&&(i.recordParent=l.parent,i.recordOffset=l.offset)):(i.recordOffset+=g.direction,m=g.model.getTotalRecords(),i.recordOffset<0?(i.recordOffset=0,g.direction=-g.direction):m>=0&&i.recordOffset>=m&&(i.recordOffset=m-1,g.direction=-g.direction)),g._updateRecord(a,b,c),void g._updateRecord();i.editable&&g.currentRecord&&(a&&b!==!1||b===!0)&&d(),i.recordOffset=f,g.currentRecordId=j,g.currentRecord=null,g.activeRecord=null,g._renderRecordFields(a,e,f,j,k),g.currentRecord=e,a&&(g.activeRecord=e,g.activeRecordId=j),n.children(B).remove(),n.find(A).remove(),g._updateRecordState(),g._updateRecordNumber(),i.editable&&a&&g._triggerBeginEditing(g.currentRecord,g.currentRecordId),null!==h&&h===g.currentRecordId||setTimeout(function(){g._trigger(_,null,{recordOffset:i.recordOffset,recordId:g.currentRecordId})},1)}else i.editable&&g.currentRecord&&(a&&b!==!1||b===!0)&&d(),g.currentRecordId=null,g.currentRecord=null,g._renderRecordFields(a,null,-1,null,{}),g.scrollWrap$.hide(),g.noData$.show(),g._updateActions(),g._updateRecordNumber()}var f,g=this,h=this.currentRecordId,i=this.options;if(null!==a&&void 0!==a||(a=this.editMode),this.activeLockCount>0)return void(this.activeUnlockCallback=function(){g._updateRecord(a,b,c)});switch(this.modelShape){case X:f=this.model.getRecord(),e(f,0,f?this.model.getRecordId(f):null);break;case Y:this.model.forEachInPage(i.recordOffset,1,function(a,b,c){e(a,b,c)},this);break;case Z:null===i.recordParent?(f=this.model.root(),i.recordOffset=-1,e(f,i.recordOffset,f?this.model.getRecordId(f):null)):(f=this.model.child(i.recordParent,i.recordOffset),e(f,i.recordOffset,f?this.model.getRecordId(f):null))}c&&c()},_renderRecordFields:function(b,c,d,e,f){var g=null,h=!1,i=a.htmlBuilder(),j=this.columnItemsContainer$?this.columnItemsContainer$[0]:null;b&&c&&(h=this.model.allowEdit(c)),this._forEachField(!0,function(a,b,d){var e,k,l,m=!1;e=r,c&&(k=this.model.getValue(c,b.property),null!==k&&""!==k||(e+=" "+D),b.hidden&&(e+=" "+C),b.fieldCssClasses&&(e+=" "+b.fieldCssClasses),b.isRequired&&(e+=" "+I),f.fields&&(g=f.fields[b.property]),g&&(g.disabled&&(e+=" is-disabled"),m=g.ck),(m||b.readonly)&&(e+=" "+J,m=!0)),l=this.columnItems[b.property],h&&l&&!m&&!b["volatile"]?l.element$.parent()[0]===j&&(d.empty().append(l.element$).attr("tabindex",-1).removeAttr(O),this._activateColumnItem(l,b.elementId+"_LABEL")):(l&&l.element$.closest(this.element).length&&(this._deactivateColumnItem(l),d.attr("tabindex",0).attr(O,b.elementId+"_LABEL")),c?(i.clear(),this._renderFieldDataValue(i,b,c,f,g),d.html(i.toString())):d.empty()),d.parent().attr("class",e)}),h&&c&&(this._beginSetColumnItems(),this._forEachField(!0,function(a,b,d){var e=this.columnItems[b.property];!e||d.hasClass(J)||b["volatile"]||this._setColumnItemValue(e.item,c,b.property,h?f:null)}),this._endSetColumnItems())},_updateRecordState:function(){var a,b,c,e,f,h="",i=this.body$;if(b=this.model.getRecordMetadata(this.currentRecordId)||{},i.removeClass("is-deleted is-inserted is-updated "+M),b.deleted?(i.addClass("is-deleted"),h=d.getMessage("APEX.GV.ROW_DELETED")):b.inserted?(i.addClass("is-inserted"),h=d.getMessage("APEX.GV.ROW_ADDED")):b.updated&&(i.addClass("is-updated"),h=d.getMessage("APEX.GV.ROW_CHANGED")),this.model.allowEdit(this.currentRecord)||i.addClass(J),b.error||b.warning?(c=i.children(B),c.length||(c=g("<div class='t-Alert'></div>"),i.prepend(c)),c.text(b.message),i.addClass(b.error?K:L)):i.children(B).remove(),b.fields)for(a in b.fields)b.fields.hasOwnProperty(a)&&(e=b.fields[a],f=this.fieldElement(a),f.removeClass("is-changed "+M),e.error||e.warning?(c=f.find(A),c.length||(c=g("<span class='"+z+"'></span>"),f.find(y).append(c)),c.text(e.message),f.addClass(e.error?K:L)):(f.find(A).remove(),e.changed&&f.addClass("is-changed")),e.ck&&f.addClass(J));this._updateActions(),this.toolbar$&&this.toolbar$.toolbar("findElement","status").text(h)},_hasPrevious:function(){var a=this.options;switch(this.modelShape){case X:return!1;case Y:return a.recordOffset>0;case Z:return null!==this._previousTreeRecord()}},_hasNext:function(){var a,b=this.options;switch(this.modelShape){case X:return!1;case Y:return a=this.model.getTotalRecords(),a<0||b.recordOffset+1<a;case Z:return null!==this._nextTreeRecord()}},_nextTreeRecord:function(){var a,b,c=this.options,d=c.recordOffset,e=c.recordParent;if(b=null===e?this.model.root():this.model.child(e,d),this.model.childCount(b)>0)return{parent:b,offset:0};for(;e;){if(a=this.model.childCount(e),a>0&&d+1<a)return{parent:e,offset:d+1};d=this.model.indexOf(e),e=this.model.parent(e)}return null},_previousTreeRecord:function(){function a(c){var d=b.model.childCount(c);return d>0?a(b.model.child(c,d-1)):{parent:b.model.parent(c),offset:b.model.indexOf(c)}}var b=this,c=this.options,d=c.recordOffset,e=c.recordParent;return null===e?null:e&&d>0?a(this.model.child(e,d-1)):{parent:this.model.parent(e),offset:this.model.indexOf(e)}},_updateActions:function(){function a(a,b){c[a?S:T](b)}var b=this.options,c=this.actions,d=this.currentRecord,e=b.editable,f=this.model,g=this.modelShape===Z?b.recordParent:null,h=e&&f.allowAdd(g,"new"),i=e&&d&&f.allowAdd(g,"copy"),j=e&&d;a(j&&f.canRevertRecord(d),ia),a(j&&f.allowDelete(d),aa),a(h,ga),a(i,ba),a(d&&this._hasNext(),ca),a(d&&this._hasPrevious,da)},_getFieldMetadata:function(a){var b=parseInt(a.attr("data-idx"),10);return isNaN(b)?null:this.fields[b]},_activateField:function(a){var b,c;a.length<=0||null===this.currentRecord||(b=this._getFieldMetadata(a),b&&(c=this.columnItems[b.property]),c&&this.model.allowEdit(this.currentRecord)&&!a.hasClass(J)&&a.addClass(G))},_deactivateField:function(a){var b,c=null;a.length<=0||null===this.currentRecord||(b=this._getFieldMetadata(a),b&&(c=this.columnItems[b.property]),c&&!a.hasClass(J)&&a.hasClass(G)&&(this._setModelValue(a,c.item,this.currentRecord,b.property),this._updateRecordState()))},_updateRecordNumber:function(){var a,b,c="",e=this.options;this.toolbar$&&(this.currentRecord&&(this.modelShape===Z?(b=this.model.parent(this.currentRecord),b&&(a=this.model.childCount(b))):a=this.model.getTotalRecords(),c=a>0?d.formatMessage("APEX.RV.REC_XY",e.recordOffset+1,a):d.formatMessage("APEX.RV.REC_X",e.recordOffset+1)),this.toolbar$.toolbar("findElement","recordNumber").text(c))},_identityChanged:function(a,b){a===this.currentRecordId&&(this.currentRecordId=b,this.activeRecordId&&(this.activeRecordId=b))}}),g.apex.recordView.copyDefaultToolbar=function(){var a,b=[];for(a=0;a<ka.length;a++)b.push(g.extend(!0,{},ka[a]));return b},g.apex.recordView.createModelEditDialog=function(c,e){function h(a){v&&(n&&v.expand(v.getSelection().first()),y&&clearTimeout(y),y=setTimeout(function(){v[n?"setSelectedNodes":"setSelectedRecords"]([a]),y=null},1))}var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=g,A=[],B=z("#"+c),C=e.modelOptions.shape||Y,D=e.okLabelKey?d.getMessage(e.okLabelKey):null,E=a.htmlBuilder();e.appendToTop&&(z=a.getTopApex().jQuery),t=z("body").context,B.length||(B=z("<div id='"+c+"'></div>"),z(e.appendTo||"body").append(B)),C===Z?j=g.apex.treeView.makeModelNodeAdapter(e.modelName,e.modelOptions,null):(C===X&&(A=null),j=b.create(e.modelName,e.modelOptions,A,0,!1)),q=j.getOption("shape"),r=j.getOption("fields"),s=j.getOption("editable"),u=s&&j.getOption("sequenceField"),E.markup("<form novalidate><section class='a-IGDialog-region a-IGDialog-body'>"),q!==X&&E.markup("<aside class='a-IGDialog-side resize'><div class='nav resize'></div><div class='tb'></div></aside>"),E.markup("<main class='a-IGDialog-main resize'><div class='rv resize'></div></main></section></form>"),i=g.extend({closeText:d.getMessage("APEX.DIALOG.CLOSE"),noDataMessage:null},e,{autoOpen:!1,modal:!0,create:function(){var a,b,d,i,p=f.createContext("ModelEditDialog",B[0]);if(z(this).closest(".ui-dialog").css("position","fixed"),m=g("#"+c,t).find(".rv"),m.recordView({modelName:e.modelName,noDataMessage:e.noDataMessage,idPrefix:e.idPrefix||e.modelName,fields:[r],actionsContext:p,toolbar:null,editable:!0,alwaysEdit:!0,hasSize:!0,skipDeletedRecords:!0,formCssClasses:e.formCssClasses,labelAlignment:e.labelAlignment,recordChange:function(b,c){var d;"nav"!==a&&(d=m.recordView("getRecord"),d&&(a="rv",h(d),a=null))}}),q!==X&&(o=g("#"+c,t).find(".tb"),p.add([{name:"move-up",labelKey:"APEX.RV.MOVE_UP",hide:!0,action:function(){var a,b=null,c=k.grid("getSelection"),d=k.grid("getSelectedRecords");c[0].prev().length&&(a=c[0].prev().prev(),a.length&&(b=k.grid("getRecords",[a])[0]),j.moveRecords(d,null,b),k.grid("setSelectedRecords",d))}},{name:"move-down",labelKey:"APEX.RV.MOVE_DOWN",hide:!0,action:function(){var a,b=null,c=k.grid("getSelection"),d=k.grid("getSelectedRecords");a=c[c.length-1].next(),a.length&&(b=k.grid("getRecords",[a])[0],j.moveRecords(d,null,b),k.grid("setSelectedRecords",d))}}]),b=[{type:"BUTTON",iconOnly:!0,icon:"icon-plus",action:ga},{type:"BUTTON",iconOnly:!0,icon:"icon-copy",action:ba},{type:"BUTTON",iconOnly:!0,icon:"icon-minus",action:aa},{type:"BUTTON",iconOnly:!0,icon:"icon-up-chevron",action:"move-up"},{type:"BUTTON",iconOnly:!0,icon:"icon-down-chevron",action:"move-down"}],p[s?V:W](aa),p[s?V:W](ga),p[s&&e.includeCopy?V:W](ba),p[u?V:W]("move-up"),p[u?V:W]("move-down"),o.toolbar({actionsContext:p,data:[{align:"start",controls:b}]})),q===Y)if(e.useList){if(l=g("#"+c,t).find(".nav"),i=e.recordTemplate,!i){if(!e.labelColumn)throw new Error("Option recordTemplate or labelColumn is required");i="<li data-id='&APEX$ROW_ID.' class='&APEX$ROW_STATE_CLASSES.'>",e.iconClassColumn&&(i+="<span class='a-IconList-icon'><span class='&"+e.iconClassColumn+".'></span></span>"),e.enabledCheckbox&&(i+="<span class='ro-checkbox &\"enabledClass\".'></span><span class='u-vh'>&\"enabledText\".</span>"),i+="<span class='a-IconList-label'>&"+e.labelColumn+".</span></li>"}l.tableModelView({modelName:e.modelName,columns:[r],hasSize:!0,footer:!1,pagination:{scroll:!0},useIconList:!0,recordTemplate:i,collectionClasses:e.collectionClasses||"a-RVDialog-list",selectionChange:function(){var b,c;"rv"!==a&&(c=l.tableModelView("getSelectedRecords")[0],c&&(a="nav",b=j.indexOf(c),m.recordView(U,"recordOffset",b),a=null))}}),v=l.data("apex-tableModelView")}else k=g("#"+c,t).find(".nav"),k.grid({modelName:e.modelName,noDataMessage:e.noDataMessage,columns:[r],editable:!1,hasSize:!0,footer:!1,pagination:{scroll:!0},reorderColumns:!1,columnSort:!1,hideDeletedRows:!0,selectionChange:function(){var b,c;"rv"!==a&&(c=k.grid("getSelectedRecords")[0],c&&(a="nav",b=j.indexOf(c),m.recordView(U,"recordOffset",b),a=null))}}),v=k.data("apex-grid");else q===Z&&(g("#"+c,t).find(".nav").addClass("a-RVDialog-scroll").html("<div class='a-RVDialog-tree'></div>"),n=g("#"+c,t).find(".a-RVDialog-tree"),d={showRoot:!0,collapsibleRoot:!0,expandRoot:!0,getNodeAdapter:function(){return j},selectionChange:function(){var b,c,d;"rv"!==a&&(c=n.treeView("getSelectedNodes")[0],c&&(d=j.parent(c),a="nav",d!==m.recordView(U,"recordParent")&&m.recordView(U,"recordParent",d),b=j.indexOf(c),m.recordView(U,"recordOffset",b),a=null))}},n.treeView(d),g.apex.treeView.treeModelListener(e.modelName,n),v=n.data("apex-treeView"));this.initDone=!1},open:function(){var a,b=null;o&&o.toolbar("refresh"),k&&k.grid("refreshColumns"),i.resize(),e.init&&!this.initDone&&e.init.call(this,j,k||l||n||null,m,o),this.initDone=!0,e.load&&(b=e.load.call(this,j)),q!==X&&(a=b?j.getRecord(b):m.recordView("getRecord"),a&&setTimeout(function(){h(a)},10)),setTimeout(function(){m.recordView("focus")},100)},close:function(){q===Y?j.setData([],0):j.setData(null)},resize:function(){var b=B.width(),c=B.height();p?B.find("section").height(c).width(b).resize():(B.find("section,main,aside").height(c),b-=B.find("aside").outerWidth()||0,B.find("main").width(b),m.width(b),m.height(c).recordView("resize"),b=B.find("aside").width(),c-=B.find(".tb").outerHeight(),k?k.width(b).height(c).grid("resize"):n&&n.width(b).height(c),a.setOuterWidth(B.find(".tb"),b))}}),s?i.buttons=[{text:d.getMessage("APEX.DIALOG.CANCEL"),click:function(){m.recordView("setEditMode",!1),z(this).dialog("close")}},{text:D||d.getMessage("APEX.DIALOG.SAVE"),"class":"ui-button--hot",click:function(){function a(a,b,c){j.setValidity("error",a,b,c)}function b(a,b){j.setValidity("valid",a,b)}var c="",d=!0;m.recordView("setEditMode",!1),e.validate&&(d=e.validate.call(this,j,b,a),"string"==typeof d&&(c=d+"\n\n",d=!1)),d&&!j.hasErrors()?(e.store&&e.store.call(this,j),z(this).dialog("close")):(m.recordView("refresh"),c+=apex.lang.getMessage("APEX.CORRECT_ERRORS"),apex.message.alert(c,function(){var a,b=j.getErrors()[0];if(b){for(a in b.fields)if(b.fields[a].error)break;setTimeout(function(){m.recordView("gotoField",j.getRecordId(b.record),a)},1)}}))}}]:i.buttons=[{text:D||d.getMessage("APEX.DIALOG.OK"),"class":"ui-button--hot",click:function(){z(this).dialog("close")}}],i.dialogHelp&&i.buttons.unshift({text:d.getMessage("APEX.DIALOG.HELP"),"class":"ui-button-help",click:function(){var a=i.dialogHelp;d.loadMessagesIfNeeded([a.titleKey,a.helpTextKey],function(){var b={title:a.title,helpText:a.helpText};a.titleKey&&(b.title=d.getMessage(a.titleKey)),a.helpTextKey&&(b.helpText=d.getMessage(a.helpTextKey)),apex.theme.popupFieldHelp(b)})}}),i.titleKey&&(i.title=d.getMessage(i.titleKey),delete i.titleKey),B.html(E.toString()).dialog(i).on("dialogopen",function(){apex.navigation.beginFreezeScroll()}).on("dialogresize",function(){z(this).closest(".ui-dialog").css("position","fixed")}).on("dialogclose",function(){apex.navigation.endFreezeScroll()}),B.on("keydown",function(a){var b;a.which===ja.ENTER&&"INPUT"===a.target.nodeName&&(e.defaultButton&&(b=B.parent().find(".ui-button--hot").eq(0).focus(),setTimeout(function(){b.click()},50)),a.preventDefault())}),e.useSplitter&&q!==X&&g.apex.splitter&&(w=e.splitterPosition||200,e.persistSplitter&&(x=apex.storage.getScopedSessionStorage({prefix:"ORA_WWV_apex.MED_"+e.persistSplitter,useAppId:!0}),w=parseInt(x.getItem("splitterPosition")||w,10)),p=B.find(".a-IGDialog-body").splitter({position:w,collapsed:!1,minSize:120,orientation:"horizontal",positionedFrom:"begin",noCollapse:!0,change:function(a,b){x&&x.setItem("splitterPosition",b.lastPosition-b.lastPosition%1+"")}}),B.on("resize",function(b){var c,d,e,f,h=g(b.target);c=h.height(),d=h.width(),e=h.children(".resize").filter(R),e.length>0&&(h.children(":not(.resize)").filter(R).each(function(){f=g(this).css("position"),"fixed"!==f&&"absolute"!==f&&(c-=g(this).outerHeight(!0))}),c=Math.floor(c/e.length),e.each(function(){var b=g(this);a.setOuterHeight(b,c),a.setOuterWidth(b,d),b.filter(R).trigger("resize")})),b.stopPropagation()}));var F=B.data("ui-dialog"),G=F._destroy;return F._destroy=function(){G.call(F),b.destroy(e.modelName)},B}}(apex.util,apex.model,apex.debug,apex.lang,apex.item,apex.actions,apex.jQuery);
!function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";function m(a){return e.getMessage(a)}function n(a){return e.getMessage("APEX.IG."+a)}function o(){var b,c=[];for(b=0;b<Je.length;b++)c.push(a.extend(!0,{},Je[b]));return c.toolbarFind=Je.toolbarFind,c.toolbarRemove=Je.toolbarRemove,c.toolbarInsertAfter=Je.toolbarInsertAfter,c}function p(a,b,c,d){function e(a){var f,g;for(f=0;f<a.length;f++){if(g=a[f],g.id===b||g.action===b)return c&&a.splice(f,1),d&&a.splice(f+1,0,d),g;if("subMenu"===g.type&&(g=e(g.menu.items)))return g}return null}var f,g,h,i,j,k,l=a;for(f=0;f<l.length;f++){if(k=l[f],k.id===b)return c&&l.splice(f,1),d&&l.splice(f+1,0,d),k;if(h=k.controls)for(g=0;g<h.length;g++){if(i=h[g],i.id===b||i.action===b)return c&&h.splice(g,1),d&&h.splice(g+1,0,d),i;if(i.menu&&(j=e(i.menu.items)))return j}}return null}function q(a){return{label:a||"ENABLED",alignment:Xb,defaultValue:!0,columnCssClasses:xb,cellTemplate:Jb,width:80,noStretch:!0,seq:10}}function r(a,b){a.recordView("fieldElement",b).hide()}function s(a,b){a.recordView("fieldElement",b).show()}function t(a){return new Date(parseInt(a.substr(0,4),10),parseInt(a.substr(4,2),10)-1,parseInt(a.substr(6,2),10),parseInt(a.substr(8,2),10),parseInt(a.substr(10,2),10),parseInt(a.substr(12,2),10))}function u(a){return("000"+a.getFullYear()).substr(-4)+("0"+(a.getMonth()+1)).substr(-2)+("0"+a.getDate()).substr(-2)+("0"+a.getHours()).substr(-2)+("0"+a.getMinutes()).substr(-2)+("0"+a.getSeconds()).substr(-2)}function v(a,b,c){a.splice(c,0,a.splice(b,1)[0])}function w(a){var b,c,d=[];for(b=0;b<a.length;b++)c=a[b].replace(/^\s+|\s+$/gm,""),""!==c&&d.indexOf(c)===-1&&d.push(c);return d}function x(a){var b=a;switch(a){case nc:b="group-by";break;case oc:b="saved-report";break;case pc:b="inactive-settings";break;case qc:b="invalid-settings";break;case Cc:b="control-break";break;case Ec:b="save-report";break;case Dc:b="save-report"}return b}function y(a,b,c,d,e,f){var g;for(f||b.push({value:e,label:f}),g=0;g<a.length;g++)b.push({value:a[g][c],label:a[g][d]})}function z(b,c){var d;if(!a.isEmptyObject(c))for(d in c)c.hasOwnProperty(d)&&b.attr("data-"+d,c[d])}function A(b,c){var d,e=a.extend({id:"",type:Mb,value:"",maxChars:"",title:"",ariaDescribedBy:"",name:"",size:"",placeholder:"",readonly:!1,checked:!1,disabled:!1,required:!1,cssClasses:[],data:{},attributes:{}},c),f=e.cssClasses,g=e.attributes;if(b.markup("<input").attr("id",e.id).attr("type",e.type).attr("value",e.value).optionalAttr("maxlength",e.maxChars).optionalAttr("title",e.title).optionalAttr(Gb,e.ariaDescribedBy).optionalAttr("name",e.name).optionalAttr("size",e.size).optionalAttr("placeholder",e.placeholder).optionalBoolAttr("readonly",e.readonly).optionalBoolAttr(hc,e.checked).optionalBoolAttr(gc,e.disabled).optionalBoolAttr(fc,e.required),f.length>0&&b.attr(ad,a.isArray(f)?f.join(" "):f),z(b,e.data),!a.isEmptyObject(g))for(d in g)g.hasOwnProperty(d)&&b.attr(d,g[d]);b.markup(" />")}function B(b,c){var d=a.extend({cssClasses:_a,maxChars:"4000"},c);A(b,d)}function C(b,c){var d,e,f=a.extend({id:"",iconOnly:!1,cssClasses:"",options:[]},c);for(b.markup("<fieldset ").attr(ad,ea).attr("id",f.id+"_fieldset").markup(">"),b.markup("<ul ").attr(ad,ea+" "+f.cssClasses).attr("id",f.id+"_list").markup(">"),d=0;d<f.options.length;d++)e=f.options[d],b.markup("<li").attr("data-value",e.value).attr(ad,fa+(e.isSelected?" "+ub:"")).markup(">").markup("<span ").attr(ad,ga).attr(Hb,e.label||e.value).attr("title",e.label||e.value).markup(">").markup("<span ").attr(ad,ha+" "+mb+" "+e.iconCssClasses).attr(Fb,!0).markup("></span>"),f.iconOnly===!1&&b.markup("<span ").attr(ad,ia).markup(">").content(e.label||e.value).markup("</span>"),b.markup("</span>").markup("</li>");b.markup("</ul>"),b.markup("<input ").attr("type","hidden").attr(Fb,!0).attr("id",f.id).markup(">"),b.markup("</fieldset>")}function D(c,d){function e(a){f.iconList("setSelection",f.find('li[data-value="'+b.escapeHTMLAttr(a)+'"]'),!1)}var f=a("#"+c+"_list");f.iconList({multiple:!1,selectionChange:function(){a("#"+c).val(a(this).iconList("getSelectionValues")).change()}}),e(d),a("#"+c).change(function(){e(a("#"+c).val())})}function E(b,c){var d,e,f,g,h=a.extend({id:"",buttonClass:"",label:"",icon:"",iconOnly:!1,iconPosition:Lb,tabindex:"",attributes:{},data:{}},c);if(d=fb+(c.buttonClass?" "+c.buttonClass:""),e=mb+(c.icon?" "+c.icon:""),f=c.icon&&!c.iconOnly,b.markup("<button type='button'").optionalAttr("id",h.id).optionalAttr("tabindex",h.tabindex).attr(ad,d),c.iconOnly&&h.label&&b.attr("title",h.label).attr(Hb,h.label),!a.isEmptyObject(h.attributes))for(g in h.attributes)h.attributes.hasOwnProperty(g)&&b.attr(g,h.attributes[g]);z(b,h.data),b.markup(">"),f&&h.iconPosition===Kb&&b.markup("<span").attr(Fb,!0).attr(ad,e+" "+nb).markup("></span>"),c.iconOnly?b.markup("<span").attr(Fb,!0).attr(ad,e).markup("></span>"):h.label&&b.markup("<span").attr(ad,hb).markup(">").content(h.label).markup("</span>"),f&&h.iconPosition===Lb&&b.markup("<span").attr(Fb,!0).attr(ad,e+" "+ob).markup("></span>"),b.markup("</button>")}function F(b,c){b.markup("<fieldset ").attr(ad,"color_picker").attr("id",c.id+"_fieldset").markup(">"),b.markup("<span ").attr(ad,db).attr("style","height: 24px").markup(">"),B(b,a.extend({cssClasses:"color_picker "},c)),E(b,{id:c.id+"_PICKER",buttonClass:ib+" "+jb+" "+yb,label:e.formatMessage("APEX.IG.OPEN_COLORPICKER",c.itemLabel),icon:"icon-color-picker",iconOnly:!0,attributes:{"aria-haspopup":!0,"aria-expanded":!1}}),c.colorMenuId&&E(b,{id:c.id+"_COLORS",buttonClass:ib+" "+jb+" "+yb,label:n("COLORS"),attributes:{"data-menu":c.colorMenuId,"aria-haspopup":!0,"aria-expanded":!1}}),b.markup("</span>"),b.markup("</fieldset>")}function G(b,c){A(b,a.extend({type:Qb},c))}function H(b,c){var d=a.extend({id:"",cssClasses:bb,cols:"30",rows:"4",name:"",placeholder:"",disabled:!1,readonly:!1,required:!1,toolbar:!1,style:"resize: both;",wrap:"virtual"},c);d.toolbar&&(b.markup("<fieldset ").attr("id",c.id+"_fieldset").markup(">"),b.markup("<div").attr("id",d.id+"_toolbar").markup("></div>")),b.markup("<textarea").attr("id",d.id).attr(ad,d.cssClasses).attr("cols",d.cols).attr("rows",d.rows).optionalAttr("name",d.name).optionalAttr("placeholder",d.placeholder).optionalAttr("style",d.style).optionalAttr("wrap",d.wrap).optionalBoolAttr(gc,d.disabled).optionalBoolAttr("readonly",d.readonly).optionalBoolAttr(fc,d.required).markup(">").markup("</textarea>"),d.toolbar&&b.markup("</fieldset>")}function I(b,c){var d=a.extend({cssClasses:"",text:"",data:{}},c);b.markup("<a href='#'").attr(ad,d.cssClasses),z(b,d.data),b.markup(">").content(d.text).markup("</a>")}function J(b,c){var d,e=a.extend({cssClasses:$a,labelFor:"",label:"",labelHidden:!1,labelTextHidden:!1},c);d=e.cssClasses,e.labelHidden&&(d+=" "+Ab),b.markup("<label").attr(ad,d).attr("for",e.labelFor).markup(">"),e.labelTextHidden?b.markup("<span").attr(ad,Ab).markup(">").content(e.label).markup("</span>"):b.content(e.label),b.markup("</label>")}function K(b,c){A(b,a.extend({type:"radio"},c))}function L(b,c){var d,e,f,g=a.extend({id:"",label:"",name:"",radios:[]},c);for(b.markup("<div role='group'").attr("id",g.id).attr(Ib,"id1").markup(">"),d=0;d<g.radios.length;d++)e=g.radios[d],f=g.id+"_"+d,K(b,{name:g.name,id:f,value:e.value,checked:e.checked,cssClasses:ca}),J(b,{labelFor:f,cssClasses:da,label:e.label});b.markup("</div>")}function M(b,c){var d,e,f=a.extend({id:"",cssClasses:ab,size:"1",title:"",required:!1,options:[]},c);for(b.markup("<select").optionalAttr("id",f.id).attr(ad,f.cssClasses).attr("size",f.size).optionalAttr("title",f.title).optionalBoolAttr(fc,f.required).markup(">"),d=0;d<f.options.length;d++)e=f.options[d],b.markup("<option").attr("value",e.value).optionalBoolAttr("selected",e.isSelected).markup(">").content(e.label||e.value).markup("</option>");b.markup("</select>")}function N(b){var c;for(a.isArray(b)||(b=[b]),c=0;c<b.length;c++)j(b[c][0]).show()}function O(b){var c;for(a.isArray(b)||(b=[b]),c=0;c<b.length;c++)j(b[c][0]).hide()}function P(a,b){a.closest(Za).find("."+$a).text(m(b))}function Q(b,c){var d,e;for(a.isArray(b)||(b=[b]),d=0;d<b.length;d++)e=b[d],e.prop(fc,c).closest(Za).toggleClass("is-required",c)}function R(a,c){var d,f,g,j="apexDialogPromptInputId",k=b.htmlBuilder(),l=b.getTopApex().jQuery;k.markup("<div class='u-Form u-Form--labelsAbove u-Form--stretchInputs'>").markup("<div class='u-Form-fieldContainer'><div class='u-Form-labelContainer  u-tS'><span class='u-Form-label'>"),J(k,{labelFor:j,label:m(a.labelKey)}),k.markup("</span></div><div class='u-Form-inputContainer'>"),B(k,{id:j,value:a.value||"",required:!!a.required}),k.markup("</div></div></div>"),d=l(k.toString()),g={title:m(a.titleKey),dialogClass:"",confirm:!0,defaultButton:!0,beforeClose:function(){f=l("#"+j).val()},callback:function(a){var b=!1;a&&(b=f),c(b)},open:function(){l("#"+j).focus()}},a.okLabelKey&&(g.okLabelKey=a.okLabelKey),a.helpKey&&(g.extraButtons=[{text:m("APEX.DIALOG.HELP"),CLASS:"ui-button-help",click:function(){e.loadMessagesIfNeeded([a.helpKey,a.helpTitleKey],function(){h.popupFieldHelp({title:m(a.helpTitleKey),helpText:m(a.helpKey)})})}}]),i.showDialog(d,g)}function S(a){Le.push(a)}var T="a-IG",U="."+T,V=T+"-header",W="."+V,X=T+"--noToolbar",Y=T+"-body",Z="."+Y,$=T+"-content",_=$+"Container",aa="."+_,ba="a-IGDialog",ca=ba+"-input-checkbox",da=ba+"-label-checkbox",ea=ba+"-iconList",fa=ea+"-item",ga=ea+"-link",ha=ea+"-icon",ia=ea+"-label",ja=T+"-controls",ka=ja+"-item",la=ka+"--",ma=ja+"-cell",na=ma+"--label",oa=ma+"--remove",pa=ja+"Checkbox",qa=pa+"Label",ra=ja+"Icon",sa=ja+"Label",ta=ja+"Container",ua="."+ta,va="a-IG-reportSummary",wa=va+"Container",xa=va+"-item",ya=va+"-item--",za=va+"-label",Aa=va+"-icon",Ba=va+"-count",Ca=va+"-value",Da=T+"-button",Ea=Da+"--controls",Fa=Da+"--remove",Ga="icon-ig-",Ha=T+"-gridView",Ia=T+"-iconView",Ja=T+"-detailView",Ka=T+"-chartView",La=T+"-recordView",Ma="a-IRR-sortWidget",Na=Ma+"-actions",Oa=Na+"-item",Pa=Ma+"-button",Qa=Ma+"-search",Ra=Ma+"-searchLabel",Sa=Ma+"-searchField",Ta=Ma+"-rows",Ua=Ma+"-row",Va="u-Form",Wa=Va+"--labelsAbove",Xa=Va+"--stretchInputs",Ya=Va+"-fieldContainer",Za="."+Ya,$a=Va+"-label",_a="apex-item-text",ab="apex-item-select",bb="apex-item-textarea",cb="a-Combobox",db="a-Combobox-wrapper",eb="hasDatepicker",fb="a-Button",gb=fb+"--noUI",hb=fb+"-label",ib=fb+"--noLabel",jb=fb+"--withIcon",kb=fb+"--calendar",lb=fb+"--iconTextButton",mb="a-Icon",nb=mb+"--left",ob=mb+"--right",pb="icon-remove",qb="a-MediaBlock",rb=qb+"-graphic",sb=qb+"-content",tb="is-active",ub="is-selected",vb="is-checked",wb="is-error",xb="js-colCheckbox",yb="js-menuButton",zb="."+xb,Ab="u-VisuallyHidden",Bb="u-textLower",Cb="u-textUpper",Db="has-button",Eb="aria-expanded",Fb="aria-hidden",Gb="aria-describedby",Hb="aria-label",Ib="aria-labelledby",Jb="<span class='ro-checkbox &\"enabledClass\".'></span><span class='u-vh'>&\"enabledText\".</span>",Kb="left",Lb="right",Mb="text",Nb="select",Ob="colorpicker",Pb="textarea",Qb="checkbox",Rb="radios",Sb="iconList",Tb="row",Ub="column",Vb="complex",Wb="start",Xb="center",Yb="destroy",Zb="delete",$b="refresh",_b="resize",ac="show",bc="hide",cc="expand",dc="expanded",ec="collapsed",fc="required",gc="disabled",hc="checked",ic="option",jc="grid",kc="icon",lc="detail",mc="chart",nc="groupby",oc="savedReport",pc="inactiveSettings",qc="invalidSettings",rc="primary",sc="alternative",tc="private",uc="public",vc="named",wc="columns",xc="filter",yc="highlight",zc="flashback",Ac="sort",Bc="aggregate",Cc="controlBreak",Dc="editReport",Ec="saveAsReport",Fc="download",Gc="asc",Hc="desc",Ic="first",Jc="last",Kc="none",Lc="scroll",Mc="set",Nc="progressive",Oc="i",Pc="u",Qc="d",Rc="region",Sc="page",Tc="~",Uc="Y",Vc="N",Wc="_meta",Xc="_vc",Yc="plain",Zc="label",$c="error",_c="valid",ad="class",bd="value",cd="action",dd="toggle",ed="radioGroup",fd={type:"separator"},gd="BUTTON",hd="MENU",id="all",jd="past",kd="future",ld="EQ",md="NEQ",nd="LT",od="LTE",pd="GT",qd="GTE",rd="LIKE",sd="NLIKE",td="N",ud="NN",vd="C",wd="NC",xd="IN",yd="NIN",zd=";",Ad="BETWEEN",Bd="NBETWEEN",Cd="LAST",Dd="NLAST",Ed="NEXT",Fd="NNEXT",Gd="REGEXP",Hd="S",Id="NS",Jd="OTEXT",Kd="CASE_INSENSITIVE",Ld="MI",Md="H",Nd="D",Od="W",Pd="M",Qd="Y",Rd="MIXED",Sd="VARCHAR2",Td="NUMBER",Ud="DATE",Vd="CLOB",Wd="TIMESTAMP",Xd="TIMESTAMP_TZ",Yd="TIMESTAMP_LTZ",Zd="area",$d="bar",_d="bubble",ae="donut",be="funnel",ce="line",de="lineWithArea",ee="pie",fe="polar",ge="radar",he="range",ie="scatter",je="stock",ke="vertical",le="horizontal",me="on",ne="off",oe="auto",pe="cartesian",qe=42,re="VALUE_REQUIRED",se="INVALID_VALUE",te="SELECT",ue=[{value:"#FFFF99",label:"APEX.IG.COLOR_YELLOW"},{value:"#99FF99",label:"APEX.IG.COLOR_GREEN"},{value:"#99CCFF",label:"APEX.IG.COLOR_BLUE"},{value:"#FFDD44",label:"APEX.IG.COLOR_ORANGE"},{value:"#FF7755",label:"APEX.IG.COLOR_RED"}],ve={EQ:"EQUALS",NEQ:"NOT_EQUALS",LT:"LESS_THAN",LTE:"LESS_THAN_OR_EQUALS",GT:"GREATER_THAN",GTE:"GREATER_THAN_OR_EQUALS",LIKE:"LIKE",NLIKE:"NOT_LIKE",N:"IS_NULL",NN:"IS_NOT_NULL",C:"CONTAINS",NC:"DOES_NOT_CONTAIN",IN:"IN",NIN:"NOT_IN",BETWEEN:"BETWEEN",NBETWEEN:"NOT_BETWEEN",LAST:"IN_THE_LAST",NLAST:"NOT_IN_THE_LAST",NEXT:"IN_THE_NEXT",NNEXT:"NOT_IN_THE_NEXT",REGEXP:"MATCHES_REGULAR_EXPRESSION",S:"STARTS_WITH",NS:"DOES_NOT_START_WITH",OTEXT:"ORACLE_TEXT"},we={SUM:"SUM",AVG:"AVG",CNT:"COUNT",CNT_DIST:"COUNT_DISTINCT",APPR_CNT_DIST:"APPROX_COUNT_DISTINCT",MIN:"MIN",MAX:"MAX",MEDIAN:"MEDIAN",LISTAGG:"LISTAGG"},xe={filter:n("FILTER"),chart:n("CHART"),groupby:n("GROUP_BY"),controlBreak:n("CONTROL_BREAK"),highlight:n("HIGHLIGHT"),aggregate:n("AGGREGATE"),flashback:n("FLASHBACK")},ye={MI:"MINUTE",H:"HOUR",D:"DAY",W:"WEEK",M:"MONTH",Y:"YEAR"},ze={LABEL:"LABEL",VALUE:"VALUE",X:"X",Y:"Y",Z:"Z",TARGET:"TARGET",HIGH:"HIGH",LOW:"LOW"},Ae=([{value:"DD-MON-RR",label:"12-JAN-16"},{value:"DD-MON-YYYY",label:"12-JAN-2016"},{value:"DD-MON",label:"12-JAN"},{value:"RR-MON-DD",label:"16-JAN-12"},{value:"YYYY-MM-DD",label:"2016-01-12"},{value:"fmDay, fmDD fmMonth, YYYY",label:m("APEX.IG_FORMAT_SAMPLE_1")},{value:"DD-MON-YYYY HH24:MI",label:"12-JAN-2016 14:30"},{value:"DD-MON-YYYY HH24:MI:SS",label:"12-JAN-2016 14:30:00"},{value:"DD-MON-YYYY HH:MIPM",label:"12-JAN-2016 02:30PM"},{value:"Month",label:m("APEX.IG_FORMAT_SAMPLE_2")},{value:"DD-MON-YYYY HH24:MI",label:"12-JAN-2016 14:30"},{value:"DD-MON-YYYY HH24.MI.SSXFF",label:"12-JAN-2016 14.30.12.867530900"},{value:"DD-MON-YYYY HH:MI:SSXFF PM",label:"12-JAN-2016 02:30:12.867530900 PM"},{value:"DD-MON-YYYY HH24:MI TZR",label:"12-JAN-2016 14:30 -07:00"},{value:"DD-MON-YYYY HH24.MI.SSXFF TZR",label:"12-JAN-2016 14.30.12.867530900 -07:00"},{value:"DD-MON-YYYY HH.MI.SSXFF PM TZR",label:"12-JAN-2016 02.30.12.867530900 PM -07:00"},{value:"SINCE",label:m("APEX.IG_FORMAT_SAMPLE_3")},{value:"SINCE_SHORT",label:m("APEX.IG_FORMAT_SAMPLE_4")}],[{value:"$1,002.54",label:{style:"currency",currency:"USD",currencyDisplay:"symbol"}},{value:"1,002.54",label:{style:"decimal",maximumFractionDigits:2}},{value:"1,002.5400",label:{style:"decimal",maximumFractionDigits:4}},{value:"1,002",label:{style:"decimal",maximumFractionDigits:0}},{value:"1,002.54-",label:{style:"decimal",maximumFractionDigits:2}},{value:"-1,002.54",label:{style:"decimal",maximumFractionDigits:2}},{value:"<1,002.54>",label:{style:"decimal",maximumFractionDigits:2}}]),Be=[{value:"DD-MON-RR",label:{pattern:"dd-MMM-yy"}},{value:"DD-MON-YYYY",label:{pattern:"dd-MMM-yyyy"}},{value:"DD-MON",label:{pattern:"dd-MMM"}},{value:"RR-MON-DD",label:{pattern:"yy-MMM-dd"}},{value:"YYYY-MM-DD",label:{pattern:"yyyy-MMM-dd"}},{value:"fmDay, fmDD fmMonth, YYYY",label:{formatType:"date",dateFormat:"full"}},{value:"DD-MON-YYYY HH24:MI",label:{pattern:"dd-MMM-yyyy HH:mm"}},{value:"DD-MON-YYYY HH24:MI:SS",label:{pattern:"dd-MMM-yyyy HH:mm:ss"}},{value:"DD-MON-YYYY HH:MIPM",label:{pattern:"dd-MMM-yyyy hh:mm a"}},{value:"Month",label:{month:"long"}},{value:"DD-MON-YYYY HH24.MI.SSXFF",label:{pattern:"dd-MMM-yyyy HH:mm:ss"}},{value:"DD-MON-YYYY HH:MI:SSXFF PM",label:{pattern:"dd-MMM-yyyy hh:mm:ss a"}},{value:"DD-MON-YYYY HH24:MI TZR",label:{pattern:"dd-MMM-yyyy HH:mm"}},{value:"DD-MON-YYYY HH24.MI.SSXFF TZR",label:{pattern:"dd-MMM-yyyy HH:mm:ss"}},{value:"DD-MON-YYYY HH.MI.SSXFF PM TZR",label:{pattern:"dd-MMM-yyyy hh:mm:ss a"}}],Ce="selectionChange",De="viewChange",Ee="reportChange",Fe="reportSettingsChange",Ge="viewModelCreate",He="save",Ie="modeChange",Je=[{id:"search",groupTogether:!0,controls:[{type:hd,id:"column_filter_button",labelKey:"APEX.IG.SELECT_COLUMNS_TO_SEARCH",icon:"icon-search",iconOnly:!0,menu:{items:[{type:dd,action:"search-case-sensitive"},fd,{type:ed,action:"filter-column"}]}},{type:"TEXT",id:"search_field",enterAction:"search"},{type:gd,action:"search"}]},{id:"reports",controls:[{type:"SELECT",action:"change-report"}]},{id:"views",controls:[{type:"RADIO_GROUP",labelKey:"APEX.IG.VIEW",action:"change-view"}]},{id:"actions1",controls:[{type:hd,id:"actions_button",labelKey:"APEX.IG.ACTIONS",menu:{items:[{type:cd,action:"show-columns-dialog"},fd,{type:cd,action:"show-filter-dialog"},{type:"subMenu",id:"data_submenu",labelKey:"APEX.IG.DATA",icon:"icon-ig-data",menu:{items:[{type:cd,action:"show-sort-dialog"},{type:cd,action:"show-aggregate-dialog"},{type:cd,action:"refresh"},{type:cd,action:"show-flashback-dialog"}]}},{type:"subMenu",id:"format_submenu",labelKey:"APEX.IG.FORMAT",icon:"icon-ig-format",menu:{items:[{type:cd,action:"show-control-break-dialog"},{type:cd,action:"show-highlight-dialog"},{type:dd,action:"stretch-columns"},{type:"subMenu",labelKey:"APEX.IG.ROWS_PER_PAGE",hide:!0,id:"rows",icon:"icon-ig-rows",menu:{items:[{type:ed,action:"change-rows-per-page"}]}}]}},{type:"subMenu",id:"selection_submenu",labelKey:"APEX.IG.SELECTION",icon:"icon-ig-selection",menu:{items:[{type:dd,action:"selection-mode"},fd,{type:cd,action:"selection-copy",accelerator:"Ctrl+C"},fd]}},fd,{type:cd,action:"chart-view"},fd,{type:"subMenu",id:"save_report_submenu",labelKey:"APEX.IG.REPORT",icon:"icon-irr-saved-report",menu:{items:[{type:cd,action:"save-report"},{type:cd,action:"show-save-report-as-dialog"},{type:cd,action:"show-edit-report-dialog"},fd,{type:cd,action:"delete-report"},fd,{type:cd,action:"reset-report"}]}},fd,{type:cd,action:"show-download-dialog"},fd,{type:cd,action:"show-help-dialog"}]}}]},{id:"actions2",controls:[{type:"TOGGLE",action:"edit"},{type:gd,hot:!0,action:"save"}]},{id:"actions3",controls:[{type:gd,action:"selection-add-row"}]},{id:"actions4",align:"end",controls:[{type:gd,action:"reset-report",labelKey:"APEX.IG.RESET",iconBeforeLabel:!0}]}];Je.toolbarInsertAfter=function(a,b){p(this,a,!1,b)},Je.toolbarRemove=function(a){return p(this,a,!0)},Je.toolbarFind=function(a){return p(this,a,!1)};var Ke={_allowInteraction:function(b){return a(b.target).closest("."+Ma).length>0||this._super(b)}};a.ui.dialog&&(a.widget("ui.dialog",a.ui.dialog,Ke),a.widget("apex.popup",a.apex.popup,Ke)),a.widget("apex.interactiveGrid",{version:"19.1",widgetEventPrefix:"interactivegrid",options:{config:{toolbarData:null,modelInstanceId:null,initActions:null,columns:[],ajaxColumns:"",regionId:"",regionStaticId:"",columnGroups:[],ajaxIdentifier:"",itemsToSubmit:"",editable:!1,submitSelectedRows:!1,parentRegionStaticId:null,trackParentSelection:!0,lazyLoading:!1,filter:{row:!0,complex:!0,isRequired:!1,maxRowCount:null,oracleText:!1},appearance:{showNullValue:"",useFixedRowHeight:!0},pagination:{type:Lc,showTotalRowCount:!1},text:{noDataFound:n("NO_DATA_FOUND"),moreDataFound:"",addRowButton:n("ADD_ROW"),help:""},toolbar:{reset:!0,save:!0,columnSelection:!0,searchField:!0,savedReports:!0,editing:!0,addRow:!0,actionMenu:!0},reportSettingsArea:{disabled:!1},features:{saveReport:{publicReportCs:"",isDeveloper:!1,authorizations:[]},download:!1,filter:!0,flashback:!0},initialSelection:!0,headingFixedTo:Sc,maxHeight:null,views:{icon:!1,detail:!1,grid:{disabled:!1,features:{reorderColumns:!0,resizeColumns:!0,sort:!0,stretchColumns:null,highlight:!0,controlBreak:!0,aggregate:!0,changeRowsPerPage:!0,cellRangeActions:!0,singleRowView:!0,gridView:!0,rowSelector:{multiSelect:!0,selectAll:!0,hideControl:!1}}},chart:{disabled:!1,features:{}}},defaultModelOptions:{},defaultGridViewOptions:{},defaultIconViewOptions:{},defaultDetailViewOptions:{},defaultSingleRowOptions:{}},savedReports:[],data:null,selectionChange:null,viewChange:null,reportChange:null,reportSettingsChange:null,viewModelCreate:null,save:null,modeChange:null},_create:function(){var d,e=this,h=this.element,i=this.options,k=a(U).length;if(!i.config)throw new Error("Missing required config option.");if(!i.savedReports)throw new Error("Missing required saved reports configuration.");if(this.idPrefix=h[0].id||"ig"+(k+1),this.viewsImpl={},this.columnMap={},this.baseModelColumns={},this.primaryKeyColumns=[],this.parentColumnNames=[],this.parentItemValues=[],this.parentModel="",this.parentRecordId=null,this.editMode=!1,this.currentSavedReportIdx="",this.toolbar$=null,this.currentFilterColumnId=null,this.searchCaseSensitive=!1,this.ignoreResizeHandler=!1,this.actions=f.createContext("InteractiveGrid",h[0]),this.reportSettingsSeq=1,this.modelReportSettingsSeq={},this.isRTL="rtl"===h.css("direction"),h.addClass(T),this._defaultIGConfig(),d=i.config,d.maxHeight&&h.height(d.maxHeight).css("overflow","hidden"),d.toolbar&&!d.toolbarData&&(d.toolbarData=o()),this._defaultColumns(),this._createBaseColumnMap(),this._defaultSavedReports(),this._registerIGViews(),this._renderIG(),this._addActions(this.actions),d.initActions&&d.initActions(this.actions),d.toolbar?(this._initToolbar(),this._updateToolbarElements()):h.addClass(X),this._forEachView(function(a,b){b.init(e)}),this._updateActions(),this.editableView=null,d.editable&&(this._forEachView(function(a,b){b.supports.edit&&(null===e.editableView?e.editableView=a:c.warn("Extra editable view ignored: "+a))}),null===this.editableView))throw new Error("No editable view for editable Interactive Grid");this.resize(),g.create(d.regionStaticId,{type:"InteractiveGrid",parentRegionId:d.parentRegionStaticId,widgetName:"interactiveGrid",refresh:function(){e.refresh()},focus:function(){e.focus()},widget:function(){return e.element},gotoError:function(a){e.gotoCell(null,a.record,a.column)},getSessionState:function(a){var b,c,d,f={beforeAsync:function(){var a=e._currentViewImpl();a.supports.edit&&a.lockActive&&a.lockActive()},afterAsync:function(){var a=e._currentViewImpl();a.supports.edit&&a.unlockActive&&a.unlockActive()}},g=[],h=[],i=e._currentViewImpl().getActiveRecordId();if(a)for(b=0;b<a.length;b++)c=e._getColumnByStaticId(a[b]),c?i&&h.push({n:c.name,v:j(a[b]).getValue()}):g.push(a[b]);return f.pageItems=g,h.length>0&&(d=e._currentViewImpl().model.getRecordMetadata(i),f.region=e._defaultAjaxRegionData({setSessionState:{values:h,"protected":d["protected"],salt:d.salt}})),f},alternateLoadingIndicator:function(a){var c,d=e._currentViewImpl();return d.internalIdentifier===jc&&!d.singleRowMode&&(c=d.view$.grid("getActiveCellFromColumnItem",a))?b.showSpinner(c,{spinnerClass:"u-Processing--cellRefresh"}):null}}),this._view(this._view(),{initialData:i.data,fetchData:d.lazyLoading}),d.headingFixedTo===Sc&&a(W,h).stickyWidget({stickToEnd:!0,bottom:function(){return h.offset().top+a(Z,h).outerHeight()-e._currentViewImpl().footerHeight()},toggleWidth:!0}),a("#"+d.regionStaticId).hasClass("resize")?h.addClass("resize").on("resize",function(){e.resize()}):l.onElementResize(h[0],function(){e.ignoreResizeHandler||e.resize()}),l.onVisibilityChange(h[0],function(a){a&&(l.updateResizeSensors(h[0]),e.actions.update("search"),e.resize())}),d.parentRegionStaticId&&d.trackParentSelection&&(this._forEachView(function(a,b){b.view$&&b.setNoDataMessage(n("SELECT_1_ROW_IN_MASTER"))}),a("#"+d.parentRegionStaticId+"_ig").on("interactivegridselectionchange.ig",b.debounce(function(a,b){var c=null;1===b.selectedRecords.length&&(c=b.selectedRecords[0]),e.setMasterRecord(b.model,c)},300)))},_setOption:function(b,c){var d=!1,e=this.options;"config"===b&&(c.modelInstanceId!==e.config.modelInstanceId&&(d=!0),c=a.extend(!0,e.config,c)),this._super(b,c),d&&this._setModelInstance(e.config.modelInstanceId)},_destroy:function(){var a=this.options.config;l.offElementResize(this.element[0]),this.element.removeClass(T+" "+X).empty(),f.removeContext("InteractiveGrid",this.element[0]),this._destroyAllModels(),this._forEachView(function(a,b){b.destroy()}),g.destroy(a.regionStaticId)},_isCurrentlyEditable:function(){var a=this.options.config,b=this._currentReportSettings().flashback,c=b&&b.isEnabled;return a.editable&&!c},_setModelInstance:function(a,b,c){var d,e=this,f=!0,g=this.options.config,h=g.text.noDataFound;if(this.parentRecordId=null,g.modelInstanceId=a,null===a&&(h=n("SELECT_1_ROW_IN_MASTER"),f=!1),g.parentRegionStaticId&&(this.parentRecordId=g.modelInstanceId,this.parentItemValues=[],b&&c))for(d=0;d<this.parentColumnNames.length;d++)this.parentItemValues.push({n:this.parentColumnNames[d],v:b.getValue(c,this.parentColumnNames[d])});this._forEachView(function(a,b){b.view$&&(b.setNoDataMessage(h),e._setModel({viewImpl:b,updateComponent:!0,fetchData:f}))})},_setInitialSelection:function(a){var b,c,d,e=this.options.config;b=this._currentViewImpl(),e.initialSelection&&b.supports.selection&&(d=b.getSelectedRecords(),d&&0!==d.length||(c=b.model.recordAt(a),c&&b.setSelectedRecords([c])))},_selectionChange:function(a){var b=this._currentViewImpl(),c=b.getSelectedRecords()||[];this._updateSelectionActions(),this._trigger(Ce,a,{selectedRecords:c,model:b.model})},_pageChange:function(a){var b=this;setTimeout(function(){b._setInitialSelection(a.offset)},1)},_registerIGViews:function(){var a,b,d,e=this.options.config,f=0;for(a=0;a<Le.length;a++)b=Le[a],d=e.views[b.internalIdentifier],d&&!d.disabled&&(this._registerView(b),f+=1);0===f&&c.error("No views registered.")},_isViewRegistered:function(a){return!!this.viewsImpl[a]},_registerView:function(b){var c=this,d=a.extend(!0,{supports:{edit:!1,selection:!0,cellSelection:!1,highlight:!1,controlBreak:!1,aggregation:!1,singleRowView:!1,configurableColumns:!1,filter:!0,sort:!0,changeRowsPerPage:!0,download:!1,totalRows:!0},isConfigured:function(){return!!c._currentReportSettings().views[this.internalIdentifier]},initDialog:null,openDialog:function(){!this.dialog$&&this.initDialog&&this.initDialog(c),this.dialog$.dialog("open")},clearModelData:function(){this.model.getOption("parentModel")&&!this.model.getOption("parentRecordId")||(c.modelReportSettingsSeq[this.model.modelId()]=c.reportSettingsSeq,this.model.clearData())},setColumnConfig:function(){},init:function(){},updateActions:function(){},initView:function(){},viewChanged:function(){},setReportOptions:function(){},destroyView:function(){},destroy:function(){},getSelectedRecords:function(){return[]},setSelectedRecords:function(){},getActiveRecordId:function(){return null},getContextRecord:function(){return[]},gotoCell:null,selectCells:null,getColumns:null,canCopy2Clipboard:function(){return!1},setModelName:function(){},setEditMode:function(a){},finishEditing:null,setNoDataMessage:function(a){},focus:function(){},refreshColumns:function(){},footerHeight:function(){return 0},refresh:function(){},resize:function(){},show:function(){this.view$.show()},hide:function(){this.view$.hide()}},b);d.model=null,d.modelName=null,d.modelColumns=null,d.view$=null,d.elementId=d.internalIdentifier+Xc,this.viewsImpl[d.internalIdentifier]=d},_forEachView:function(a){var b,c;for(b in this.viewsImpl)this.viewsImpl.hasOwnProperty(b)&&(c=this.viewsImpl[b],a(b,c))},_getPaginationConfig:function(b,c){var d={},e=b.pagination;return c&&b[c].pagination&&(d=a.extend({},b[c].pagination)),d.scroll=e.type===Kc||e.type===Lc,d.hasOwnProperty("showPageLinks")||(d.showPageLinks=e.type===Mc&&e.showTotalRowCount),d.hasOwnProperty("firstAndLastButtons")||(d.firstAndLastButtons=e.type===Mc&&e.showTotalRowCount),d.hasOwnProperty("showRange")||(d.showRange=!0),d},_renderDialogContent:function(a){var c,d=this,e=b.htmlBuilder();c=function(a,b){d._renderColumnItem(e,a,b)},e.markup("<div").attr(ad,"a-GV-columnItemContainer u-vh").attr(Fb,!0).markup(">"),a(c,e),e.markup("</div>"),this.element.append(e.toString())},_createDialog:function(b,c,d){var e,f,g,h,i,j,k,l,m=a.extend(!0,{width:600,height:380,labelAlignment:Wb,formCssClasses:Wa+" "+Xa,useSplitter:!0,splitterPosition:280,persistSplitter:b,noDataMessage:n("NO_DATA_FOUND"),modelOptions:{shape:"record",editable:!0,onlyMarkForDelete:!1,identityField:"id"}},d);b+="Dialog",i=b+"$",j=this._getId(b.replace(/[A-Z]/g,function(a){return"_"+a.toLowerCase()})),h=m.dialogHelp,h||(m.dialogHelp=h={}),h.helpTextKey="APEX.IG.HELP."+(h.helpTextKey||m.titleKey),h.titleKey=h.titleKey?"APEX.IG.HELP."+h.titleKey:h.helpTextKey+"_TITLE",m.titleKey="APEX.IG."+m.titleKey,m.modelName=m.modelName?this._getId(m.modelName):j,f=m.modelOptions.fields;for(e in f)f.hasOwnProperty(e)&&(g=f[e],g.label&&(g.label=n(g.label),g.heading||"table"!==m.modelOptions.shape||(g.heading=g.label)),g.elementId&&(g.elementId=this._getId(g.elementId)));return d.checkboxColumn&&(l=m.init,m.init=function(b,c,d){var e="isEnabled";c.on("click",zb,function(){var d=a(this),f=c.grid("getRecords",[d.parent()])[0],g=!b.getValue(f,e);b.setValue(f,"enabledClass",g?vb:""),b.setValue(f,"enabledText",n(g?"ENABLED":"DISABLED")),b.setValue(f,e,g)}).on("keydown",zb,function(b){b.which===a.ui.keyCode.SPACE&&a(this).trigger("click")}),r(d,e),l.call(this,b,c,d)},f.enabledClass={"volatile":!0,canHide:!1,hidden:!0,seq:0,defaultValue:vb},f.enabledText={"volatile":!0,canHide:!1,hidden:!0,seq:0,defaultValue:n("ENABLED")}),this._renderDialogContent(c),k=a.apex.recordView.createModelEditDialog(j,m),d.viewDialog||(this[i]=k),k},_renderColumnItem:function(a,b,c){switch(a.markup("<div").attr(ad,"a-GV-columnItem").markup(">"),c.id&&(c.id=this._getId(c.id)),b){case Qb:G(a,c);break;case Nb:M(a,c);break;case Mb:B(a,c);break;case Pb:H(a,c);break;case Rb:L(a,c);break;case Ob:c.colorMenu&&(c.colorMenuId=this._getId("color_menu")),F(a,c);break;case Sb:C(a,c)}a.markup("</div>")},_renderReportSettingsDialog:function(){var b,c=[],d=[],e=this.options.config,f=e.features.saveReport.isDeveloper,g=this;f&&(c.push({value:rc,label:n("PRIMARY")}),c.push({value:sc,label:n("ALTERNATIVE")})),c.push({value:tc,label:n("SAVED_REPORT_PRIVATE")}),e.features.saveReport.publicReportCs&&c.push({value:uc,label:n("SAVED_REPORT_PUBLIC")}),y(e.features.saveReport.authorizations,d,"r","d","",n(te)),this._createDialog("reportSettings",function(a){a(Nb,{id:"SRD_TYPE",options:c}),a(Mb,{id:"SRD_NAME"}),a(Nb,{id:"SRD_AUTHORIZATION",options:d})},{height:350,titleKey:"REPORT",defaultButton:!0,modelOptions:{fields:{id:{canHide:!1,hidden:!0,seq:0},type:{label:"TYPE",elementId:"SRD_TYPE",seq:10,defaultValue:vc},name:{label:"NAME",elementId:"SRD_NAME",seq:20},authorizationId:{label:"AUTHORIZATION",elementId:"SRD_AUTHORIZATION",seq:30}}},load:function(c){var d,e=a(this),h=e.dialog(ic,"saveAs"),i=a.extend({id:"",type:"",name:"",authorizationId:""},g._currentReportSettings());return d=h?"REPORT_SAVE_AS":"REPORT_EDIT",e.dialog(ic,"title",n(d)),b=i.type,h&&(i.name="",f?i.type=tc:a.inArray(i.type,[rc,sc])>-1&&(i.type=tc)),c.setData(i),g._report()},init:function(c,d,e){function f(){var a,c,d=k.dialog(ic,"saveAs");switch(c=d&&b===rc,h.find("option[value="+rc+"]").prop(gc,c),a=h.val(),h.prop(gc,!1),Q(i,!0),O(j),a){case rc:b===rc&&h.prop(gc,!0),Q(i,!1);break;case sc:N(j);break;case tc:break;case uc:}}var h=g._getElement("SRD_TYPE"),i=g._getElement("SRD_NAME"),j=g._getElement("SRD_AUTHORIZATION"),k=a(this);h.change(f),e.on("apexbeginrecordedit",f)},store:function(b){var c=a(this).dialog(ic,"saveAs"),d=b.getRecord();c?(d.baseReportId=d.id,g.addReport(d)):g.updateReport(d.id,d),g._updateReportSettingsActions()}})},_renderDownloadDialog:function(){var b=this,c=n("MAILADDRESSES_COMMASEP"),d=this.options.config.features.download,e=[];d&&d.formats.indexOf("CSV")!==-1&&e.push({value:"CSV",label:n("FORMAT_CSV"),iconCssClasses:"icon-ig-dl-xls"}),d&&d.formats.indexOf("HTML")!==-1&&e.push({value:"HTML",label:n("FORMAT_HTML"),
iconCssClasses:"icon-ig-dl-html"}),this._createDialog(Fc,function(a){a(Sb,{id:"DL_DOWNLOAD_FORMAT",options:e}),a(Qb,{id:"DL_SEND_AS_EMAIL",options:[{value:Uc}]}),a(Mb,{id:"DL_EMAIL_TO",placeholder:c}),a(Mb,{id:"DL_EMAIL_CC",placeholder:c}),a(Mb,{id:"DL_EMAIL_BCC",placeholder:c}),a(Mb,{id:"DL_EMAIL_SUBJECT"}),a(Pb,{id:"DL_EMAIL_BODY"})},{height:400,titleKey:"DOWNLOAD",modelOptions:{fields:{id:{canHide:!1,hidden:!0,seq:0},format:{label:"DOWNLOAD_FORMAT",elementId:"DL_DOWNLOAD_FORMAT",seq:10},sendOrDownload:{label:"SEND_AS_EMAIL",elementId:"DL_SEND_AS_EMAIL",seq:15},emailTo:{label:"EMAIL_TO",elementId:"DL_EMAIL_TO",seq:20},emailCc:{label:"EMAIL_CC",elementId:"DL_EMAIL_CC",seq:30},emailBcc:{label:"EMAIL_BCC",elementId:"DL_EMAIL_BCC",seq:40},emailSubject:{label:"EMAIL_SUBJECT",elementId:"DL_EMAIL_SUBJECT",seq:50},emailBody:{label:"EMAIL_BODY",elementId:"DL_EMAIL_BODY",seq:60},sendEmail:{canHide:!1,hidden:!0,seq:0}}},load:function(a){a.setData({id:0,format:"CSV",sendEmail:"N"})},init:function(c,e,f){function g(){j.prop(hc)===!0?(N([k,l,o,p,q]),Q([k,p],!0),s[h].text=n("SEND_AS_EMAIL"),r.dialog(ic,"buttons",s),null!==f.recordView("getRecord")&&c.setValue(f.recordView("getRecord"),"sendEmail","Y")):(O([k,l,o,p,q]),Q([k,p],!1),s[h].text=n("DOWNLOAD"),r.dialog(ic,"buttons",s),null!==f.recordView("getRecord")&&c.setValue(f.recordView("getRecord"),"sendEmail","N"))}var h,i,j=b._getElement("DL_SEND_AS_EMAIL"),k=b._getElement("DL_EMAIL_TO"),l=b._getElement("DL_EMAIL_CC"),o=b._getElement("DL_EMAIL_BCC"),p=b._getElement("DL_EMAIL_SUBJECT"),q=b._getElement("DL_EMAIL_BODY"),r=a(this),s=r.dialog(ic,"buttons");for(i=0;i<s.length;i++)if(s[i].text===m("APEX.DIALOG.SAVE")){h=i;break}f.on("apexbeginrecordedit",function(){D(b._getId("DL_DOWNLOAD_FORMAT"),d.formats[0]),g(),b.options.config.features.download.email===!0?j.change(g):O(j)})},store:function(a){var c,d=a.getRecord();c={format:d.format},"Y"===d.sendEmail&&(c.email={to:d.emailTo,subject:d.emailSubject},d.emailCc&&""!==d.emailCc&&(c.email.cc=d.emailCc),d.emailBcc&&""!==d.emailBcc&&(c.email.bcc=d.emailBcc),d.emailBody&&""!==d.emailBody&&(c.email.body=d.emailBody)),b._downloadReport(c)}})},_columnFilterModelFields:function(a){var b=a+"_";return{type:{label:b+"TYPE",elementId:b+"TYPE",seq:100,canHide:!0,hidden:!0,defaultValue:Ub},columnId:{label:"COLUMN",elementId:b+"COLUMN",seq:120,fieldColSpan:6,canHide:!0,hidden:!0},operator:{label:"OPERATOR",elementId:b+"OPERATOR",seq:130,fieldColSpan:6,canHide:!0,hidden:!0,defaultValue:ld},value:{label:"VALUE",elementId:b+"VALUE",seq:140,canHide:!0,hidden:!0},dateRangeValue:{label:"VALUE",elementId:b+"DATE_RANGE_VALUE",seq:141,fieldColSpan:6,canHide:!0,hidden:!0},dateRangeUnit:{label:"UNIT",elementId:b+"DATE_RANGE_UNIT",seq:142,fieldColSpan:6,canHide:!0,hidden:!0},isCaseSensitive:{label:"CASE_SENSITIVE",elementId:b+"CASE_SENSITIVE",seq:150,canHide:!0,hidden:!0,defaultValue:"N"},between:{label:"VALUE",elementId:b+"BETWEEN",seq:160,fieldColSpan:6,canHide:!0,hidden:!0},and:{label:"AND",elementId:b+"AND",seq:170,fieldColSpan:6,canHide:!0,hidden:!0},expression:{label:"EXPRESSION",elementId:b+"EXPRESSION",seq:180,canHide:!0,hidden:!0},hiddenValue:{seq:999,canHide:!0,hidden:!0},hiddenBetween:{seq:999,canHide:!0,hidden:!0},hiddenAnd:{seq:999,canHide:!0,hidden:!0}}},_renderSortControls:function(a,b){a(Nb,{id:b+"DIRECTION",required:!0,options:[{value:Gc,label:n("ASCENDING")},{value:Hc,label:n("DESCENDING")}]}),a(Nb,{id:b+"NULLS",required:!0,options:[{value:Ic,label:n("FIRST")},{value:Jc,label:n("LAST")}]})},_columnFilterDialogControls:function(a,b){var c,d,e=[],f=this.options.config.columns,g=b+"_";for(c=0;c<f.length;c++)d=f[c],("FD"===b&&this._isColumnFilterable(d.id)||"HD"===b&&!this._getColumn(d.id).specialType&&!this._getColumn(d.id).isHidden)&&e.push({value:d.id,label:this._getColumnLabel(d.id)});a(Nb,{id:g+"TYPE",options:[{value:Tb,label:n("ROW")},{value:Ub,label:n("COLUMN")}]}),a(Nb,{id:g+"COLUMN",options:e}),a(Nb,{id:g+"OPERATOR",options:[]}),a(Mb,{maxChars:4e3,id:g+"VALUE"}),a(Mb,{maxChars:20,id:g+"DATE_RANGE_VALUE"}),a(Nb,{id:g+"DATE_RANGE_UNIT",options:[{value:Ld,label:n("MINUTES")},{value:Md,label:n("HOURS")},{value:Nd,label:n("DAYS")},{value:Od,label:n("WEEKS")},{value:Pd,label:n("MONTHS")},{value:Qd,label:n("YEARS")}]}),a(Qb,{id:g+"CASE_SENSITIVE",value:Uc}),a(Mb,{maxChars:100,id:g+"BETWEEN"}),a(Mb,{maxChars:100,id:g+"AND"}),a(Mb,{maxChars:40,id:g+"NAME"}),a(Pb,{id:g+"EXPRESSION",toolbar:!0})},_columnFilterInitActions:function(b,c,d,f,g){function h(){var a;x&&null!==d.recordView("getRecord")&&(a=v._shortenString(v._getSettingLabel(xc,d.recordView("getRecord")),37),F.val(a).change())}function i(a){a.hasClass(cb)&&a.combobox(Yb),a.hasClass(eb)&&(a.parent().hasClass(db)&&a.unwrap(),a.datepicker(Yb)),a.attr("placeholder","")}function j(){function c(b,c,d){var f,g,h,i,j,k=v._getColumnFormatMask(r.id);f=k.toLowerCase().indexOf("hh")!==-1,f&&(h=(new Date).getHours(),g=k.indexOf("HH")!==-1,i="",g||(i=h>11?"PM":"AM",0===h&&(h=12),h>12&&(h-=12))),a(b).hasClass(db)||a(b).wrap(a("<span class='"+db+"'></span>")),f?(apex.widget.datepicker(b,{buttonText:"<span class='"+mb+" icon-calendar'></span><span class='"+Ab+"'>"+e.formatMessage("APEX.DATEPICKER.ICON_TEXT","")+"</span>",showTime:!0,showOn:"button",defaultDate:t(d),time24h:g,defHour:("00"+h).substr(-2),defMinute:"00",defAmpm:i},k,apex.locale.getLanguage()),j=!1,d&&null!==d.match(/^\d{14}/)&&(j=t(d),j&&!isNaN(j.getTime())&&apex.jQuery.timepicker.setCanonicalDate(a(b).get(0),j))):(apex.widget.datepicker(b,{buttonText:"<span class='"+mb+" icon-calendar'></span><span class='"+Ab+"'>"+e.formatMessage("APEX.DATEPICKER.ICON_TEXT","")+"</span>",defaultDate:t(d),showTime:!1,showOn:"button"},k,apex.locale.getLanguage()),d&&null!==d.match(/^\d{14}/)&&a(b).datepicker("setDate",t(d))),a(b).next("button").addClass(fb+" "+jb+" "+ib+" "+yb+" "+kb),a(b).attr("placeholder",n("EXAMPLE")+": "+r.appearance.formatExample)}var f,g,h,j;j=d.recordView("getRecord"),f=b.getValue(j,"hiddenValue"),g=b.getValue(j,"hiddenBetween"),h=b.getValue(j,"hiddenAnd"),i(C),i(D),i(E),a("#"+v._getId(w+"VALUE")+"_LABEL ").text(n("VALUE")),r.filter.dataType===Ud||r.filter.dataType===Wd||r.filter.dataType===Xd||r.filter.dataType===Yd?(r.filter.dataType===Xd&&a("#"+v._getId(w+"VALUE")+"_LABEL ").text(n("VALUE_TIMESTAMP_TZ")),c("#"+v._getId(w+"VALUE"),"hiddenValue",f),c("#"+v._getId(w+"BETWEEN"),"hiddenBetween",g),c("#"+v._getId(w+"AND"),"hiddenAnd",h)):(C.combobox({label:n("VALUE")}),D.combobox({label:n("VALUE")}),E.combobox({label:n("AND")}),C.val(f),D.val(g),E.val(h))}function k(a,c){null!==d.recordView("getRecord")&&b.setValue(d.recordView("getRecord"),a,c)}function l(b){var c=z.val(),d=B.val();switch(O([A,B,C,D,E,G,H,I,J]),x&&O(F),k("type",c),c){case Tb:N(C),v.options.config.filter.oracleText?(H.prop(gc,!0),O(H)):(H.prop(gc,!1),N(H)),P(C,"APEX.IG.SEARCH"),i(C),h();break;case Ub:N([A,B]),P(C,"APEX.IG.VALUE"),N(a.inArray(d,[Ad,Bd])>-1?[D,E]:a.inArray(d,[Cd,Ed,Dd,Fd])>-1?[I,J]:C),m(b)}}function m(c){var e,g,h,l,m={},p=A.val(),q=z.val();if(q===Ub&&p){if(r=v._getColumn(p),r.filter.textCase)switch(r.filter.textCase.toLowerCase()){case"upper":C.css({"text-transform":"uppercase"}),D.css({"text-transform":"uppercase"}),E.css({"text-transform":"uppercase"});break;case"lower":C.css({"text-transform":"lowercase"}),D.css({"text-transform":"lowercase"}),E.css({"text-transform":"lowercase"});break;default:C.css({"text-transform":"none"}),D.css({"text-transform":"none"}),E.css({"text-transform":"none"})}if("HD"===f)switch(r.dataType){case Sd:m[ld]=n(ve[ld]),m[md]=n(ve[md]),m[td]=n(ve[td]),m[ud]=n(ve[ud]),m[xd]=n(ve[xd]),m[yd]=n(ve[yd]),m[vd]=n(ve[vd]),m[wd]=n(ve[wd]),m[Hd]=n(ve[Hd]),m[Id]=n(ve[Id]),m[Gd]=n(ve[Gd]);break;case Td:m[ld]=n(ve[ld]),m[md]=n(ve[md]),m[pd]=n(ve[pd]),m[qd]=n(ve[qd]),m[nd]=n(ve[nd]),m[od]=n(ve[od]),m[td]=n(ve[td]),m[ud]=n(ve[ud]),m[xd]=n(ve[xd]),m[yd]=n(ve[yd]),m[Ad]=n(ve[Ad]),m[Bd]=n(ve[Bd]);break;case Ud:case Wd:case Xd:case Yd:m[ld]=n(ve[ld]),m[md]=n(ve[md]),m[pd]=n(ve[pd]),m[qd]=n(ve[qd]),m[nd]=n(ve[nd]),m[od]=n(ve[od]),m[td]=n(ve[td]),m[ud]=n(ve[ud]),a.inArray(r.filter.dateRanges,[id,jd])>-1&&(m[Cd]=n(ve[Cd]),m[Dd]=n(ve[Dd])),a.inArray(r.filter.dateRanges,[id,kd])>-1&&(m[Ed]=n(ve[Ed]),m[Fd]=n(ve[Fd])),m[Ad]=n(ve[Ad]),m[Bd]=n(ve[Bd]);break;case Vd:m[td]=n(ve[td]),m[ud]=n(ve[ud])}else for(H.prop(gc,!0),g=0;g<r.filter.operators.length;g++)if(h=r.filter.operators[g],"$std$"===h.name)switch(r.filter.dataType){case Sd:m[ld]=n(ve[ld]),m[md]=n(ve[md]),m[td]=n(ve[td]),m[ud]=n(ve[ud]),m[xd]=n(ve[xd]),m[yd]=n(ve[yd]);break;case Td:m[ld]=n(ve[ld]),m[md]=n(ve[md]),m[pd]=n(ve[pd]),m[qd]=n(ve[qd]),m[nd]=n(ve[nd]),m[od]=n(ve[od]),m[td]=n(ve[td]),m[ud]=n(ve[ud]),m[xd]=n(ve[xd]),m[yd]=n(ve[yd]),m[Ad]=n(ve[Ad]),m[Bd]=n(ve[Bd]);break;case Ud:case Wd:case Xd:case Yd:m[ld]=n(ve[ld]),m[md]=n(ve[md]),m[pd]=n(ve[pd]),m[qd]=n(ve[qd]),m[nd]=n(ve[nd]),m[od]=n(ve[od]),m[td]=n(ve[td]),m[ud]=n(ve[ud]),a.inArray(r.filter.dateRanges,[id,jd])>-1&&(m[Cd]=n(ve[Cd]),m[Dd]=n(ve[Dd])),a.inArray(r.filter.dateRanges,[id,kd])>-1&&(m[Ed]=n(ve[Ed]),m[Fd]=n(ve[Fd])),m[Ad]=n(ve[Ad]),m[Bd]=n(ve[Bd]);break;case Vd:m[td]=n(ve[td]),m[ud]=n(ve[ud])}else"$perform$"===h.name?a.inArray(r.filter.dataType,[Sd,Vd])>-1&&(m[vd]=n(ve[vd]),m[wd]=n(ve[wd]),m[Hd]=n(ve[Hd]),m[Id]=n(ve[Id]),m[Gd]=n(ve[Gd]),r.filter.textCase&&"MIXED"===r.filter.textCase.toUpperCase()&&H.prop(gc,!1)):h.name===Kd?r.filter.textCase&&"MIXED"===r.filter.textCase.toUpperCase()&&H.prop(gc,!1):m[h.name]=n(ve[h.name]);l=b.getValue(d.recordView("getRecord"),"operator"),B.empty(),a.each(m,function(b,c){B.append(a("<option></option>").attr("value",b).text(c))}),l&&null!==l&&a.inArray(l,m)&&B.val(l),null===B.val()&&B.val(ld),k("operator",B.val()),j(),v._hasColumnFilterLov(p)?v._getFilterValues(p,!1,function(a){if(y=[],a.regions[0].filterValues)for(e=a.regions[0].filterValues,g=0;g<e.length;g++)y.push({label:e[g],value:e[g]});D.hasClass(cb)&&D.combobox(ic,"source",y),E.hasClass(cb)&&E.combobox(ic,"source",y),C.hasClass(cb)&&C.combobox(ic,"source",y)}):(i(C),i(D),i(E)),k("columnId",p),c&&(C.val("").change(),D.val("").change(),E.val("").change()),o()}}function o(){var b=B.val(),c=z.val();k("operator",b),c===Ub&&(O([C,D,E,I,J,H]),null!==b&&(a.inArray(r.filter.dataType,[Ud,Wd,Xd,Yd])===-1&&C.hasClass(cb)&&(a.inArray(b,[xd,yd])>-1?(C.combobox(ic,"multipleValues",!0),C.combobox(ic,"multipleValueDelimiter",zd+" "),C.prop("placeholder",e.formatMessage("APEX.IG.PLACEHOLDER_INVALUES",zd))):(C.combobox(ic,"multipleValues",!1),C.prop("placeholder",""))),a.inArray(b,[vd,wd,Gd,Hd,Id])>-1&&H.prop(gc)===!1&&N(H),a.inArray(s,[Ad,Bd])>-1&&a.inArray(b,[Ad,Bd])===-1&&C.val("").change(),a.inArray(s,[Ad,Bd])===-1&&a.inArray(b,[Ad,Bd])>-1&&(D.val("").change(),E.val("").change()),a.inArray(s,[Cd,Ed,Dd,Fd])>-1&&a.inArray(b,[Cd,Ed,Dd,Fd])===-1&&C.val("").change(),a.inArray(b,[Ad,Bd])>-1?N([D,E]):a.inArray(b,[Cd,Ed,Dd,Fd])>-1?(N([I,J]),q()):a.inArray(b,[td,ud])===-1&&N(C))),s=b,h()}function p(a){var c,e,f,g,i=v._getElement(w+a);if("VALUE"===a&&(c="hiddenValue"),"BETWEEN"===a&&(c="hiddenBetween"),"AND"===a&&(c="hiddenAnd"),b.setValidity(_c,d.recordView("getRecord").id,a.toLowerCase()),i.hasClass(eb))if(""===i.val())g="",f="";else{e=!1;try{e=i.datepicker(ic,"showTime")?apex.jQuery.timepicker.getCanonicalDate(i.get(0)):i.datepicker("getDate")}catch(j){}e&&!isNaN(e.getTime())?(g=i.val(),f=u(e)):(""!==i.val()&&b.setValidity($c,d.recordView("getRecord").id,a.toLowerCase(),n("DATE_INVALID_VALUE")),g=i.val(),f=i.val())}else"uppercase"===i.css("text-transform")?(f=i.val().toUpperCase(),g=i.val().toUpperCase()):"lowercase"===i.css("text-transform")?(f=i.val().toLowerCase(),g=i.val().toLowerCase()):(f=i.val(),g=i.val());k(c,f),k(a.toLowerCase(),g),h()}function q(){C.val(I.val()+Tc+J.val()),k("value",C.val()),k("dateRangeValue",I.val()),k("dateRangeUnit",J.val()),h()}var r,s,v=this,w=f+"_",x="FD"===f,y=[],z=v._getElement(w+"TYPE"),A=v._getElement(w+"COLUMN"),B=v._getElement(w+"OPERATOR"),C=v._getElement(w+"VALUE"),D=v._getElement(w+"BETWEEN"),E=v._getElement(w+"AND"),F=v._getElement(w+"NAME"),G=v._getElement(w+"EXPRESSION"),H=v._getElement(w+"CASE_SENSITIVE"),I=v._getElement(w+"DATE_RANGE_VALUE"),J=v._getElement(w+"DATE_RANGE_UNIT");I.change(q),J.change(q),H.change(function(){var a=H.prop(hc);k("isCaseSensitive",a),H.prop(hc,a)}),z.change(function(){l(!0)}),A.change(function(){m(!0)}),B.change(o),C.change(function(){p("VALUE")}),D.change(function(){p("BETWEEN")}),E.change(function(){p("AND")}),d.on("apexbeginrecordedit",function(){l(),a.isFunction(g)&&g()})},_renderFilterDialog:function(){var b=this;this._createDialog(xc,function(a){b._columnFilterDialogControls(a,"FD")},{titleKey:"FILTERS",dialogHelp:{helpTextKey:"FILTER"},checkboxColumn:!0,modelOptions:{shape:"table",fields:a.extend({id:{canHide:!1,hidden:!0,seq:0},isEnabled:q(),name:{headingAlignment:Wb,label:"NAME",elementId:"FD_NAME",width:100,seq:105}},this._columnFilterModelFields("FD"))},load:function(c){var d,e,f,g,h,i=[],j=b.getFilters(),k=a(this).dialog(ic,"id");if(j.length>0){for(d=0;d<j.length;d++){switch(f=a.extend({id:"",type:"",columnId:"",operator:"",value:"",hiddenValue:"",dateRangeValue:"",dateRangeUnit:"",isCaseSensitive:!1,between:"",and:"",hiddenBetween:"",hiddenAnd:"",isEnabled:"",enabledClass:"",enabledText:"",name:"",expression:""},j[d]),e=f.isEnabled,f.enabledClass=e?vb:"",f.enabledText=n(e?"ENABLED":"DISABLED"),f.name=b._getSettingLabel(xc,f),f.type){case Tb:f.hiddenValue=f.value;break;case Ub:f.hiddenValue=f.value,a.inArray(f.operator,[Ad,Bd])>-1?(g=f.value.split(Tc),f.hiddenBetween=g[0],f.hiddenAnd=g[1],f.hiddenValue="",f.value=""):a.inArray(f.operator,[Cd,Ed,Dd,Fd])>-1&&(h=f.value.split(Tc),f.dateRangeValue=h[0],f.dateRangeUnit=h[1],f.hiddenValue="",f.value=""),a.inArray(f.operator,[xd,yd])>-1&&(f.value=f.value.split("").join(zd+" "),f.hiddenValue=f.value)}f.isCaseSensitive=f.isCaseSensitive?Uc:Vc,i.push(f)}c.setData(i)}else k=c.insertNewRecord();return k},init:function(a,c,d){r(d,"hiddenValue"),r(d,"hiddenBetween"),r(d,"hiddenAnd"),b._columnFilterInitActions(a,c,d,"FD")},validate:function(c,d,e){var f=!0;return c.forEach(function(c,g,h){switch(d(h,"between"),d(h,"and"),d(h,"value"),d(h,"expression"),c.type){case Ub:switch(c.operator){case Ad:case Bd:c.hiddenBetween&&""!==c.hiddenBetween||(f=!1,e(h,"between",n(re))),c.hiddenAnd&&""!==c.hiddenAnd||(f=!1,e(h,"and",n(re))),f&&a.inArray(b._getColumn(c.columnId).filter.dataType,[Ud,Wd,Xd,Yd])>-1&&(c.hiddenBetween!==u(t(c.hiddenBetween))&&(f=!1,e(h,"between",n(se))),c.hiddenAnd!==u(t(c.hiddenAnd))&&(f=!1,e(h,"and",n(se))));break;case Cd:case Ed:case Dd:case Fd:c.dateRangeValue&&""!==c.dateRangeValue||(f=!1,e(h,"dateRangeValue",n(re))),c.dateRangeUnit&&""!==c.dateRangeUnit||(f=!1,e(h,"dateRangeUnit",n(re)));break;case ld:case md:case pd:case qd:case nd:case od:case xd:case yd:c.hiddenValue&&""!==c.hiddenValue?a.inArray(b._getColumn(c.columnId).filter.dataType,[Ud,Wd,Xd,Yd])>-1&&c.hiddenValue!==u(t(c.hiddenValue))&&(f=!1,e(h,"value",n("DATE_INVALID_VALUE"))):(f=!1,e(h,"value",n(re)))}break;case Tb:c.hiddenValue&&""!==c.hiddenValue||(f=!1,e(h,"value",n(re)))}}),f},store:function(c){b._ifNoChangesDo(function(){var d,e,f,g={save:!1,skipNoChangesCheck:!0},h=c.getChanges();for(d=0;d<h.length;d++){switch(e=h[d],f=e.record,delete f.enabledClass,delete f.enabledText,f.type){case Tb:delete f.expression,delete f.columnId,delete f.and,delete f.between,delete f.hiddenAnd,delete f.hiddenBetween,delete f.dateRangeValue,delete f.dateRangeUnit,delete f.operator,f.isCaseSensitive=f.isCaseSensitive===Uc;break;case Ub:f.value=f.hiddenValue,a.inArray(f.operator,[Ad,Bd])>-1?f.value=f.hiddenBetween+Tc+f.hiddenAnd:a.inArray(f.operator,[Cd,Ed,Dd,Fd])>-1&&(f.value=f.dateRangeValue+Tc+f.dateRangeUnit),a.inArray(f.operator,[xd,yd])>-1&&(f.value=w(f.value.split(zd)).join("")),delete f.dateRangeValue,delete f.dateRangeUnit,delete f.between,delete f.and,delete f.hiddenValue,delete f.hiddenBetween,delete f.hiddenAnd,delete f.expression,f.isCaseSensitive=f.isCaseSensitive===Uc}e.inserted?(delete f.id,f.columnType=Ub,b.addFilter(f,g)):e.updated?(f.columnType=Ub,b.updateFilter(f.id,f,g)):e.deleted&&b.deleteFilter(f.id,g)}b._setReportSettings({refreshModel:!0})})}})},_renderColumnsDialog:function(){function b(b){function d(a){return!(a.id!==g.columnId||a.specialType&&"actions"!==a.specialType||a.isHidden)}var e,f,g,h,i=[],j=c._getCurrentView().columns;for(e=0;e<j.length;e++)g=j[e],f=a.grep(c.options.config.columns,d),f=f.length>0&&f[0],f&&(h={id:g.columnId,columnId:g.columnId,columnWidth:g.width,seq:e+1,heading:"actions"===f.specialType?n("ROW_ACTIONS"):f.heading.label,groupId:f.layout.groupId,canHide:f.features.canHide,isVisible:g.isVisible,enabledClass:g.isVisible?vb:""},"ALL"===b?i.push(h):"VISIBLE"===b&&g.isVisible?i.push(h):"INVISIBLE"!==b||h.isVisible||i.push(h));return i}var c=this,d=[],e=this.options.config.views[this._view()].features;y(this.options.config.columnGroups,d,"id","label","",""),this._createDialog(wc,function(a){a(Mb,{id:"CD_COLUMN_WIDTH"}),a(Nb,{id:"CD_COLUMN_GROUP",options:d})},{titleKey:"COLUMNS",modelOptions:{shape:"table",canDelete:!1,canAdd:!1,sequenceField:e.reorderColumns?"seq":null,fields:{id:{canHide:!1,hidden:!0,seq:0},isVisible:q("VISIBLE"),heading:{label:"COLUMN",headingAlignment:Wb,elementId:"CD_COLUMN_HEADING",canHide:!0,hidden:!1,width:100,seq:20},groupId:{label:"GROUP",elementId:"CD_COLUMN_GROUP",canHide:!0,escape:!1,"volatile":!0,hidden:!0,seq:30},columnWidth:{label:"WIDTH",elementId:"CD_COLUMN_WIDTH",canHide:!0,hidden:!0,seq:40},columnId:{label:"COLUMN",elementId:"CD_COLUMN",seq:0,canHide:!0,hidden:!0},seq:{canHide:!1,hidden:!0,seq:0},canHide:{canHide:!1,hidden:!0,seq:0},enabledClass:{"volatile":!0,canHide:!1,hidden:!0,defaultValue:vb,seq:0}}},load:function(a){a.setData(b(this.showColumns))},init:function(c,d,e,g){var h,i=this;this.showColumns||(this.showColumns="ALL"),h=[{type:gd,iconOnly:!0,icon:"icon-up-chevron",action:"move-up"},{type:gd,iconOnly:!0,icon:"icon-down-chevron",action:"move-down"},{type:hd,labelKey:"APEX.IG.SHOW",icon:"icon-ig-select-cols",iconOnly:!0,menu:{items:[{type:ed,action:"show-columns"}]}}],f.findContext("ModelEditDialog",this).add([{name:"show-columns",choices:[{label:n("ALL"),value:"ALL"},{label:n("VISIBLE"),value:"VISIBLE"},{label:n("INVISIBLE"),value:"INVISIBLE"}],get:function(){return i.showColumns},set:function(a){i.showColumns=a;var d=b(a);c.setData(d)}}]),g.toolbar({data:[{align:"start",controls:h}]}),d.on("click",zb,function(){var b,e,f=a(this);e=d.grid("getRecords",[f.parent()])[0],c.getValue(e,"canHide")&&(b=!c.getValue(e,"isVisible"),c.setValue(e,"enabledClass",b?vb:""),c.setValue(e,"isVisible",b))}).on("keydown",zb,function(b){b.which===a.ui.keyCode.SPACE&&a(this).trigger("click")}),e.on("apexbeginrecordedit",function(){""===c.getValue(e.recordView("getRecord"),"groupId")?r(e,"groupId"):s(e,"groupId")}),r(e,"columnId"),r(e,"isVisible")},validate:function(a,b,c){var d,e=!0;return a.forEach(function(a,f,g){d=a.columnWidth,null!==d&&""!==d&&isNaN(parseInt(d,10))?(c(g,"columnWidth",n(se)),e=!1):b(g,"columnWidth")}),e},store:function(a){var b,d,e,f=!1,g=c._getCurrentView().columns,h=c._currentViewImpl().getColumns();for(g.sort(function(a,b){return a.seq-b.seq}),b=0;b<g.length;b++)g[b].isFrozen===!0&&(f=b+1);for(a.forEach(function(a){e=a.columnWidth,e&&null!==e||(e=""),e=e.toString(),c._currentViewColumn(a.columnId,{isVisible:a.isVisible,width:parseInt(e,10),seq:parseFloat(a.seq)})}),g.sort(function(a,b){return a.seq-b.seq}),b=0;b<g.length;b++)for(d=0;d<h.length;d++)if(g[b].columnId===h[d].id){h[d].seq=g[b].seq,h[d].canHide&&(h[d].hidden=!g[b].isVisible),h[d].width=g[b].width,g[b].seq=b,f!==!1&&b>=f&&(g[b].isFrozen=!1,h[d].frozen=!1),f!==!1&&b<f&&(g[b].isFrozen=!0,h[d].frozen=!0);break}c._setReportSettings({refreshView:!0,refreshColumns:!0})}})},_renderHighlightDialog:function(){var b,d,e=this,f=this.options.config.columns,g=!1,h=[];for(d=0;d<f.length;d++)b=f[d],this._getColumn(b.id).specialType||this._getColumn(b.id).isHidden||h.push({value:b.id,label:this._getColumnLabel(b.id)});this._createDialog(yc,function(a){e._columnFilterDialogControls(a,"HD"),a(Ob,{id:"HD_BACKGROUND_COLOR",colorMenu:!0,itemLabel:n("BACKGROUND_COLOR")}),a(Ob,{id:"HD_TEXT_COLOR",colorMenu:!0,itemLabel:n("TEXT_COLOR")}),a(Nb,{id:"HD_HIGHLIGHT_TYPE",options:[{value:Tb,label:n("ROW")},{value:Ub,label:n("COLUMN")}]}),a(Nb,{id:"HD_HIGHLIGHT_COLUMN",options:h})},{width:800,height:580,titleKey:"HIGHLIGHT",checkboxColumn:!0,modelOptions:{shape:"table",sequenceField:"seq",fields:a.extend({id:{canHide:!1,hidden:!0,seq:0},seq:{canHide:!1,hidden:!0,seq:0},isEnabled:q(),name:{label:"NAME",headingAlignment:Wb,elementId:"HD_NAME",isRequired:!0,width:100,seq:15},highlightType:{label:"HIGHLIGHT",elementId:"HD_HIGHLIGHT_TYPE",seq:20,canHide:!0,hidden:!0},highlightColumnId:{label:"COLUMN",elementId:"HD_HIGHLIGHT_COLUMN",seq:30,canHide:!0,hidden:!0},backgroundColor:{label:"BACKGROUND_COLOR",elementId:"HD_BACKGROUND_COLOR",seq:40,fieldColSpan:6,canHide:!0,hidden:!0},textColor:{label:"TEXT_COLOR",elementId:"HD_TEXT_COLOR",seq:50,fieldColSpan:6,canHide:!0,hidden:!0}},this._columnFilterModelFields("HD"))},load:function(b){var c,d,f,g,h,i=[],j=e.getHighlights(),k=a(this).dialog(ic,"id");if(j.length>0){for(c=0;c<j.length;c++){switch(h=j[c],g={id:h.id,seq:h.seq,name:h.name,highlightType:h.type,highlightColumnType:h.columnType,highlightColumnId:h.columnId,backgroundColor:h.backgroundColor,textColor:h.textColor,type:h.condition.type,columnType:h.condition.columnType,columnId:h.condition.columnId,operator:h.condition.operator,isCaseSensitive:h.condition.isCaseSensitive?Uc:Vc,value:h.condition.value,expression:h.condition.expression,isEnabled:h.isEnabled,hiddenValue:"",dateRangeValue:"",dateRangeUnit:"",between:"",and:"",hiddenBetween:"",hiddenAnd:"",enabledClass:"",enabledText:""},g.enabledClass=g.isEnabled?vb:"",g.enabledText=n(g.isEnabled?"ENABLED":"DISABLED"),g.hiddenValue=g.value,g.type){case Ub:a.inArray(g.operator,[Ad,Bd])>-1?(d=g.value.split(Tc),g.hiddenBetween=d[0],g.hiddenAnd=d[1],g.hiddenValue="",g.value=""):a.inArray(g.operator,[Cd,Ed,Dd,Fd])>-1&&(f=g.value.split(Tc),g.dateRangeValue=f[0],g.dateRangeUnit=f[1],g.hiddenValue="",g.value=""),a.inArray(g.operator,[xd,yd])>-1&&(g.value=g.value.split("").join(zd+" "),g.hiddenValue=g.value)}i.push(g)}b.setData(i)}else k=b.insertNewRecord();return k},init:function(b,d,f){function h(b,c){a(c).prevAll("input").first().val(this.value).change()}function i(){function b(){"9999"!==a("div.colorpicker").css("z-index")&&a(document.createElement("style")).html(" div.colorpicker, div.colorpicker * { z-index: 9999; } ").appendTo("head"),apex.widget.colorpicker(q,{preview:{type:"modern"}}),apex.widget.colorpicker(s,{preview:{type:"modern"}}),g=!0}a.isFunction(apex.widget.colorpicker)?b():a.when(a.getScript(apex_img_dir+"libraries/jquery-colorpicker/1.4/js/"+(0===c.getLevel()?"apex.colorpicker.min.js":"apex.colorpicker.js")),a.getScript(apex_img_dir+"libraries/apex/"+(0===c.getLevel()?"minified/widget.colorpicker.min.js":"widget.colorpicker.js")),a.Deferred(function(b){a(b.resolve)})).done(function(){a(document.createElement("link")).attr({rel:"stylesheet",type:"text/css",href:apex_img_dir+"libraries/jquery-colorpicker/1.4/css/colorpicker.css"}).appendTo("head"),b()})}function j(){var a=o.val();a===Tb?O(p):N(p)}function k(){j(),g===!1&&i(),q.change(),s.change()}var l,n,o=e._getElement("HD_HIGHLIGHT_TYPE"),p=e._getElement("HD_HIGHLIGHT_COLUMN"),q=e._getElement("HD_TEXT_COLOR"),s=e._getElement("HD_BACKGROUND_COLOR"),t=e._getElement("HD_NAME"),u=[];for(n=0;n<ue.length;n++)u.push({type:cd,action:h,label:m(ue[n].label),icon:"a-Icon icon-circle",iconStyle:"color: "+ue[n].value+";",value:ue[n].value});l=a("<div/>",{id:e._getId("color_menu")}).appendTo(this),l.menu({actionsContext:e.actions,items:u}),Q(t,!0),r(f,"hiddenValue"),r(f,"hiddenBetween"),r(f,"hiddenAnd"),e._columnFilterInitActions(b,d,f,"HD",k),o.change(j)},validate:function(b,c,d){var f=!0;return b.forEach(function(b,g,h){switch(c(h,"between"),c(h,"and"),c(h,"value"),c(h,"expression"),c(h,"name"),c(h,"textColor"),c(h,"backgroundColor"),""===b.textColor&&""===b.backgroundColor&&(d(h,"textColor",n(re)),d(h,"backgroundColor",n(re))),""===b.name&&d(h,"name",n(re)),b.type){case Ub:switch(b.operator){case Ad:case Bd:b.hiddenBetween&&""!==b.hiddenBetween||(f=!1,d(h,"between",n(re))),b.hiddenAnd&&""!==b.hiddenAnd||(f=!1,d(h,"and",n(re))),f&&a.inArray(e._getColumn(b.columnId).filter.dataType,[Ud,Wd,Xd,Yd])>-1&&(b.hiddenBetween!==u(t(b.hiddenBetween))&&(f=!1,d(h,"between",n(se))),b.hiddenAnd!==u(t(b.hiddenAnd))&&(f=!1,d(h,"and",n(se))));break;case Cd:case Ed:case Dd:case Fd:b.dateRangeValue&&""!==b.dateRangeValue||(f=!1,d(h,"dateRangeValue",n(re))),b.dateRangeUnit&&""!==b.dateRangeUnit||(f=!1,d(h,"dateRangeUnit",n(re)));break;case ld:case md:case pd:case qd:case nd:case od:case xd:case yd:b.hiddenValue&&""!==b.hiddenValue?a.inArray(e._getColumn(b.columnId).filter.dataType,[Ud,Wd,Xd,Yd])>-1&&b.hiddenValue!==u(t(b.hiddenValue))&&(f=!1,d(h,"value",n("DATE_INVALID_VALUE"))):(f=!1,d(h,"value",n(re)))}break;case Tb:b.hiddenValue&&""!==b.hiddenValue||(f=!1,d(h,"value",n(re)))}}),f},store:function(b){e._ifNoChangesDo(function(){var c,d,f,g,h,i={save:!1,skipNoChangesCheck:!0},j=b.getChanges();for(c=0;c<j.length;c++){switch(d=j[c],g=d.record,g.type){case Tb:h={type:Tb,value:g.value,isCaseSensitive:g.isCaseSensitive===Uc};break;case Ub:h={type:Ub,value:g.hiddenValue,columnId:g.columnId,operator:g.operator,columnType:Ub,isCaseSensitive:g.isCaseSensitive===Uc},a.inArray(g.operator,[xd,yd])>-1&&(h.value=w(g.hiddenValue.split(zd)).join("")),a.inArray(g.operator,[Ad,Bd])>-1?h.value=g.hiddenBetween+Tc+g.hiddenAnd:a.inArray(g.operator,[Cd,Ed,Dd,Fd])>-1&&(h.value=g.dateRangeValue+Tc+g.dateRangeUnit)}f={id:g.id,seq:parseFloat(g.seq),name:g.name,type:g.highlightType,textColor:g.textColor,backgroundColor:g.backgroundColor,condition:h,isEnabled:g.isEnabled},g.highlightType===Ub?(f.type=Ub,f.columnType=Ub,f.columnId=g.highlightColumnId):g.highlightType===Tb&&(f.type=Tb,delete f.columnType,delete f.columnId),d.inserted?(delete f.id,e.addHighlight(f,i)):d.updated?e.updateHighlight(f.id,f,i):d.deleted&&e.deleteHighlight(f.id,i)}e._setReportSettings({refreshModel:!0,changeIdentifier:"views.grid.highlights"})})}})},_loadColumnOptions:function(a,b){var c,d,e,f=this.options.config.columns;for(a.push({value:"",label:n(te)}),c=0;c<f.length;c++)e=f[c],e.specialType||!e.features[b]||e.isHidden||(d||(d=e),a.push({value:e.id,label:this._getColumnLabel(e.id)}));return d},_renderSortDialog:function(){var a,b=[],c=this;a=this._loadColumnOptions(b,"sort"),this._createDialog(Ac,function(a){a(Nb,{id:"SD_COLUMN",required:!0,options:b}),c._renderSortControls(a,"SD_")},{titleKey:"SORT",modelOptions:{shape:"table",identityField:"order",sequenceField:"seq",fields:{order:{canHide:!1,hidden:!0,seq:10},seq:{seq:20,canHide:!1,hidden:!0},columnId:{label:"COLUMN",headingAlignment:Wb,elementId:"SD_COLUMN",isRequired:!0,width:100,seq:30,canHide:!0,hidden:!1},direction:{label:"DIRECTION",headingAlignment:Wb,elementId:"SD_DIRECTION",width:60,seq:40,defaultValue:Gc,canHide:!0,hidden:!1},nulls:{label:"NULLS",elementId:"SD_NULLS",seq:50,defaultValue:Jc,canHide:!0,hidden:!0}}},load:function(a){var b,d,e=c.getSorts();for(b=0;b<e.length;b++)e[b].seq=b+1,e[b].order=b+1;return e.length>0?a.setData(e):d=a.insertNewRecord(),d},init:function(a,b,d){function e(){a.setValue(d.recordView("getRecord"),"columnId",g.val())}function f(){a.setValue(d.recordView("getRecord"),"direction",h.val())}var g=c._getElement("SD_COLUMN"),h=c._getElement("SD_DIRECTION");c._getElement("SD_NULLS");g.change(e),h.change(f)},validate:function(a){var b={},c=!0;return a.forEach(function(a,d,e){b[a.columnId]?c=!1:b[a.columnId]=!0}),c!==!1||n("SORT_ONLY_ONE_PER_COLUMN")},store:function(a){var b,d,e,f,g,h=a.getChanges(),i=c.getSorts();for(b=0;b<i.length;b++)i[b].seq=b+1;for(b=0;b<h.length;b++)if(e=h[b],f=e.record,g=e.original,f.seq=parseFloat(f.seq),e.inserted)i.push(f);else if(e.updated)if(g.columnId===f.columnId){for(d=0;d<i.length;d++)if(f.columnId===i[d].columnId){i[d]=f;break}}else{for(d=0;d<i.length;d++)if(g.columnId===i[d].columnId){i.splice(d,1);break}i.push(f)}else if(e.deleted)for(d=0;d<i.length;d++)if(f.columnId===i[d].columnId){i.splice(d,1);break}i.length>0&&(i=i.sort(function(a,b){return a.seq-b.seq})),h.length>0&&c.setSorts(i)}})},_renderAggregateDialog:function(){var b,c,d=[],e=this;b=this._loadColumnOptions(d,"aggregate"),c=[{value:we.CNT,label:n(we.CNT)},{value:we.CNT_DIST,label:n(we.CNT_DIST)},{value:we.MIN,label:n(we.MIN)},{value:we.MAX,label:n(we.MAX)},{value:we.MEDIAN,label:n(we.MEDIAN)},{value:we.SUM,label:n(we.SUM)},{value:we.AVG,label:n(we.AVG)}],this._createDialog(Bc,function(a){a(Nb,{id:"AD_COLUMN",required:!0,options:d}),a(Nb,{id:"AD_AGGREGATION",required:!0,options:c}),a(Mb,{maxlength:"30",id:"AD_TOOLTIP"}),a(Qb,{id:"AD_SHOW_GRAND_TOTAL",value:Uc})},{titleKey:"AGGREGATION",dialogHelp:{helpTextKey:"AGGREGATE"},checkboxColumn:!0,modelOptions:{shape:"table",fields:{id:{canHide:!1,hidden:!0,seq:0},isEnabled:q(),columnId:{label:"COLUMN",headingAlignment:Wb,elementId:"AD_COLUMN",isRequired:!0,defaultValue:"",seq:30,width:80,canHide:!0,hidden:!1},"function":{label:"AGGREGATION",headingAlignment:Wb,elementId:"AD_AGGREGATION",isRequired:!0,seq:40,width:80,defaultValue:"",canHide:!0,hidden:!1},tooltip:{label:"TOOLTIP",elementId:"AD_TOOLTIP",seq:50,defaultValue:"",canHide:!0,hidden:!0},showGrandTotal:{label:"SHOW_OVERALL_VALUE",elementId:"AD_SHOW_GRAND_TOTAL",seq:60,defaultValue:Uc,canHide:!0,hidden:!0}}},load:function(c){function d(a){var b,d=e._getColumn(a);return h=d.filter.dataType===Td?we.SUM:we.CNT,b=c.insertNewRecord(null,null,{columnId:a,isEnabled:!0,enabledClass:vb,"function":h})}var f,g,h,i=[],j=a(this),k=j.dialog(ic,"id"),l=j.dialog(ic,"columnId"),m=e.getAggregates();if(m.length>0){for(f=0;f<m.length;f++)g=a.extend({id:"",columnId:"","function":"",tooltip:"",showGrandTotal:"",isEnabled:"",enabledClass:"",enabledText:""},m[f]),g.enabledClass=g.isEnabled?vb:"",g.enabledText=n(g.isEnabled?"ENABLED":"DISABLED"),g.showGrandTotal=g.showGrandTotal?Uc:Vc,i.push(g);c.setData(i),l&&(k=d(l))}else k=d(l?l:b.id);return k},init:function(b,c,d){function f(){var c,f,h={},k=i.val();c=e._getColumn(k),k&&""!==k?(s(d,"function"),s(d,"tooltip"),s(d,"showGrandTotal"),h[we.CNT]=n(we.CNT),c.filter.dataType!==Sd&&c.filter.dataType!==Td&&c.filter.dataType!==Ud||(h[we.CNT_DIST]=n(we.CNT_DIST),h[we.MIN]=n(we.MIN),h[we.MAX]=n(we.MAX)),c.filter.dataType!==Td&&c.filter.dataType!==Ud||(h[we.MEDIAN]=n(we.MEDIAN)),c.filter.dataType===Td&&(h[we.SUM]=n(we.SUM),h[we.AVG]=n(we.AVG)),f=j.val(),j.empty(),j.append(a("<option></option>").attr("value","").text(n(te))),a.each(h,function(b,c){j.append(a("<option></option>").attr("value",b).text(c))}),""!==f&&j.val(f),""!==j.val()&&null!==j.val()||(c.filter.dataType===Td?j.val(we.SUM):j.val(we.CNT)),b.setValue(d.recordView("getRecord"),"columnId",k),g()):(r(d,"function"),r(d,"tooltip"),r(d,"showGrandTotal"),b.setValue(d.recordView("getRecord"),"columnId",""),j.val("").change())}function g(){b.setValue(d.recordView("getRecord"),"function",j.val())}function h(){b.setValue(d.recordView("getRecord"),"showGrandTotal",k.prop(hc)?"Y":"N")}var i=e._getElement("AD_COLUMN"),j=e._getElement("AD_AGGREGATION"),k=e._getElement("AD_SHOW_GRAND_TOTAL");N(i),i.change(f),j.change(g),k.change(h),d.on("apexbeginrecordedit",function(){f()})},validate:function(a,b,c){var d,e={},f=!0;return a.forEach(function(a,g,h){d=a.columnId.toString()+a["function"],e[d]?(f=!1,c(h,"columnId",n("DUPLICATE_AGGREGATION")),c(h,"function",n("DUPLICATE_AGGREGATION"))):(e[d]=!0,b(h,"columnId"),b(h,"function")),""===a.columnId&&(c(h,"columnId",n("DUPLICATE_AGGREGATION")),f=!1)}),f},store:function(a){e._ifNoChangesDo(function(){var b,c,d,f={save:!1,skipNoChangesCheck:!0},g=a.getChanges();for(b=0;b<g.length;b++)c=g[b],c.record.columnId&&""!==c.record.columnId&&(d=c.record,
delete d.enabledClass,delete d.enabledText,d.showGrandTotal=d.showGrandTotal===Uc,c.inserted?(delete d.id,d.columnType=Ub,e.addAggregate(d,f)):c.updated?e.updateAggregate(d.id,d,f):c.deleted&&e.deleteAggregate(d.id,f));e._setReportSettings({refreshModel:!0,changeIdentifier:"views.grid.aggregations"})})}})},_renderControlBreakDialog:function(){var b,c=[],d=this;b=this._loadColumnOptions(c,"sort"),this._createDialog(Cc,function(a){a(Nb,{id:"CBD_COLUMN",required:!0,options:c}),d._renderSortControls(a,"CBD_")},{titleKey:"CONTROL_BREAK",checkboxColumn:!0,modelOptions:{shape:"table",sequenceField:"sequenceField",fields:{id:{canHide:!1,hidden:!0,seq:0},sequenceField:{canHide:!1,hidden:!0,seq:0},oldColumnId:{canHide:!1,hidden:!0,seq:0},isEnabled:q(),columnId:{label:"COLUMN",headingAlignment:Wb,elementId:"CBD_COLUMN",isRequired:!0,seq:20,width:100,canHide:!0,hidden:!1},direction:{label:"DIRECTION",elementId:"CBD_DIRECTION",defaultValue:Gc,seq:30,canHide:!0,hidden:!0},nulls:{label:"NULLS",elementId:"CBD_NULLS",defaultValue:Jc,seq:40,canHide:!0,hidden:!0}}},load:function(c){var e,f,g,h,i=[],j=a(this).dialog(ic,"id"),k=d._getCurrentView().columns;for(e=0;e<k.length;e++)f=k[e],h=f["break"],h&&(g=a.extend({},{id:f.columnId,columnId:f.columnId,oldColumnId:f.columnId,direction:f.direction,nulls:f.nulls,sequenceField:parseFloat(h.order),isEnabled:h.isEnabled,enabledClass:h.isEnabled?vb:""}),i.push(g));return i.length>0?(i.sort(function(a,b){return a.sequenceField<b.sequenceField?-1:a.sequenceField>b.sequenceField?1:0}),c.setData(i)):j=c.insertNewRecord({isEnabled:!0,id:b.columnId,columnId:b.columnId,oldColumnId:b.columnId,direction:b.sort?b.sort.direction:Gc,nulls:b.sort?b.sort.nulls:Jc}),j},init:function(a,b,c){function e(){a.setValue(c.recordView("getRecord"),"columnId",f.val()),""===f.val()?O([g,h]):N([g,h])}var f=d._getElement("CBD_COLUMN"),g=d._getElement("CBD_DIRECTION"),h=d._getElement("CBD_NULLS");f.change(e),g.change(function(){a.setValue(c.recordView("getRecord"),"direction",g.val())}),h.change(function(){a.setValue(c.recordView("getRecord"),"nulls",h.val())}),c.on("apexbeginrecordedit",e)},validate:function(a,b,c){var d={},e=!0;return a.forEach(function(a,b,f){d[a.columnId]?(e=!1,c(f,"columnId",n("DUPLICATE_CONTROLBREAK"))):d[a.columnId]=!0,""===a.columnId&&(e=!1)}),e},store:function(a){d._ifNoChangesDo(function(){function b(){d.addControlBreak(d._currentViewImpl().modelColumns[d._getColumn(f.columnId).name],{isEnabled:f.isEnabled,order:parseFloat(f.sequenceField),direction:f.direction,nulls:f.nulls},g)}var c,e,f,g={save:!1,skipNoChangesCheck:!0},h=a.getChanges();for(c=0;c<h.length;c++)e=h[c],f=e.record,e.inserted?b():e.updated?f.columnId!==f.oldColumnId?(d.deleteControlBreak(f.oldColumnId,g),b()):d.updateControlBreak(f.columnId,{isEnabled:f.isEnabled,order:parseFloat(f.sequenceField),direction:f.direction,nulls:f.nulls},g):e.deleted&&d.deleteControlBreak(f.columnId,g);d._setReportSettings({refreshModel:!0,refreshColumns:!0})})}})},_addActions:function(d){var f=this,g=this.options.config;d.add([{name:"search-case-sensitive",labelKey:"APEX.IG.CASE_SENSITIVE",value:!1,get:function(){return f.searchCaseSensitive},set:function(a){f.searchCaseSensitive=a}},{name:"filter-column",labelKey:"APEX.IG.SELECT_COLUMNS_TO_SEARCH",get:function(){return f.currentFilterColumnId},set:function(a){f._setFilterColumn(a)}},{name:"search",labelKey:"APEX.IG.GO",getSearchValue:function(a){var b="";g.toolbar&&g.toolbar.searchField&&g.toolbarData&&(b=f.toolbar$.toolbar("findElement","search_field").val()),a(b)},action:function(){this.getSearchValue(function(a){var b;a?(b=f.currentFilterColumnId?{type:Ub,columnType:Ub,columnId:f.currentFilterColumnId,operator:vd,value:a,isCaseSensitive:f.searchCaseSensitive}:{type:Tb,value:a,isCaseSensitive:f.searchCaseSensitive},f.addFilter(b)):f.refresh()})}},{name:"change-report",labelKey:"APEX.IG.SAVED_REPORTS",hide:!0,choices:[],get:function(){return f._report()},set:function(a){f._ifNoChangesDo(function(b){b&&f.clearChanges(),f._report(a)})}},{name:"change-view",labelKey:"APEX.IG.CHANGE_VIEW",choices:[],get:function(){return f._view()},set:function(a){f._view(a,{fetchData:!0})}},{name:"show-columns-dialog",labelKey:"APEX.IG.COLUMNS",icon:"icon-ig-select-cols",action:function(){return f._openDialog(wc),!0}},{name:"show-filter-dialog",labelKey:"APEX.IG.FILTER",icon:"icon-ig-filter",hide:!0,action:function(){return f._openDialog(xc),!0}},{name:"chart-view",labelKey:"APEX.IG.CHART",icon:"icon-ig-chart",hide:!f._isViewRegistered(mc),action:function(){f._isViewRegistered(mc)?(f.viewsImpl[mc].isConfigured()&&f._view(mc,{fetchData:!0}),f.viewsImpl[mc].openDialog()):c.error("Chart view is not defined.")}},{name:"show-sort-dialog",labelKey:"APEX.IG.SORT",icon:"icon-ig-sort",action:function(){return f._openDialog(Ac),!0}},{name:"show-aggregate-dialog",labelKey:"APEX.IG.AGGREGATE",icon:"icon-ig-aggregate",action:function(){return f._openDialog(Bc),!0}},{name:"show-flashback-dialog",labelKey:"APEX.IG.FLASHBACK",icon:"icon-ig-flashback",hide:!0,action:function(){return f._openDialog(zc),!0}},{name:"show-highlight-dialog",labelKey:"APEX.IG.HIGHLIGHT",icon:"icon-ig-highlight",hide:!0,action:function(){return f._openDialog(yc),!0}},{name:"show-control-break-dialog",labelKey:"APEX.IG.CONTROL_BREAK",icon:"icon-ig-control-break",action:function(){return f._openDialog(Cc),!0}},{name:"stretch-columns",labelKey:"APEX.IG.STRETCH_COLUMNS",hide:!0,get:function(){var a=f._view(),b=f._currentReportSettings().views[a];return b&&b.stretchColumns},set:function(a){var b=f._currentReportSettings(),c=f._view(),d=b.views[c];d&&(d.stretchColumns=a),f._setOperationUpdate(b),f._setReportSettings({changeIdentifier:"views.grid.columns"})}},{name:"change-rows-per-page",labelKey:"APEX.IG.ROWS_PER_PAGE",choices:[{labelKey:"APEX.IG.AUTO",value:"null"},{label:"5",value:5},{label:"10",value:10},{label:"15",value:15},{label:"20",value:20},{label:"25",value:25},{label:"50",value:50},{label:"100",value:100},{label:"1000",value:1e3}],get:function(){var a=f._currentReportSettings().rowsPerPage;return null===a?"null":a},set:function(a){var b=f._currentReportSettings();a="null"===a?null:parseInt(a,10),b.rowsPerPage=a,f._setOperationUpdate(b),f._setReportSettings({changeIdentifier:"rowsPerPage",refreshView:!0})}},{name:"save-report",labelKey:"APEX.IG.SAVE",icon:"icon-ig-save",action:function(){var a=f._currentReportSettings();f.updateReport(a.id,a)}},{name:"show-save-report-as-dialog",labelKey:"APEX.IG.SAVE_AS",icon:"icon-ig-save-as",action:function(){return f._openDialog(Ec),!0}},{name:"show-edit-report-dialog",labelKey:"APEX.IG.EDIT",icon:"icon-ig-edit",action:function(){return f._openDialog(Dc),!0}},{name:"delete-report",labelKey:"APEX.IG.DELETE",icon:"icon-ig-delete",action:function(){i.confirm(n("DELETE_REPORT_CONFIRM"),function(a){a&&f.deleteReport(f._report())})}},{name:"show-download-dialog",labelKey:"APEX.IG.DOWNLOAD",icon:"icon-ig-download",hide:!0,action:function(){return f._openDialog(Fc),!0}},{name:"show-help-dialog",labelKey:"APEX.IG.HELP",icon:"icon-ig-help",action:function(){var c=f.options.config;e.loadMessagesIfNeeded(["APEX.IG.HELP.ACTIONS.INTRO_HEADING","APEX.IG.HELP.ACTIONS.INTRO","APEX.IG.HELP.ACTIONS.REPORTING_HEADING","APEX.IG.HELP.ACTIONS.REPORTING","APEX.IG.HELP.ACTIONS.EDITING_HEADING","APEX.IG.HELP.ACTIONS.EDITING"],function(){function d(b,c){var d=a.extend({headingKey:"",helpText:"",helpTextKey:""},c);d.headingKey&&b.markup("<h2>").content(m(d.headingKey)).markup("</h2>"),d.helpText&&b.markup("<div").attr(ad,"apex-help-custom").markup(">").markup(d.helpText).markup("</div>"),d.helpTextKey&&b.markup("<p>").markup(m(d.helpTextKey)).markup("</p>")}var e=b.htmlBuilder();c.text.help&&d(e,{helpText:c.text.help}),d(e,{headingKey:"APEX.IG.HELP.ACTIONS.INTRO_HEADING",helpTextKey:"APEX.IG.HELP.ACTIONS.INTRO"}),d(e,{headingKey:"APEX.IG.HELP.ACTIONS.REPORTING_HEADING",helpTextKey:"APEX.IG.HELP.ACTIONS.REPORTING"}),c.editable&&d(e,{headingKey:"APEX.IG.HELP.ACTIONS.EDITING_HEADING",helpTextKey:"APEX.IG.HELP.ACTIONS.EDITING"}),h.popupFieldHelp({title:n("HELP.ACTIONS_TITLE"),helpText:e.toString()})})}},{name:"selection-mode",onLabelKey:"APEX.IG.SEL_MODE_CELL",offLabelKey:"APEX.IG.SEL_MODE_ROW",shortcut:"F8",hide:!0,get:function(){var a=f._currentViewImpl();return!a.view$||!a.supports.cellSelection||!a.selectCells()},set:function(a){var b=f._currentViewImpl();b.view$&&b.supports.cellSelection&&b.selectCells(!a)}},{name:"selection-duplicate",type:cd,labelKey:"APEX.IG.DUPLICATE_ROWS",icon:"icon-ig-duplicate",hide:!0,action:function(){var a,b=f._currentViewImpl();if(b.supports.edit&&(a=b.getSelectedRecords(),a.length>0))return b.model.copyRecords(a,null,a[a.length-1]),!0}},{name:"selection-delete",labelKey:"APEX.IG.DELETE_ROWS",icon:"icon-ig-delete",hide:!0,action:function(){var a,b,c=f._currentViewImpl();if(c.supports.edit){for(b=c.getSelectedRecords(),a=0;a<b.length;a++)c.model.allowDelete(b[a])||(b.splice(a,1),a-=1);b.length>0&&c.model.deleteRecords(b)}}},{name:"selection-refresh",labelKey:"APEX.IG.REFRESH_ROWS",icon:"icon-ig-refresh",hide:!0,action:function(){var a,b=f._currentViewImpl();b.supports.edit&&(a=b.getSelectedRecords(),a.length>0&&b.model.fetchRecords(a))}},{name:"selection-revert",labelKey:"APEX.IG.REVERT_CHANGES",icon:"icon-ig-revert",hide:!0,action:function(){var a,b,c=f._currentViewImpl();if(c.supports.edit){for(b=c.getSelectedRecords(),a=0;a<b.length;a++)c.model.canRevertRecord(b[a])||(b.splice(a,1),a-=1);b.length>0&&(c.model.revertRecords(b),f._updateSelectionActions())}}},{name:"selection-copy",labelKey:"APEX.IG.COPY_CB",icon:"icon-ig-copy",action:function(){var a=f._currentViewImpl();a.canCopy2Clipboard()&&(a.focus(),apex.clipboard.copy())}},{name:"refresh",labelKey:"APEX.IG.REFRESH",icon:"icon-ig-refresh",action:function(){f.refresh()}},{name:"reset-report",labelKey:"APEX.IG.RESET",disabled:!0,icon:"icon-ig-reset",action:function(){f._resetReportSettings()}},{name:"edit",labelKey:"APEX.IG.EDIT",hide:!0,get:function(){return f.editMode},set:function(a){f._setEditMode(a)}},{name:"save",labelKey:"APEX.IG.SAVE",hide:!0,shortcut:"Ctrl+Alt+S",action:function(){var a,b,c=f.options.config,d=f.editableViewImpl.model.name;k.anyErrors(!1,d,!0)?i.alert(m("APEX.CORRECT_ERRORS"),function(){}):(b=f.editableViewImpl.finishEditing(),b.done(function(){var b=null;void 0===c.saveLoadingIndicatorPosition&&void 0===c.saveLoadingIndicator||(b={loadingIndicatorPosition:c.saveLoadingIndicatorPosition||null,loadingIndicator:c.saveLoadingIndicator||null}),a=k.save(null,b,d,!0),a&&(a.done(function(a){var b,c,d="",e="";if(a.errors)i.clearErrors(),i.showErrors(a.errors),d=$c;else if(a.regions){for(b=0;b<a.regions.length;b++)c=a.regions[b],c.fetchedData&&c.fetchedData.successMessage&&(e&&(e+="<br>"),e+=c.fetchedData.successMessage);e||(e=n("CHANGES_SAVED")),i.showPageSuccess(e),d="success"}f._trigger(He,null,{status:d})}).fail(function(a,b,c){f._trigger(He,null,{status:"fail"})}).always(function(){f.actions.enable("save")}),f.actions.disable("save"))}))}},{name:"selection-add-row",label:g.text.addRowButton,hide:!0,action:function(){var a=f._currentViewImpl(),b=a.getSelectedRecords();return a.supports.singleRowView&&a.singleRowMode?void f.getActions().invoke("insert-record"):(a.focus(),a.model.insertNewRecord(null,b[b.length-1]),!0)}},{name:"single-row-view",label:n("SINGLE_ROW_VIEW"),icon:"icon-ig-single-row-view",hide:!0,action:function(a,b){var c,d=null,e=f.editMode,g=f._currentViewImpl();if(g.supports.singleRowView&&g.singleRowView$&&g.singleRowView$.length&&!g.singleRowMode)return b&&(d=g.getContextRecord(b)[0]),d||(d=g.getSelectedRecords()[0]),e&&g.view$.grid("setEditMode",!1),g.singleRowMode=!0,g.view$.hide(),g.curInst=g.singleRowView$.recordView("instance"),f._updateSummary(),c=f._toolbarFind("selection_submenu"),c&&(c.disabled=!0),g.singleRowView$.show().recordView(_b),d&&g.setSelectedRecords([d]),e?g.singleRowView$.recordView("setEditMode",!0):g.singleRowView$.recordView("focus"),!0}},{name:"row-add-row",label:n("ADD_ROW"),icon:"icon-ig-add-row",hide:!0,action:function(a,b){var c=f._currentViewImpl(),d=c.getContextRecord(b);return c.focus(),c.model.insertNewRecord(null,d[0]),!0}},{name:"row-duplicate",label:n("DUPLICATE_ROW"),icon:"icon-ig-duplicate",hide:!0,action:function(a,b){var c=f._currentViewImpl(),d=c.getContextRecord(b);return c.model.copyRecords(d,null,d[0]),!0}},{name:"row-delete",label:n("DELETE_ROW"),icon:"icon-ig-delete",hide:!0,action:function(a,b){var c=f._currentViewImpl(),d=c.getContextRecord(b);c.model.deleteRecords(d)}},{name:"row-refresh",label:n("REFRESH_ROW"),icon:"icon-ig-refresh",hide:!0,action:function(a,b){var c=f._currentViewImpl(),d=c.getContextRecord(b);c.model.fetchRecords(d)}},{name:"row-revert",label:n("REVERT_CHANGES"),icon:"icon-ig-revert",hide:!0,action:function(a,b){var c=f._currentViewImpl(),d=c.getContextRecord(b);c.focus(),c.model.revertRecords(d)}}])},_initToolbar:function(){var a,b=this.options.config.toolbarData,c=this;delete b.toolbarFind,delete b.toolbarRemove,delete b.toolbarInsertAfter,this.toolbar$=this._getElement("toolbar").toolbar({actionsContext:this.actions,data:b}),a=this.toolbar$.toolbar("findElement","actions_button_menu"),this.toolbar$.toolbar("findElement","column_filter_button").hide(),this.toolbar$.toolbar("findElement","search_field").hide(),this.toolbar$.toolbar("findElement","actions_button").hide(),this._currentReportSettings().defaultFilterColumn?this._setFilterColumn(this._currentReportSettings().defaultFilterColumn.columnId):this._setFilterColumn(null),a.on("menubeforeopen",function(){var b;b=a.menu("find","rows"),b&&(b.hide=c.options.config.pagination.type!==Mc)})},_getId:function(a){return a?this.idPrefix+"_"+a:""},_getIdSelector:function(a){return"#"+this._getId(a)},_getElement:function(b){return a(this._getIdSelector(b))},_setEditMode:function(a){function b(){f.setEditMode(h.editMode),a&&setTimeout(function(){f.focus()},100)}var c,d,e={},f=this._currentViewImpl(),g=!1,h=this,i=this.options.config.columns;if(this.editMode=a,a){for(c=0;c<i.length;c++)i[c].validation&&i[c].validation.isRequired&&(e[i[c].id]=i[c]);if(Object.keys(e).length>0){for(d=this._getCurrentView().columns,c=0;c<d.length;c++)e[d[c].columnId]&&!d[c].isVisible&&(d[c].isVisible=!0,this._setOperationUpdate(d[c]),g=!0);g&&this._setReportSettings({changeIdentifier:"views.grid.columns"},b)}}g||b()},_configureView:function(a){this.viewsImpl[a].isConfigured()&&this._view(a,{fetchData:!0}),this.viewsImpl[a].openDialog()},_getColumn:function(a){return this.columnMap[a]},_getColumnByName:function(a){var b,d=this.options.config.columns;for(b=0;b<d.length;b++)if(d[b].name===a)return d[b];c.warn("No column exists with name: ",a)},_getColumnByStaticId:function(a){var b,d=this.options.config.columns;for(b=0;b<d.length;b++)if(d[b].staticId===a)return d[b];c.warn("No column exists with static ID: ",a)},_getTextTransformClass:function(a){var b,c=a.filter.textCase,d={lower:Bb,upper:Cb};return c&&(b=d[c.toLowerCase()]),b},_convertNamesToLabels:function(a){var b,c=this.options.config.columns,d={};for(b=0;b<c.length;b++)d[c[b].name]=c[b].heading.label;return a&&""!==a?a.replace(/(")(.*?)(")/g,function(a,b,c){return'"'+d[c]+'"'}):a},_convertLabelsToNames:function(a){var b,c=this.options.config.columns,d={};for(b=0;b<c.length;b++)d[c[b].heading.label]=c[b].name;return a&&""!==a?a.replace(/(")(.*?)(")/g,function(a,b,c){return'"'+d[c]+'"'}):a},_getColumnFormatMask:function(a){var b,d,e=this._getColumn(a).appearance.dateFormatMask;if(e&&""!==e){b=apex.jQuery.datepicker.parseDate("yymmdd","20160302");try{d=apex.jQuery.datepicker.parseDate(e,apex.jQuery.datepicker.formatDate(e,b)),apex.jQuery.datepicker.formatDate("yymmdd",b)!==apex.jQuery.datepicker.formatDate("yymmdd",d)&&(c.warn("Date format mask is unusable for a date picker - using default: ",e),e="yy-mm-dd")}catch(f){c.warn("Date format mask is unusable for a date picker - using default: ",e),e="yy-mm-dd"}}else c.warn("No date format mask exists for column - using default: ",a),e="yy-mm-dd";return e},_getColumnLabel:function(a){var b,d=this._getColumn(a);return d.isHidden?c.info("_getColumnLabel called on hidden column, check calling logic",a):b=d.heading.label,b},_isColumnFilterable:function(a){var b=this._getColumn(a);return!b.specialType&&b.filter&&!b.isHidden},_hasColumnFilterLov:function(a){var b=this._getColumn(a);return b.filter&&b.filter.hasLov},_getColumnType:function(a){this._getColumn(a);return Ub},_getCurrentView:function(){var a=this._view(),b=this.options,c=b.config.views,d=c[a].useModelFrom;return d&&c[d].shareModel&&(a=d),b.savedReports[this.currentSavedReportIdx].views[a]},_currentViewImpl:function(){return this.viewsImpl[this._view()]},_view:function(b,c){var d,e,f,g,h,i,j,k,l=this,m=this.options.config,n=this.actions,o=!1,p=!1,q=this._currentReportSettings(),r=!1,s=[],t=a.extend({initialData:null,fetchData:!1},c);if(!b)return q.currentView;if(h=this._currentViewImpl(),this.viewsImpl[b].isConfigured()){q.currentView=b,g=this._currentViewImpl(),i=m.views[b].features,j=g.supports,h&&h.view$&&h.hide(),g.view$?(g.show(),this._updateModelRegionData(g),g.pendingRefresh&&(g.pendingRefresh=!1,g.refresh()),this._setReportSettings({changeIdentifier:"view.change"})):(this._getElement(g.elementId).show(),g.view$=this._getElement(g.elementId),g.setColumnConfig({baseModelColumns:this.baseModelColumns,igConfig:m,ig:this,currentReportSettings:q}),t.viewImpl=g,this._setModel(t),t.viewImpl.supports.edit&&(this.editableViewImpl=t.viewImpl),g.initView({ig$:this.element,ig:this,igConfig:m,currentReportSettings:q}),this._setInitialSelection(0),r=!0),e=this._refreshReportSettings(),this._updateSummary(),s.push({labelKey:"APEX.IG.ALL_TEXT_COLUMNS",value:null});for(f in g.modelColumns)if(g.modelColumns.hasOwnProperty(f)&&g.modelColumns[f].id&&this._isColumnFilterable(g.modelColumns[f].id)&&(o=!0,a.inArray(this._getColumn(g.modelColumns[f].id).filter.dataType,[Sd,Vd])!==-1))for(d=0;d<this._getColumn(g.modelColumns[f].id).filter.operators.length;d++)a.inArray(this._getColumn(g.modelColumns[f].id).filter.operators[d].name,["$perform$","C"])!==-1&&(p=!0,s.push({label:g.modelColumns[f].label,value:g.modelColumns[f].id}));m.filter.oracleText&&(p=!0),n.lookup("filter-column").choices=s,n.updateChoices("filter-column"),this._updateChangeViewActions(),this._toggleEnableAction(p,"search"),m.toolbar&&m.toolbar.searchField&&m.toolbar.columnSelection&&this.getToolbar().toolbar("findElement","column_filter_button").prop(gc,!p),r||e||g.resize(),this._toggleEnableAction(m.editable&&j.edit,["edit","save","selection-add-row","selection-add-row","row-add-row","selection-duplicate","row-duplicate","selection-delete","row-delete","selection-revert","row-revert","selection-refresh","row-refresh"]),this._toggleEnableAction(m.editable&&j.edit&&j.singleRowView,["insert-record","delete-record","refresh-record","revert-record","duplicate-record"]),this._toggleEnableAction(j.controlBreak&&i.controlBreak,"show-control-break-dialog"),this._toggleEnableAction(j.aggregation&&i.aggregate,"show-aggregate-dialog"),this._toggleEnableAction(j.highlight&&i.highlight,"show-highlight-dialog"),this._toggleEnableAction(j.changeRowsPerPage&&i.changeRowsPerPage,"change-rows-per-page"),this._toggleEnableAction(j.singleRowView&&i.singleRowView,"single-row-view"),this._toggleShowAction(g.canCopy2Clipboard(),"selection-copy"),this._toggleShowAction(j.cellSelection,"selection-mode"),k=this._toolbarFind("selection_submenu"),k&&(k.disabled=!j.selection),this._toggleEnableAction(j.configurableColumns,["show-columns-dialog","stretch-columns"]),this._toggleEnableAction(j.filter&&m.features.filter,"show-filter-dialog"),o||this._toggleEnableAction(!1,"show-filter-dialog"),this._toggleEnableAction(j.sort,"show-sort-dialog"),this._toggleEnableAction(j.download&&m.features.download,"show-download-dialog"),this._trigger(De,null,{view:b,created:r}),this._selectionChange(null),this._forEachView(function(a,c){c.viewChanged(a===b,l,m)})}else this.viewsImpl[b].openDialog()},_destroyAllModels:function(){var a=this;this._forEachView(function(b,c){a._setModel({viewImpl:c,remove:!0}),c.view$&&(c.hide(),c.destroyView(a),c.view$=null)})},_report:function(a){var b,c,d=this.options;if(!a)return this._currentReportSettings().id;for(this._destroyAllModels(),i.hidePageSuccess(),b=0;b<d.savedReports.length;b++)if(d.savedReports[b].id===a){this.currentSavedReportIdx=b;break}c=this._currentViewImpl(),this._forEachView(function(a,b){b.view$&&b.hide()}),c.view$||(c.view$=this._getElement(c.elementId)),this._updateSummary(),c.view$.show(),c.setColumnConfig({baseModelColumns:this.baseModelColumns,igConfig:d.config,currentReportSettings:this._currentReportSettings(),ig:this}),this.reportSettingsSeq+=1,this._setModel({viewImpl:c}),c.initView({ig$:this.element,ig:this,igConfig:d.config,currentReportSettings:this._currentReportSettings()}),this._updateActions(),this.editMode=!1,this.actions.update("edit"),this._updateChangeViewActions(),this._clearToolbarSearch(),this._trigger(De,null,{view:c.internalIdentifier,created:!0}),this._refreshReportSettings(),this._updateModelRegionData(c),this.refresh(),this._trigger(Ee,null,{report:this._report()})},_currentReportSettings:function(){return this.options.savedReports[this.currentSavedReportIdx]},_updateModelRegionData:function(a){var b=a.internalIdentifier,c=this.options.config.views,d=c[b].useModelFrom,e=a.model.getOption("regionData");e.reportId=this._report(),d&&c[d].shareModel&&(b=d),e.view=b},_updateSummary:function(){var a=this.getCurrentView(),b=a.title,c=this._currentReportSettings(),d=c.name;d||c.type!==rc||(d=n("PRIMARY_REPORT")),a.supports.singleRowView&&a.singleRowMode&&(b+=" ("+m("SINGLE_ROW_VIEW")+")"),this._getElement("summary").text(e.formatMessage("APEX.IG.SUMMARY",d,b))},_shortenString:function(a,b){var c=b?b:20;return a.length>c?a.substr(0,c)+"...":a},_adjustControlBreakSort:function(){var b,c,d=[],e=this,f=e._getCurrentView().columns;for(b=0;b<f.length;b++)!f[b].sort||null===f[b].sort.order||f[b]["break"]&&f[b]["break"].isEnabled||d.push({columnId:f[b].columnId,order:f[b].sort.order});for(d.sort(function(a,b){return a.order-b.order}),b=0;b<d.length;b++)for(c=0;c<f.length;c++)d[b].columnId===f[c].columnId&&a.extend(e._currentViewImpl().modelColumns[e._getColumn(f[c].columnId).name],{sortIndex:b+1})},_getSettingLabel:function(b,c){function d(a,b){return a&&null!==a.match(/^\d{14}/)?apex.jQuery.timepicker.formatCanonicalDate(t(a),b):""}var f,g,h="APEX.IG.",i=[ld,md,pd,qd,nd,od,rd,sd,vd,wd,Gd,Hd,Id,Jd],j=[td,ud],k=[Ad,Bd],l=[Cd,Dd,Ed,Fd];switch(b){case xc:switch(c.type){case Ub:h+="X.",a.inArray(c.operator,i)>-1&&(h+=ve[c.operator]+".Y",f=a.inArray(this._getColumn(c.columnId).filter.dataType,[Ud,Wd,Xd,Yd])>-1?e.formatMessage(h,this._getColumnLabel(c.columnId),d(c.hiddenValue?c.hiddenValue:c.value,this._getColumnFormatMask(c.columnId))):e.formatMessage(h,this._getColumnLabel(c.columnId),c.value)),a.inArray(c.operator,[xd,yd])>-1&&(h+=ve[c.operator]+".Y",f=e.formatMessage(h,this._getColumnLabel(c.columnId),c.value.split("").join(zd+" "))),a.inArray(c.operator,j)>-1&&(h+=ve[c.operator],f=e.formatMessage(h,this._getColumnLabel(c.columnId))),a.inArray(c.operator,k)>-1&&(h+=ve[c.operator]+".Y.AND.Z",g=c.hiddenBetween||c.hiddenAnd?[c.hiddenBetween,c.hiddenAnd]:c.value.split(Tc),f=a.inArray(this._getColumn(c.columnId).filter.dataType,[Ud,Wd,Xd,Yd])>-1?e.formatMessage(h,this._getColumnLabel(c.columnId),d(g[0],this._getColumnFormatMask(c.columnId)),d(g[1],this._getColumnFormatMask(c.columnId))):e.formatMessage(h,this._getColumnLabel(c.columnId),g[0],g[1])),a.inArray(c.operator,l)>-1&&(g=c.value.split(Tc),2!==g.length&&(g=["","MI"]),"1"===g[0]?(h+=ve[c.operator]+"_"+ye[g[1]],f=e.formatMessage(h,this._getColumnLabel(c.columnId))):(h+=ve[c.operator]+".Y."+ye[g[1]]+"S",f=e.formatMessage(h,this._getColumnLabel(c.columnId),g[0])));break;case Vb:f=c.name;break;case Tb:h+="SEARCH_FOR.X",f=e.formatMessage(h,c.value)}break;case Cc:f=this._getColumnLabel(c.columnId);break;case Bc:f=n(c["function"])+" ("+this._getColumnLabel(c.columnId)+")";break;case yc:f=this._shortenString(c.name?c.name:this._getColumnLabel(c.condition.columnId));break;case zc:1===c.minsAgo?(h+="REPORT_DATA_AS_OF_ONE_MINUTE_AGO",f=m(h)):(h+="REPORT_DATA_AS_OF.X.MINUTES_AGO",f=e.formatMessage(h,c.minsAgo))}return f},_getSettingSummaryLabel:function(a,b){var c,d="APEX.IG.";switch(a){case xc:switch(b.type){case Ub:c=this._getColumnLabel(b.columnId);break;case Vb:c=this._shortenString(b.name);break;case Tb:c="'"+this._shortenString(b.value,18)+"'"}break;case Cc:c=this._getColumnLabel(b.columnId);break;case yc:c=this._shortenString(b.name?b.name:this._getColumnLabel(b.condition.columnId));break;case zc:1===b.minsAgo?(d+="ONE_MINUTE_AGO",c=m(d)):(d+="X.MINUTES_AGO",c=e.formatMessage(d,b.minsAgo));break;case Bc:c=this._shortenString(this._getColumnLabel(b.columnId))}return c},_getTotalReportSettings:function(){var a,b=0,c=this._getCurrentView(),d=this._currentReportSettings();switch(d.filters&&(b+=d.filters.length),d.flashback&&(b+=1),this._view()){case jc:for(a=0;a<c.columns.length;a++)c.columns[a]["break"]&&(b+=1);c.highlights&&(b+=c.highlights.length),c.aggregations&&(b+=c.aggregations.length);break;case mc:c&&(b+=1)}return b},_renderReportSettings:function(b){function c(b){function c(b,c){var d={},f=a.extend({type:"",id:"",active:!1,label:"",excludeToggle:!1,isInvalid:!1,linkStyle:""},c),g=ka+" "+la+f.type;d.setting=f.type,d["setting-id"]=f.id,f.isInvalid&&(g+=" "+wb),b.markup("<li").attr(ad,g).attr("role","group").attr(Ib,"control_text"+f.id).markup(">"),b.markup("<span").attr(ad,ma).markup(">"),f.excludeToggle||(G(b,{id:h._getId("control_"+f.id),cssClasses:pa,checked:f.active,data:d,disabled:f.isInvalid}),J(b,{labelFor:h._getId("control_"+f.id),cssClasses:qa,label:n("TOGGLE"),labelTextHidden:!0})),b.markup("</span>"),b.markup("<span").attr(ad,ma).markup(">").markup("<span").attr(ad,mb+" "+ra+" "+Ga+x(f.type)).markup(">").markup("</span>").markup("</span>"),b.markup("<span").attr(ad,ma+" "+na).markup(">"),f.isInvalid?b.markup("<span").attr("id","control_text"+f.id).attr(ad,sa).markup(">").markup(f.label).markup("</span>"):(b.markup("<a href='#'").attr(ad,sa).attr("data-setting",f.type).attr("data-setting-id",f.id).optionalAttr("style",f.linkStyle).markup(">"),b.markup("<span").attr(ad,Ab).markup(">").content(n("EDIT")).markup("</span>"),b.markup("<span").attr("id","control_text"+f.id).markup(">").markup(f.label).markup("</span>"),b.markup("</a>")),b.markup("</span>"),b.markup("<span").attr(ad,ma+" "+oa).markup(">"),E(b,{buttonClass:fb+" "+gb+" "+Da+" "+Fa,iconOnly:!0,icon:pb,label:e.formatMessage("APEX.IG.REMOVE_CONTROL",xe[f.type]),data:d}),b.markup("</span>"),b.markup("</li>")}if(b.markup("<div").attr(ad,sb).markup(">"),b.markup("<ul").attr(ad,ja).markup(">"),j.views.chart&&h._view()===mc&&c(b,{type:mc,excludeToggle:!0,label:n("EDIT_CHART")}),j.filters)for(f=0;f<j.filters.length;f++)j.filters[f].operation!==Qc&&c(b,{type:xc,id:j.filters[f].id,active:j.filters[f].isEnabled,label:h._getSettingLabel(xc,j.filters[f]),isInvalid:j.filters[f].isInvalid});if(h._currentViewImpl().supports.controlBreak&&i){for(f=0;f<i.columns.length;f++)i.columns[f]["break"]&&i.columns[f]["break"].operation!==Qc&&g.push(i.columns[f]);if(g.length>0)for(g.sort(function(a,b){var c=a["break"].order,d=b["break"].order;return c<d?-1:c>d?1:0}),f=0;f<g.length;f++)c(b,{type:Cc,id:g[f].columnId,active:g[f]["break"].isEnabled,label:h._getSettingLabel(Cc,g[f])})}if(h._currentViewImpl().supports.highlight&&i.highlights)for(f=0;f<i.highlights.length;f++)i.highlights[f].operation!==Qc&&c(b,{type:yc,id:i.highlights[f].id,active:i.highlights[f].isEnabled,label:h._getSettingLabel(yc,i.highlights[f]),isInvalid:i.highlights[f].isInvalid,linkStyle:"background:"+i.highlights[f].backgroundColor+";color:"+i.highlights[f].textColor});if(h._currentViewImpl().supports.aggregation&&i.aggregations)for(f=0;f<i.aggregations.length;f++)i.aggregations[f].operation!==Qc&&c(b,{type:Bc,id:i.aggregations[f].id,active:i.aggregations[f].isEnabled,label:h._getSettingLabel(Bc,i.aggregations[f])});j.flashback&&j.flashback.operation!==Qc&&c(b,{type:zc,active:j.flashback.isEnabled,label:h._getSettingLabel(zc,j.flashback)}),b.markup("</ul></div>")}function d(b){function c(a,b,c){var g,i,j,k="",l=[],m=!0;for(g=0;g<c.length;g++)c[g].operation!==Qc&&(b===Cc?i=c[g]["break"].isEnabled:(i=c[g].isEnabled,j=c[g].isInvalid),j?f++:i?(l.push(g),m||(k+=", "),k+=h._getSettingSummaryLabel(b,c[g]),m=!1):e++);l.length>0&&d(a,{type:b,id:c[l[0]],count:l.length,label:k})}function d(b,c){var d=a.extend({type:"",id:"",count:0,label:""},c);b.markup("<li").attr(ad,xa+" "+ya+d.type).markup(">"),b.markup("<a href='#'").attr(ad,za).attr("data-setting",d.type).optionalAttr("data-setting-id",d.id).markup(">"),b.markup("<span").attr(ad,Aa).markup(">"),b.markup("<span").attr(ad,mb+" "+Ga+x(d.type)).markup("></span>"),(d.count>1||d.type===pc||d.type===qc)&&b.markup("<span").attr(ad,Ba).markup(">").content(d.count).markup("</span>"),b.markup("</span>"),b.markup("<span").attr(ad,Ca).markup(">").content(d.label).markup("</span>"),b.markup("</a>")}var e=0,f=0;b.markup("<div").attr(ad,wa),j.reportSettingsArea===dc&&b.attr("style","display:none;"),b.attr("id",h._getId("report_settings_summary")),k||b.attr("style","display:none;"),b.markup(">"),b.markup("<ul").attr(ad,va).markup(">"),j.views.chart&&h._view()===mc&&d(b,{type:mc,label:n("EDIT_CHART")}),j.filters&&c(b,xc,j.filters),g.length>0&&c(b,Cc,g),i.highlights&&c(b,yc,i.highlights),i.aggregations&&c(b,Bc,i.aggregations),j.flashback&&(j.flashback.isEnabled?d(b,{type:zc,label:h._getSettingSummaryLabel(zc,j.flashback)}):e++),e>0&&d(b,{type:pc,count:e,label:n(1===e?"INACTIVE_SETTING":"INACTIVE_SETTINGS")}),f>0&&d(b,{type:qc,count:f,label:n(1===e?"INVALID_SETTING":"INVALID_SETTINGS")}),b.markup("</ul></div>")}var f,g=[],h=this,i=this._getCurrentView(),j=this._currentReportSettings(),k=this._getTotalReportSettings()>0;b.markup("<div").attr(ad,qb+" "+ta).attr("id",this._getId("report_settings")),k||b.attr("style","display:none;"),b.markup(">"),b.markup("<div").attr(ad,rb).markup(">"),b.markup("<h3").attr(ad,Ab).markup(">").content(n("REPORT_SETTINGS")).markup("</h3>"),E(b,{buttonClass:fb+" "+Da+" "+Ea}),b.markup("</div>"),c(b),d(b),b.markup("</div>")},_initReportSettings:function(){function b(a,b,d){if(f.reportSettingsArea===a){var g=e.data("apex-collapsible").controllingElement$.is(":focus");f.reportSettingsArea=b,c._setOperationUpdate(f),c._setReportSettings({},function(){g&&c._getElement("report_settings").data("apex-collapsible").controllingElement$.focus()}),c._getElement("report_settings_summary")[d](),c.resize()}}var c=this,d=this.options.config.maxHeight,e=this._getElement("report_settings"),f=c._currentReportSettings();this._getTotalReportSettings()>0&&(this._on(e,{"click a.a-IG-controlsLabel":function(b){var c=a(b.currentTarget);this._openDialog(c.data("setting"),{id:c.data("setting-id")+""}),b.preventDefault()},"click a.a-IG-reportSummary-label":function(b){var c=a(b.currentTarget),d=c.data("setting");d===pc||d===qc?e.collapsible(cc):this._openDialog(d,{id:c.data("setting-id")+""}),b.preventDefault()},"click input.a-IG-controlsCheckbox":function(b){var c=a(b.target),d=c.prop(hc),e=c.data("setting"),f=c.data("setting-id")+"";switch(e){case xc:this.updateFilter(f,{isEnabled:d});break;case Bc:this.updateAggregate(f,{isEnabled:d});break;case yc:this.updateHighlight(f,{isEnabled:d});break;case Cc:this.updateControlBreak(f,{isEnabled:d});break;case zc:this.updateFlashback({isEnabled:d})}},"click button.a-IG-button--remove":function(b){var c=a(b.currentTarget),d=c.data("setting"),e=c.data("setting-id")+"";switch(b.preventDefault(),d){case xc:this.deleteFilter(e);break;case Bc:this.deleteAggregate(e);break;case yc:this.deleteHighlight(e);break;case Cc:this.deleteControlBreak(e);break;case zc:this.deleteFlashback();break;case mc:this.deleteChart()}}}),e.collapsible({content:"div."+sb,collapsed:f.reportSettingsArea===ec,
collapse:function(){b(dc,ec,ac)},expand:function(){b(ec,dc,bc)}}),d&&e.find(".a-Collapsible-content").css({"max-height":(d-a(W,this.element).outerHeight())/3+"px",overflow:"auto"}))},_isSettingsCheckboxFocused:function(b,c){var d;return!(!document.activeElement||"checkbox"!==document.activeElement.type)&&(d=a(document.activeElement).data(),d.setting===c&&""+d.settingId===b)},_focusOnSettingsCheckbox:function(a,b,c){var d;a&&(d="."+pa+"[data-setting="+c+"]",b&&(d+="[data-setting-id="+b+"]"),this._getElement("report_settings").find(d).focus())},_currentViewColumn:function(b,c){var d,e,f=this._getCurrentView().columns;for(d=0;d<f.length;d++)if(f[d].columnId===b){e=f[d];break}return a.isPlainObject(c)&&(e=a.extend(!0,e,c),this._setOperationUpdate(e)),e},_refreshReportSettings:function(){var a,c=this._getElement("report_settings"),d=b.htmlBuilder();return!(!c[0]||(a=c[0].clientHeight,this._renderReportSettings(d),c.replaceWith(d.toString()),this._initReportSettings(),a===this._getElement("report_settings")[0].clientHeight))&&(this.resize(),!0)},_defaultAjaxRegionData:function(b){var c=this.options.config,d=a.extend(!0,{id:c.regionId,ajaxIdentifier:c.ajaxIdentifier,ajaxColumns:c.ajaxColumns,reportId:this._report(),view:this._view()},b);return this._isCurrentlyEditable()&&(d.allowedOperations=c.editable.allowedOperations["protected"]),d},_call:function(a,b){var c=this.options.config,e=this._defaultAjaxRegionData(a),f={regions:[e]};return c.parentRegionStaticId&&this.parentItemValues.length>0&&(f.regions[0].parentItems={values:this.parentItemValues}),c.loadingIndicator&&(b.loadingIndicator=c.loadingIndicator),(c.callServer||d.plugin)(f,b)},_setReportSettings:function(b,c){function d(a){var b;for(b=0;b<a.length;b++)a[b].operation||(a.splice(b,1),b-=1)}var e,f,g={},h=this.options.config,j=this,k=a.extend({refreshView:!1,refreshModel:!1,affectsOtherViewsModels:!1,refreshColumns:!1,changeIdentifier:""},b);return e=a.extend(!0,{},this._currentReportSettings()),e.filters&&e.filters.length>0&&d(e.filters),h.views.grid&&d(e.views.grid.columns),h.views.icon&&d(e.views.icon.columns),h.views.detail&&d(e.views.detail.columns),h.features.saveReport&&h.features.saveReport.publicReportCs&&(g.publicReportCs=h.features.saveReport.publicReportCs),f={success:function(a){var b,d=j._defaultSavedReport(a.regions[0].setReportSettings[0]);i.hidePageSuccess(),j._view()!==d.currentView&&j._view(d.currentView,{fetchData:!0}),j.options.savedReports[j.currentSavedReportIdx]=d,j._updateChangeReportAction(),j._updateChangeViewActions(),j._updateReportSettingsActions(),j._refreshReportSettings(),b=j._currentViewImpl(),j._updateModelRegionData(b),d=j._currentReportSettings(),j._forEachView(function(a,b){b.setReportOptions(j,a===d.currentView,d,k.changeIdentifier),b.supports.highlight&&"views.grid.highlights"!==k.changeIdentifier&&b.setReportOptions(j,a===d.currentView,d,"views.grid.highlights")}),k.refreshColumns&&b.refreshColumns(),k.refreshView?b.refresh():k.refreshModel&&(j.reportSettingsSeq+=1,k.affectsOtherViewsModels?j._forEachView(function(a,b){b.model&&b.clearModelData()}):b.clearModelData()),c&&c(),j._trigger(Fe,null,{report:d.id})}},"view.change"===k.changeIdentifier&&(f.queue={name:"set.report.settings.replace",action:"replace"}),a.extend(g,{setReportSettings:[e]}),this._call(g,f)},_downloadReport:function(a){var b,e,f=this.options.config,h=this;b={pageItems:f.itemsToSubmit,regions:[{id:f.regionId,ajaxIdentifier:f.ajaxIdentifier,ajaxColumns:f.ajaxColumns,reportId:this._report(),view:this._view(),download:a}],salt:$v("pSalt")},e=g(f.regionStaticId).getParentItems(),e&&(b.regions[0].parentItems=e),a.email?d.plugin(b,{dataType:Mb,success:function(a){i.showPageSuccess(n("EMAIL_SENT"))}}):d.plugin(b,{success:function(a){var b;i.showPageSuccess(n("FILE_PREPARED")),b=d.ajaxUrl({regions:[{id:f.regionId,reportId:h._report(),ajaxIdentifier:f.ajaxIdentifier,downloadFileId:a.regions[0].download.id}],salt:$v("pSalt")}),c.info("Calling URL to get file:",b),c.info("URL length:",b.length),window.open(b)}})},_saveReport:function(a,b){var d,e={},f=this,g=this.options.config;return g.features.saveReport?(e.saveReport=a,g.features.saveReport.publicReportCs&&(e.publicReportCs=g.features.saveReport.publicReportCs),this._call(e,{success:function(a){switch(f.options.savedReports=f._defaultSavedReports({reports:a.regions[0].savedReports}),f._updateChangeReportAction(),f._updateReportSettingsActions(),f._refreshReportSettings(),f._updateModelRegionData(f._currentViewImpl()),b){case Oc:case Pc:switch(f._currentReportSettings().type){case rc:d=n("REPORT.SAVED.DEFAULT");break;case sc:d=n("REPORT.SAVED.ALTERNATIVE");break;case tc:d=n("REPORT.SAVED.PRIVATE");break;case uc:d=n("REPORT.SAVED.PUBLIC")}break;case Qc:d=n("REPORT.DELETED")}i.showPageSuccess(d),b===Qc&&f.refresh()}})):void c.warn("Unable to save report settings because the configuration disallows it.")},_getFilterValues:function(b,c,d){var e=this;return this._call({getFilterValues:{columnId:b,columnType:Ub,respectFilters:c}},{success:function(b){a.isFunction(d)&&d.call(e,b)}})},_updateChangeReportAction:function(){var a,b,c,d,e=[],f=this.options.config,g=this.options.savedReports,h=this.actions;if(g.length>1){for(a=0;a<g.length;a++){switch(b=g[a],d=b.name,b.type){case rc:c="APEX.IG.SAVED_REPORT_DEFAULT",b.name||(d=n("PRIMARY_REPORT"));break;case sc:c="APEX.IG.SAVED_REPORT_DEFAULT";break;case tc:c="APEX.IG.SAVED_REPORT_PRIVATE";break;case uc:c="APEX.IG.SAVED_REPORT_PUBLIC"}e.push({group:m(c),label:d,value:b.id})}this.actions.lookup("change-report").hide=!(!f.toolbar||f.toolbar&&f.toolbar.savedReports)}else this.actions.lookup("change-report").hide=!0;this.actions.update("change-report"),h.lookup("change-report").choices=e,h.updateChoices("change-report")},_updateAction:function(a,b){this.actions.lookup(b)&&this.actions[a](b)},_toggleEnableAction:function(a,b){this._toggleAction("enable",a,b)},_toggleShowAction:function(a,b){this._toggleAction(ac,a,b)},_toggleAction:function(b,c,d){var e,f=this;switch(b){case ac:e=c?ac:bc;break;case"enable":e=c?"enable":"disable"}a.isArray(d)?a.each(d,function(){f._updateAction(e,this)}):this._updateAction(e,d)},_updateToolbarElements:function(){var a=this.options.config,b=a.toolbar;b&&(b.searchField&&(b.columnSelection&&this.toolbar$.toolbar("findElement","column_filter_button").show(),this.toolbar$.toolbar("findElement","search_field").show()),b.actionMenu&&this.toolbar$.toolbar("findElement","actions_button").show())},_updateActions:function(){var a=this,b=this.options.config,c=b.features,d=!1,e=!1,f=!1,g=this._isCurrentlyEditable(),h=b.editable.allowedOperations,i=g&&h.create,j=g&&h[Zb],k=g&&(h.update||h[Zb]),l=b.toolbar,m=g&&(h.update||h.create)&&(!l||l&&l.editing),n=g&&(h.create||h.update||h[Zb])&&(!l||l&&l.save),o=!l||l&&l.searchField,p=!l||l&&l.reset,q=b.pagination.type===Mc;c.saveReport&&this._updateChangeReportAction(),this._toggleShowAction(c.filter,"show-filter-dialog"),this._toggleShowAction(c.download,"show-download-dialog"),this._toggleShowAction(c.flashback,"show-flashback-dialog"),this._updateReportSettingsActions(),this._toggleShowAction(i,["selection-add-row","row-add-row","selection-duplicate","row-duplicate"]),this._toggleShowAction(j,["selection-delete","row-delete"]),this._toggleShowAction(k,["selection-revert","row-revert"]),this._toggleShowAction(g,["selection-refresh","row-refresh"]),this._toggleShowAction(m,"edit"),this._toggleShowAction(n,"save"),this._toggleShowAction(o,"search"),this._toggleShowAction(p,"reset-report"),this._forEachView(function(c,h){var k=b.views[c].features;h.supports.singleRowView&&k.singleRowView&&(d=!0),h.supports.highlight&&k.highlight&&(e=!0),h.supports.configurableColumns&&null===k.stretchColumns&&k.gridView!==!1&&(f=!0),h.updateActions({ig:a,editable:g,canDelete:j,canCreate:i,canEdit:m})}),this._toggleShowAction(d,"single-row-view"),this._toggleShowAction(i&&d,["insert-record","duplicate-record"]),this._toggleShowAction(j&&d,["delete-record"]),this._toggleShowAction(k&&d,["revert-record"]),this._toggleShowAction(g&&d,["refresh-record"]),this._toggleShowAction(e,"show-highlight-dialog"),this._toggleShowAction(q,"change-rows-per-page"),this._toggleShowAction(f,"stretch-columns")},_updateReportSettingsActions:function(){var a=this._currentReportSettings(),b=this.options.config.features.saveReport,c=!a.isReadOnly;this._toggleEnableAction(b&&c&&a.baseReportId,"save-report"),this._toggleEnableAction(b,"show-save-report-as-dialog"),this._toggleEnableAction(b&&c,"show-edit-report-dialog"),this._toggleEnableAction(b&&c&&a.type!==rc,"delete-report"),this._toggleEnableAction(a.baseReportId,"reset-report")},_updateChangeViewActions:function(){var a=[],b=this.actions;this._forEachView(function(b,c){c.isConfigured()&&a.push({label:c.title,value:b,icon:c.icon})}),this._toggleShowAction(a.length>1,"change-view"),b.lookup("change-view").choices=a,b.updateChoices("change-view")},_updateSelectionActions:function(){var a,b,c,d,e,f=this.options.config,g=this._currentViewImpl();f.editable&&g.supports.edit&&(g.view$.grid("option","selectCells")?(c=g.view$.grid("getSelectedRange").recordIds,a=this._isCurrentlyEditable()&&0!==c.length,this._toggleEnableAction(a,["selection-fill","selection-clear","selection-revert"]),this._toggleEnableAction(!1,["selection-duplicate","selection-refresh","selection-delete","selection-revert","selection-copy","row-delete"]),this._toggleEnableAction(c.length>=2,["selection-copy-down"])):(b=g.getSelectedRecords(),a=this._isCurrentlyEditable()&&0!==b.length,this._toggleEnableAction(a,["selection-duplicate","selection-refresh","selection-delete","selection-revert","selection-copy","selection-fill","selection-clear"]),f.editable.allowedOperations[Zb]&&(d=b.some(function(a){return g.model.allowDelete(a)}),this._toggleEnableAction(d,["row-delete","selection-delete","selection-fill","selection-clear"])),e=b.some(function(a){return g.model.canRevertRecord(a)}),this._toggleEnableAction(e,["row-revert","selection-revert"]),this._toggleEnableAction(b.length>=2,["selection-copy-down"])))},_setFilterColumn:function(a){var b;this.currentFilterColumnId=a,b=a?e.formatMessage("APEX.IG.SEARCH.COLUMN",this._getColumn(a).heading.label):n(this.options.config.filter.oracleText?"SEARCH.ORACLE_TEXT":"SEARCH.ALL_COLUMNS"),this.toolbar$.toolbar("findElement","search_field").attr({placeholder:b,title:b})},_defaultIGConfig:function(){var b,c,d=this.options.config;if(d.filter.maxRowCount&&(d.text.moreDataFound=e.formatMessage("APEX.IG.MORE_DATA_FOUND",d.filter.maxRowCount)),d.columnGroups.length>0)for(b=0;b<d.columnGroups.length;b++)c=a.extend({id:"",heading:"",label:""},d.columnGroups[b]),c.label||(c.label=c.heading),d.columnGroups[b]=c;d.editable&&(d.editable=a.extend(!0,{allowedOperations:{create:!0,update:!0,"delete":!0,"protected":""},autoAddRow:!0},d.editable),d.editable.allowedOperations.create||(d.editable.autoAddRow=!1)),d.features.download&&(d.features.download=a.extend({formats:[],email:!0},d.features.download)),d.views.icon&&(d.views.icon=a.extend(!0,{disabled:!1,labelColumn:"",features:{sort:!0,highlight:!0,rowSelector:{multiSelect:!0,selectAll:!1,hideControl:!1}}},d.views.icon)),d.views.detail&&(d.views.detail=a.extend(!0,{disabled:!1,beforeRows:"",row:"",afterRows:"",features:{sort:!0,controlBreak:!0}},d.views.detail))},_defaultColumns:function(){var b,c,d=this.options.config.columns;for(b=0;b<d.length;b++)c=a.extend(!0,{id:"",name:"",staticId:"",dataType:Sd,specialType:"",isHidden:!1,isReadOnly:!0,heading:{heading:"",label:"",alignment:Xb},layout:{columnAlignment:Wb,groupId:"",useGroupFor:"both"},appearance:{columnCssClasses:"",formatExample:""},validation:{isRequired:!1,restrictedCharacters:""},link:{text:"",attributes:""},filter:{operators:[{name:"$std$"},{name:"$perform$"}],dateRanges:id,isRequired:!1,hasLov:!0,dataType:Sd},accessibility:{usedAsRowHeader:!1},features:{canHide:!0,highlight:!0,compute:!0,sort:!0,controlBreak:!0,aggregate:!0,groupBy:!0},isPrimaryKey:!1,parentColumnName:"","default":{value:"",duplicate:!0},escape:!0,helpid:""},d[b]),c.heading.label||(c.heading.label=c.heading.heading),c.filter.dataType!==Sd||c.filter.textCase||(c.filter.textCase=Rd),d[b]=c},_createBaseColumnMap:function(){var a,b,c,d=this.options.config.columns,e=0;for(a=0;a<d.length;a++)b=d[a],c=this.baseModelColumns[b.id]={index:a-e,hidden:b.isHidden,readonly:b.isReadOnly,escape:b.escape,id:b.id},b.isHidden?c.canHide=!1:(c.heading=b.heading.heading,c.headingAlignment=b.heading.alignment,c.label=b.heading.label,c.alignment=b.layout.columnAlignment),b.parentColumnName&&(c.parentField=b.parentColumnName,this.parentColumnNames.push(b.parentColumnName)),this.columnMap[b.id]=b,b.isPrimaryKey&&this.primaryKeyColumns.push(b.name),"actions"===b.specialType&&(e+=1);this.baseModelColumns[Wc]={index:a-e,seq:a,hidden:!0,canHide:!1}},_defaultSavedReport:function(b){function d(b,c){var d,e,f,g={};if(c){for(d=0;d<b.length;d++)g[b[d].columnId]=1;for(d=0;d<m.columns.length;d++)e=m.columns[d],g[e.id]||b.push({columnId:e.id,operation:Oc,isVisible:!1})}for(d=0;d<b.length;d++)f=a.extend({seq:null,columnType:Ub,columnId:"",isVisible:!0,isFrozen:!1,width:null,priority:null,"break":!1,sort:!1},b[d]),f.seq=d+1,f["break"]&&(f["break"]=a.extend({order:null,isEnabled:!0,direction:Gc,nulls:Jc},f["break"])),f.sort&&(f.sort=a.extend({order:null,direction:Gc,nulls:Jc},f.sort)),l._getColumn(f.columnId)?b[d]=f:(b.splice(d,1),d-=1)}var e,f,g,h,i,j,k,l=this,m=this.options.config,n=m.views;if(f=a.extend(!0,{id:"",baseReportId:"",name:"",isCurrent:!1,type:rc,isReadOnly:!0,authorizationId:"",rowsPerPage:null,showRowNumbers:!1,reportSettingsArea:ec,defaultFilterColumn:!1,flashback:!1,versionNumber:"",filters:[],currentView:jc,views:{grid:!1,chart:!1,icon:!1,detail:!1}},b),!n[f.currentView]||n[f.currentView].disabled){f.currentView=null;for(e in n)if(n.hasOwnProperty(e)&&n[e]&&!n[e].disabled){f.currentView=e;break}this.options.data=null,m.lazyLoading=!0,c.warn("Current view not available. Using view %s. Forcing lazy load.",f.currentView)}for(f.flashback&&(f.flashback=a.extend({minsAgo:null,isEnabled:!0},f.flashback)),e=0;e<f.filters.length;e++)g=a.extend(!0,{id:"",type:Tb,isCaseSensitive:!1,value:"",isEnabled:!0},f.filters[e]),g.columnId&&!g.columnType&&(g.columnType=Ub),g.type!==Ub||this._getColumn(g.columnId)?f.filters[e]=g:(f.filters.splice(e,1),e-=1);if(f.views.grid||n.grid){for(f.views.grid=a.extend(!0,{editMode:!1,singleRowView:{excludeNullValues:!1,onlyDisplayColumns:!0},columns:[],aggregations:[],highlights:[],initialBreakState:ec,stretchColumns:!0},f.views.grid),d(f.views.grid.columns,!0),e=0;e<f.views.grid.aggregations.length;e++)h=a.extend({id:"","function":"",columnType:Ub,columnId:"",tooltip:"",showGrandTotal:!0,isEnabled:!0},f.views.grid.aggregations[e]),h.label||(h.label=h["function"]),this._getColumn(h.columnId)?f.views.grid.aggregations[e]=h:(f.views.grid.aggregations.splice(e,1),e-=1);for(e=0;e<f.views.grid.highlights.length;e++)i=a.extend(!0,{id:"",name:"",type:Tb,columnType:Ub,columnId:"",backgroundColor:"",textColor:"",condition:{type:Ub,columnType:Ub,columnId:"",operator:"",isCaseSensitive:!1,value:"",expression:""},isEnabled:!0},f.views.grid.highlights[e]),i.type===Ub&&!this._getColumn(i.columnId)||i.condition.type===Ub&&!this._getColumn(i.condition.columnId)?(f.views.grid.highlights.splice(e,1),e-=1):f.views.grid.highlights[e]=i}if((f.views.icon||n.icon)&&(f.views.icon=a.extend(!0,{columns:[],initialBreakState:ec},f.views.icon),d(f.views.icon.columns)),(f.views.detail||n.detail)&&(f.views.detail=a.extend(!0,{columns:[],initialBreakState:ec},f.views.detail),d(f.views.detail.columns)),f.views.chart){f.views.chart=a.extend(!0,{type:$d,orientation:ke,stack:ne},f.views.chart),f.views.chart.axis&&(f.views.chart.axis=a.extend({label:"",value:"",valueDecimalPlaces:""},f.views.chart.axis));for(j in f.views.chart.chartColumns)f.views.chart.chartColumns.hasOwnProperty(j)&&(k=f.views.chart.chartColumns[j],k=a.extend({columnType:Ub},k),k.sort&&(k.sort=a.extend({order:null,direction:Gc,nulls:Jc},k.sort)),f.views.chart.chartColumns[j]=k)}return f},_defaultSavedReports:function(b){var c,d=!1,e=a.extend({reports:this.options.savedReports},b);for(c=0;c<e.reports.length;c++)e.reports[c]=this._defaultSavedReport(e.reports[c]),e.reports[c].isCurrent&&(d=!0,this.currentSavedReportIdx=c);return d||(this.currentSavedReportIdx=0),e.reports},_renderColumnHeaderMenu:function(b,c,d,e){function f(b,c){var d=a.extend(!0,{buttonClass:"a-IRR-button "+Pa,label:"",iconOnly:!0,icon:"",isToggle:!1,toggleState:null,attributes:{},data:{}},c);b.markup("<li").attr(ad,Oa).markup(">"),d.isToggle&&(d.attributes["aria-pressed"]=d.toggleState,d.toggleState&&(d.buttonClass+=" "+tb),delete d.isToggle,delete d.toggleState),E(b,d),b.markup("</li>")}var g,h,i,j=!1,k=this._getId("column_header_search"),l=this._getColumn(e),m=this._currentReportSettings().views.grid.columns,o=0;for(b.markup("<ul").attr(ad,Na).markup(">"),l.features.controlBreak&&f(b,{label:n("CONTROL_BREAK"),icon:"icon-ig-control-break",data:{option:"break"}}),l.features.aggregate&&f(b,{label:n("AGGREGATE"),icon:"icon-ig-aggregate",data:{option:"aggregate"}}),g=0;g<m.length;g++)if(m[g].columnId===e){j=m[g].isFrozen;break}for(g=0;g<m.length;g++)m[g].isVisible&&!this._getColumn(m[g].columnId).isHidden&&m[g].seq>o&&(o=m[g].seq),m[g].columnId===e&&(i=m[g].seq);i<o&&f(b,{label:n(j?"UNFREEZE":"FREEZE"),icon:"icon-ig-frozen-column",isToggle:!0,toggleState:j,data:{option:"freeze"}}),l.features.canHide&&f(b,{label:n("HIDE"),icon:"icon-ig-remove-col",data:{option:bc}}),l.helpid&&f(b,{label:n("HELP"),icon:"icon-ig-help",data:{option:"help"}}),b.markup("</ul>"),c&&(b.markup("<div").attr(ad,Qa).markup(">"),J(b,{labelFor:k,cssClasses:Ra,label:n("SEARCH"),labelTextHidden:!0}),l.filter.textCase&&(h=this._getTextTransformClass(l)),A(b,{id:k,cssClasses:Sa+(h?" "+h:""),placeholder:n("FILTER_WITH_DOTS")}),d&&(b.markup("<div").attr(ad,Ta).attr("id",this._getId("column_header_menu_rows")).markup(">"),b.markup("</div>")),b.markup("</div>"))},_setOperationUpdate:function(a){a.operation&&a.operation===Oc||(a.operation=Pc)},_renderIG:function(){var a=this,c=this.element,d=b.htmlBuilder(),e=this.options.config,f=this._getId("summary");d.markup("<div").attr(ad,V).markup(">"),e.toolbar&&e.toolbarData&&d.markup("<div").attr("id",this._getId("toolbar")).markup(">").markup("</div>"),d.markup("</div>"),d.markup("<div").attr(ad,Y).markup(">"),e.reportSettingsArea&&this._renderReportSettings(d),d.markup("<div class='u-vh'").attr("id",f).markup("></div><div").attr(ad,_).attr("id",this._getId("content_container")).markup(">"),this._forEachView(function(b,c){d.markup("<div").attr("id",a._getId(c.elementId)).attr(ad,c.cssClass).attr(Ib,f).markup(" style='display:none'></div>")}),d.markup("</div></div>"),c.append(d.toString()),e.reportSettingsArea&&this._initReportSettings()},_resetReportSettings:function(){var a=this;this._ifNoChangesDo(function(b){if(a._currentReportSettings().baseReportId)return a._call({resetReportSettings:[a._report()]},{success:function(c){var d=a._defaultSavedReport(c.regions[0].resetReportSettings[0]);a.options.savedReports[a.currentSavedReportIdx]=d,b&&a.clearChanges(),a._report(d.id),a._updateChangeReportAction()}})})},_openDialog:function(a,b){function c(a){var b=a+"Dialog$",c="_render"+a.substr(0,1).toUpperCase()+a.substr(1)+"Dialog";return f[b]||f[c](),f[b]}function d(a,b){var d=c(a);b&&d.dialog(ic,"id",b),d.dialog("open")}var e,f=this;switch(b=b||{},a){case wc:case xc:case Ac:case yc:case Cc:d(a,b.id);break;case Bc:c(a).dialog(ic,{id:b.id,columnId:b.columnId}).dialog("open");break;case zc:e=f._currentReportSettings().flashback,e=e?e.minsAgo:5,R({labelKey:"APEX.IG.MINUTES_AGO",titleKey:"APEX.IG.FLASHBACK",okLabelKey:"APEX.DIALOG.SAVE",helpKey:"APEX.IG.HELP.FLASHBACK",helpTitleKey:"APEX.IG.HELP.FLASHBACK_TITLE",value:e},function(a){a!==!1&&f.updateFlashback({isEnabled:!0,minsAgo:parseInt(a,10)})});break;case mc:this.viewsImpl[mc].openDialog();break;case Dc:c("reportSettings").dialog(ic,"saveAs",!1).dialog("open");break;case Ec:c("reportSettings").dialog(ic,"saveAs",!0).dialog("open");break;case Fc:d(a)}},_setModel:function(b){var c,d,e,f,g,h,i,j,l,m,n,o=!1,p=!1,q=!1,r=this.options.config,s=r.pagination.showTotalRowCount,t=b.viewImpl,u=t.internalIdentifier,v=r.views[u];t.model&&(k.release(t.modelName),t.modelName=null,t.model=null),b.remove||(v.useModelFrom&&r.views[v.useModelFrom].shareModel?(l=this.getViews(v.useModelFrom),m=l.internalIdentifier,j=m+"_shared"):(l=t,m=u,j=v.shareModel?m+"_shared":m),n=this._isCurrentlyEditable()&&l.supports.edit,n&&(o=r.editable.allowedOperations.create,p=r.editable.allowedOperations.update,q=r.editable.allowedOperations[Zb]),r.parentRegionStaticId&&null===r.modelInstanceId&&(n=!1),i=r.modelInstanceId?[r.regionStaticId+"_"+j,r.modelInstanceId]:r.regionStaticId+"_"+j,t.modelName=i,t.model=k.get(i),t.model||(l.supports.totalRows||(s=!1),c=a.extend({},r.defaultModelOptions,{recordIsArray:!0,hasTotalRecords:s,regionId:r.regionId,regionStaticId:r.regionStaticId,ajaxIdentifier:r.ajaxIdentifier,pageItemsToSubmit:r.itemsToSubmit,parentRecordId:this.parentRecordId,fields:t.modelColumns,editable:n,saveSelection:n&&r.submitSelectedRows,paginationType:Nc,regionData:{reportId:this._report(),view:m,ajaxColumns:r.ajaxColumns}}),c.types||(c.types={"default":{operations:{canAdd:o,canEdit:p,canDelete:q}}}),a.each(["identityField","metaField","typeField","sequenceField"],function(a,b){t.specialColumns[b]&&(c[b]=t.specialColumns[b])}),r.parentRegionStaticId&&(this.parentModel?c.parentModel=this.parentModel:(d=a("#"+r.parentRegionStaticId+"_ig"),c.parentModel=r.parentRegionStaticId+"_"+d.interactiveGrid("getCurrentViewId"))),n&&(c.regionData.allowedOperations=r.editable.allowedOperations["protected"]),b.initialData?(e=b.initialData.values,f=s?b.initialData.totalRows:null,g=b.initialData.moreData,h=b.initialData.dataOverflow,t.model=k.create(i,c,e,f,g,h)):b.fetchData?t.model=k.create(i,c):t.model=k.create(i,c,[],0),this.modelReportSettingsSeq[i]=this.reportSettingsSeq),this._trigger(Ge,null,{viewId:u,model:t.model}),b.updateComponent&&(this.reportSettingsSeq>this.modelReportSettingsSeq[i]&&(this._updateModelRegionData(t),t.clearModelData()),t.setModelName(t.modelName,t.modelColumns)))},_anyChanges:function(){var a=this.editableViewImpl;return!!(a&&this._isCurrentlyEditable()&&a.model&&k.anyChanges(!1,a.model.name,!0))},_ifNoChangesDo:function(a,b){var c=this,d=this._anyChanges();b||(b=a,a=!1),d?a||setTimeout(function(){i.confirm(n("UNSAVED_CHANGES_CONTINUE_CONFIRM"),function(a){a?(c._setEditMode(!1),b(d)):c._refreshReportSettings()})},1):b(d)},_clearToolbarSearch:function(){var a=this.options.config;a.toolbar&&a.toolbar.searchField&&a.toolbarData&&this.toolbar$.toolbar("findElement","search_field").val("")},_toolbarFind:function(a){var b=null,c=this.getToolbar();return c&&(b=c.toolbar("find",a)),b},resize:function(){var b,c,d,e,f=this.options.config,g=0,h=0,i=this.element,j=i.width(),k=this._currentViewImpl(),l=a(aa,i).children().addBack();this.ignoreResizeHandler=!0,l.width(j),f.maxHeight&&(b=i.height(),d=a(W,i),e=a(ua,i),d.filter(":visible").length>0&&(g=d.outerHeight()),e.filter(":visible").length>0&&(h=e.outerHeight()),c=b-(g+h),l.height(c)),a.apex.stickyWidget&&i.find(".a-IG-header.js-stickyWidget-toggle").stickyWidget($b),k&&k.view$&&k.resize(),this.ignoreResizeHandler=!1},refresh:function(){var a=this;this._ifNoChangesDo(function(){a._forEachView(function(a,b){b.model&&b.clearModelData()})})},clearChanges:function(){var a;this.editableViewImpl&&(a=this.editableViewImpl.model,a&&a.isChanged()&&a.clearChanges())},setMasterRecord:function(a,b){return this.options.config.parentRegionStaticId?(this.parentModel=a.modelId(),void(b?this._setModelInstance(a.getRecordId(b),a,b):this._setModelInstance(null))):void c.warn("No master region defined.")},gotoCell:function(a,b,c){var d;this._view()!==this.editableView&&this._view(this.editableView),d=this._currentViewImpl(),a&&this._setModelInstance(a),d.gotoCell&&d.gotoCell(b,c)},getActions:function(){return this.actions},getToolbar:function(){return this.toolbar$},getSelectedRecords:function(){var a=this._currentViewImpl();return a.supports.selection?a.getSelectedRecords():null},setSelectedRecords:function(a,b,c){var d,e,f,g,h=this._currentViewImpl();if(h.supports.selection){if(a.length&&"string"==typeof a[0])for(g=h.model,e=a,a=[],d=0;d<e.length;d++)f=g.getRecord(e[d]),f&&a.push(f);h.setSelectedRecords(a,b,c)}},getReports:function(a){var b,d=this.options.savedReports;if(!a)return d;for(b=0;b<d.length;b++)if(d[b].id===a)return d[b];c.warn("No report exists with ID: ",a)},addReport:function(b,d){var e=a.extend(b,{operation:Oc,isEnabled:!0}),f=a.extend({save:!0},d);this.options.config.features.saveReport?(this.getReports().push(e),f.save&&this._saveReport(e,Oc)):c.warn("Unable to add report settings because the configuration disallows it.")},updateReport:function(b,d,e){var f,g,h=this.getReports(),i=a.extend({save:!0},e);if(this.options.config.features.saveReport){for(f=0;f<h.length;f++)if(g=h[f],g.id===b){this._setOperationUpdate(d),g=a.extend(!0,g,d);break}i.save&&this._saveReport(g,Pc)}else c.warn("Unable to update report settings because the configuration disallows it.")},deleteReport:function(b,d){var e={},f=a.extend({save:!0},d);this.options.config.features.saveReport?(e.id=b,e.operation=Qc,f.save&&this._saveReport(e,Qc)):c.warn("Unable to delete report settings because the configuration disallows it.")},getFilters:function(a){var b,d=this._currentReportSettings().filters;if(!a)return d;for(b=0;b<d.length;b++)if(d[b].id===a)return d[b];c.warn("No filter exists with ID: ",a)},addFilter:function(b,c){function d(){f.columnName&&(f.columnId=e._getColumnByName(f.columnName).id,delete f.columnName),e.getFilters().push(f),g.save&&e._setReportSettings({refreshModel:g.refreshData,affectsOtherViewsModels:!0})}var e=this,f=a.extend(b,{operation:Oc,isEnabled:!0}),g=a.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},c);g.skipNoChangesCheck?d():this._ifNoChangesDo(d)},updateFilter:function(b,c,d){function e(){var d,e=f._isSettingsCheckboxFocused(b,xc);for(d=0;d<g.length;d++)if(g[d].id===b){f._setOperationUpdate(c),g[d]=a.extend(!0,g[d],c);break}h.save&&f._setReportSettings({refreshModel:h.refreshData,affectsOtherViewsModels:!0},function(){f._focusOnSettingsCheckbox(e,b,xc)})}var f=this,g=this.getFilters(),h=a.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},d);h.skipNoChangesCheck?e():this._ifNoChangesDo(e)},deleteFilter:function(b,c){function d(){var c;for(c=0;c<f.length;c++)if(f[c].id===b){f[c]=a.extend(!0,f[c],{operation:Qc});break}g.save&&e._setReportSettings({refreshModel:g.refreshData,affectsOtherViewsModels:!0})}var e=this,f=this.getFilters(),g=a.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},c);g.skipNoChangesCheck?d():this._ifNoChangesDo(d)},getHighlights:function(a){var b,d=this._getCurrentView().highlights;if(!a)return d;for(b=0;b<d.length;b++)if(d[b].id===a)return d[b];c.warn("No highlight exists with ID: ",a)},addHighlight:function(b,c){function d(){f.columnName&&(f.columnId=e._getColumnByName(f.columnName).id,delete f.columnName),e.getHighlights().push(f),g.save&&e._setReportSettings({refreshModel:g.refreshData,affectsOtherViewsModels:!0})}var e=this,f=a.extend(b,{operation:Oc,isEnabled:!0}),g=a.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},c);g.skipNoChangesCheck?d():this._ifNoChangesDo(d)},updateHighlight:function(b,c,d){function e(){var d,e=f._isSettingsCheckboxFocused(b,yc);for(d=0;d<g.length;d++)if(g[d].id===b){f._setOperationUpdate(c),g[d]=a.extend(!0,g[d],c),c.type===Tb&&(delete g[d].columnId,delete g[d].columnType);break}h.save&&f._setReportSettings({refreshModel:h.refreshData,affectsOtherViewsModels:!0},function(){f._focusOnSettingsCheckbox(e,b,yc)})}var f=this,g=this.getHighlights(),h=a.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},d);h.skipNoChangesCheck?e():this._ifNoChangesDo(e)},deleteHighlight:function(b,c){function d(){var c;for(c=0;c<f.length;c++)if(f[c].id===b){f[c]=a.extend(!0,f[c],{operation:Qc});break}g.save&&e._setReportSettings({refreshModel:g.refreshData,affectsOtherViewsModels:!0})}var e=this,f=this.getHighlights(),g=a.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},c);g.skipNoChangesCheck?d():this._ifNoChangesDo(d)},getAggregates:function(){var a=[],b=this._currentViewImpl();return b.supports.aggregation&&(a=this._getCurrentView().aggregations),a},addAggregate:function(b,c){function d(){e.getAggregates().push(f),g.save&&e._setReportSettings({refreshModel:g.refreshData})}var e=this,f=a.extend(b,{operation:Oc}),g=a.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},c);g.skipNoChangesCheck?d():this._ifNoChangesDo(d)},updateAggregate:function(b,c,d){function e(){var d,e=f._isSettingsCheckboxFocused(b,Bc);for(d=0;d<g.length;d++)if(g[d].id===b){f._setOperationUpdate(c),g[d]=a.extend(!0,g[d],c);break}h.save&&f._setReportSettings({refreshModel:h.refreshData},function(){f._focusOnSettingsCheckbox(e,b,Bc)})}var f=this,g=this.getAggregates(),h=a.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},d);h.skipNoChangesCheck?e():this._ifNoChangesDo(e)},deleteAggregate:function(b,c){function d(){var c;for(c=0;c<f.length;c++)if(f[c].id===b){f[c]=a.extend(!0,f[c],{operation:Qc});break}g.save&&e._setReportSettings({refreshModel:g.refreshData})}var e=this,f=this.getAggregates(),g=a.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},c);g.skipNoChangesCheck?d():this._ifNoChangesDo(d)},getFlashback:function(){return this._currentReportSettings().flashback},addFlashback:function(b,c){function d(){e._currentReportSettings().flashback=a.extend(b,{isEnabled:!0}),e._setOperationUpdate(e._currentReportSettings()),f.save&&e._setReportSettings({refreshModel:f.refreshData,affectsOtherViewsModels:!0,changeIdentifier:"editable"})}var e=this,f=a.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},c);f.skipNoChangesCheck?d():this._ifNoChangesDo(d)},updateFlashback:function(b,c){function d(){var c=e._isSettingsCheckboxFocused("",zc);e._setOperationUpdate(e._currentReportSettings()),e._currentReportSettings().flashback=a.extend(e._currentReportSettings().flashback,b),f.save&&e._setReportSettings({refreshModel:f.refreshData,affectsOtherViewsModels:!0,changeIdentifier:"editable"},function(){e._focusOnSettingsCheckbox(c,"",zc)})}var e=this,f=a.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},c);f.skipNoChangesCheck?d():this._ifNoChangesDo(d)},deleteFlashback:function(b){function c(){d._setOperationUpdate(d._currentReportSettings()),d._currentReportSettings().flashback=!1,e.save&&d._setReportSettings({refreshModel:e.refreshData,affectsOtherViewsModels:!0,changeIdentifier:"editable"})}var d=this,e=a.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},b);e.skipNoChangesCheck?c():this._ifNoChangesDo(c)},addControlBreak:function(b,c,d){function e(){var d,e,h=0,i=f._getCurrentView().columns;for(d=0;d<i.length;d++)if(i[d].columnId===b.id){e=i[d];break}if(!c.order){for(d=0;d<i.length;d++)i[d]["break"]&&h++;c.order=h+1}e=a.extend(!0,e,{isVisible:!c.isEnabled,"break":{order:c.order,isEnabled:c.isEnabled,direction:c.direction,nulls:c.nulls}}),f._setOperationUpdate(e),c.isEnabled&&f._adjustControlBreakSort(),c.isEnabled?a.extend(b,{controlBreakIndex:c.order,controlBreakDirection:c.direction,hidden:!0}):a.extend(b,{controlBreakIndex:0,controlBreakDirection:null,hidden:!1}),g.save&&f._setReportSettings({refreshModel:g.refreshData,refreshColumns:g.refreshData})}var f=this,g=a.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},d?d:{});g.skipNoChangesCheck?e():this._ifNoChangesDo(e)},updateControlBreak:function(b,c,d){function e(){var d,e,h=f._getCurrentView().columns,i=f._isSettingsCheckboxFocused(b,Cc);for(d=0;d<h.length;d++)if(h[d].columnId===b){e=h[d];break}e=a.extend(!0,e,{isVisible:!c.isEnabled,"break":{order:c.order,isEnabled:c.isEnabled,direction:c.direction,nulls:c.nulls}}),f._setOperationUpdate(e),c.isEnabled?a.extend(f._currentViewImpl().modelColumns[f._getColumn(b).name],{
controlBreakIndex:e["break"].order,controlBreakDirection:e["break"].direction,hidden:!0}):a.extend(f._currentViewImpl().modelColumns[f._getColumn(b).name],{controlBreakIndex:0,controlBreakDirection:null,hidden:!1}),f._adjustControlBreakSort(),g.save&&f._setReportSettings({refreshModel:g.refreshData,refreshColumns:g.refreshData},function(){f._focusOnSettingsCheckbox(i,b,Cc)})}var f=this,g=a.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},d?d:{});g.skipNoChangesCheck?e():this._ifNoChangesDo(e)},deleteControlBreak:function(b,c){function d(){var c,d,g=e._getCurrentView().columns;for(c=0;c<g.length;c++)if(g[c].columnId===b){d=g[c];break}d=a.extend(!0,d,{isVisible:!0,"break":!1}),e._setOperationUpdate(d),a.extend(e._currentViewImpl().modelColumns[e._getColumn(b).name],{controlBreakIndex:0,controlBreakDirection:null,hidden:!1}),e._adjustControlBreakSort(),f.save&&e._setReportSettings({refreshModel:f.refreshData,refreshColumns:f.refreshData})}var e=this,f=a.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},c?c:{});f.skipNoChangesCheck?d():this._ifNoChangesDo(d)},getSorts:function(){var b,c,d,e=[],f=this._getCurrentView().columns;for(b=0;b<f.length;b++)c=f[b],c.sort&&(d=a.extend({},{columnId:c.columnId,order:c.sort.order,direction:c.sort.direction,nulls:c.sort.nulls}),e.push(d));for(e.length>0&&(e=e.sort(function(a,b){return a.order-b.order})),b=0;b<e.length;b++)delete e[b].order;return e},setSorts:function(a){var b,c,d,e,f,g,h,i=this,j=this.options.config,k=this._currentViewImpl(),l=k.internalIdentifier,m=j.views[l],n=this._getCurrentView().columns,o=null;this._ifNoChangesDo(function(){for(m.useModelFrom&&j.views[m.useModelFrom].shareModel&&(k=i.getViews(m.useModelFrom)),k.supports.configurableColumns&&(o=k.getColumns()),c=0;c<a.length;c++){for(f=a[c],e=!1,b=0;b<n.length;b++)if(g=n[b],f.columnId===g.columnId){e=!0;break}e||n.push({columnId:f.columnId,operation:Oc,columnType:Ub,isVisible:!1,isFrozen:!1})}for(b=0;b<n.length;b++){if(g=n[b],e=!1,o)for(d=0;d<o.length;d++)if(g.columnId===o[d].id){h=o[d];break}for(c=0;c<a.length;c++)if(f=a[c],f.columnId===g.columnId){e=!0,f.order=c+1;break}e?(delete f.columnId,g.sort?f.order===g.sort.order&&f.direction===g.sort.direction&&f.nulls===g.sort.nulls||(g.sort=f,i._setOperationUpdate(g),h&&(h.sortIndex=g.sort.order,h.sortDirection=g.sort.direction)):(g.sort=f,i._setOperationUpdate(g),h&&(h.sortIndex=g.sort.order,h.sortDirection=g.sort.direction))):g.sort&&(g.sort=!1,i._setOperationUpdate(g),h&&(h.sortIndex=null,h.sortDirection=null))}i._adjustControlBreakSort(),i._setReportSettings({refreshModel:!0,refreshColumns:!0}),k!==i._currentViewImpl()&&(k.refreshColumns(),k.refresh())})},getChart:function(){return this._currentReportSettings().views.chart},setChart:function(b){var c,d=this,e=this.getChart(),f=this._currentViewImpl(),g={};e?(c=a.extend(e,b),this._setOperationUpdate(c)):c=a.extend({operation:Oc},b),this._currentReportSettings().views.chart=c,this._view()===mc?(g.ig=this,g.igConfig=this.options.config,f.initView(g),this._setReportSettings({refreshView:!0,refreshModel:!0})):this._setReportSettings({},function(){d._view(mc,{fetchData:!0})})},deleteChart:function(){var a=this,b=this._currentViewImpl();this._currentReportSettings().views.chart={operation:Qc},this._setReportSettings({},function(){b.destroyView(a),b.view$=null})},getViews:function(a){return a?this.viewsImpl[a]:this.viewsImpl},getCurrentView:function(){return this.getViews(this.getCurrentViewId())},getCurrentViewId:function(){return this._view()},focus:function(){var a=this.options.config;a.toolbar&&a.toolbar.searchField&&this.toolbar$?this.toolbar$.toolbar("findElement","search_field").focus():this._currentViewImpl().focus()}}),a.apex.interactiveGrid.copyDefaultToolbar=o;var Le=[];a.apex.interactiveGrid.registerView=S;var Me=["selection-fill","selection-clear","selection-copy-down"],Ne={setColumnConfig:function(c){var d,e,f,g,h,i,k,l,m={},o=c.baseModelColumns,p=c.igConfig,q=p.views[this.internalIdentifier].features,r=c.currentReportSettings,s=c.ig,t=Gc,u=p.editable!==!1;for(d=0;d<r.views.grid.columns.length;d++)e=r.views.grid.columns[d],f=s._getColumn(e.columnId),k=a.extend(!0,{},f.defaultGridColumnOptions||{},o[e.columnId]),k.elementId=f.staticId,k.seq=e.seq,void 0===k.noStretch&&(void 0!==f.layout.noStretch?k.noStretch=f.layout.noStretch:null!==q.stretchColumns?k.noStretch=!q.stretchColumns:k.noStretch=!r.views.grid.stretchColumns),f.isHidden||(k.hidden=!e.isVisible,k.frozen=e.isFrozen,e.width&&(k.width=e.width),e.sort&&(k.sortIndex=e.sort.order,k.sortDirection=e.sort.direction),i=e["break"],i&&i.isEnabled&&(t=i.direction,k.controlBreakIndex=i.order,k.controlBreakDirection=t),f.layout.groupId&&("both"===f.layout.useGroupFor?k.useGroupFor="srv,heading":k.useGroupFor=f.layout.useGroupFor,k.groupName=f.layout.groupId),k.helpid=f.helpid,k.canHide=f.features.canHide,k.canSort=f.features.sort,f.link.attributes&&(k.linkAttributes=f.link.attributes),f.link.text&&(k.linkText=f.link.text),f.link.targetColumn&&(k.linkTargetColumn=f.link.targetColumn)),f.accessibility.usedAsRowHeader&&(k.usedAsRowHeader=f.accessibility.usedAsRowHeader),f.appearance.columnCssClasses&&(k.columnCssClasses=f.appearance.columnCssClasses),f.appearance.fieldColSpan&&(k.fieldColSpan=f.appearance.fieldColSpan),f.appearance.fieldCssClasses&&(k.fieldCssClasses=f.appearance.fieldCssClasses),f.validation&&(k.isRequired=f.validation.isRequired),f.appearance.cellTemplate&&(k.cellTemplate=f.appearance.cellTemplate),u&&(k.noCopy=!f["default"].duplicate,l=f["default"].value,a.isPlainObject(l)&&void 0!==l.d&&k.elementId&&(l.d=j(k.elementId).displayValueFor(l.d)),k.defaultValue=l,"actions"===f.specialType&&(g=b.htmlBuilder(),h=ib+" "+lb+" a-Button--actions "+yb,E(g,{label:n("ROW_ACTIONS"),buttonClass:h,iconOnly:!0,icon:"icon-ig-actions",attributes:{"data-menu":s._getId("row_actions_menu"),"aria-haspopup":!0,"aria-expanded":!1}}),k.cellTemplate=g.toString(),g.clear(),E(g,{label:n("SEL_ACTIONS"),buttonClass:h+" js-selectionMenu",iconOnly:!0,icon:"icon-ig-actions",attributes:{"data-menu":s._getId("selection_actions_menu"),"aria-haspopup":!0,"aria-expanded":!1}}),k.heading=g.toString(),k.columnCssClasses?k.columnCssClasses+=" "+Db:k.columnCssClasses=Db,k.headingCssClasses?k.headingCssClasses+=" "+Db:k.headingCssClasses=Db,delete k.index,k.virtual=!0,k.noHeaderActivate=!0,k.elementId=null,0===d&&(k.frozen=!0,e.isFrozen=!0),k.noStretch=!0,k.canSort=!1,k.width||(k.width=qe))),m[f.name]=k;m[Wc]=o[Wc],this.modelColumns=m,this.specialColumns={identityField:0===s.primaryKeyColumns.length?null:s.primaryKeyColumns,metaField:Wc}},init:function(a){var b=a.options.config;a.getActions().add([{name:"selection-copy-down",labelKey:"APEX.IG.COPY_DOWN",icon:"icon-ig-copy-down",hide:!0,action:function(){var b=a._currentViewImpl();b.singleRowMode||b.view$.grid("copyDownSelection")}},{name:"selection-clear",labelKey:"APEX.IG.CLEAR",icon:"icon-ig-clear",hide:!0,action:function(){var b=a._currentViewImpl();b.singleRowMode||b.view$.grid("fillSelection","")}},{name:"selection-fill",labelKey:"APEX.IG.FILL",icon:"icon-ig-fill",hide:!0,getFillValue:function(a){R({labelKey:"APEX.IG.FILL_LABEL",titleKey:"APEX.IG.FILL_TITLE"},a)},action:function(){var b=a._currentViewImpl();b.singleRowMode||this.getFillValue(function(a){a!==!1&&b.view$.grid("fillSelection",a)})}}]),this._initMenus(b,a)},initView:function(c){function d(a,b){C.editMode=b.editMode,C.actions.update("edit"),C._trigger(Ie,a,b)}function e(a,b){return void 0!==a?a:b}function f(a){K.hide(),L.removeClass(tb).attr(Eb,"false"),a&&(L.focus(),H.view$.grid("focus")),L=null,C._off(C.document,"mousedown"),C._off(C.window,"blur"),C._off(K)}function g(){var a,b,c,d=C._currentReportSettings().views.grid.columns,e=H.view$.grid("getColumns"),f=0,g=!1,h=!1;for(a=0;a<d.length;a++)d[a]&&d[a].isVisible&&!C._getColumn(d[a].columnId).isHidden&&d[a].seq>f&&(f=d[a].seq,g=a);if(g!==!1){for(b=d[g],a=0;a<e.length;a++)b.columnId!==e[a].id||e[a].hidden||(c=e[a]);b.isFrozen&&(b.isFrozen=!1,c.frozen=!1,h=!0,C._setOperationUpdate(b))}h?C._setReportSettings({refreshView:!0,refreshColumns:!0}):(C._setReportSettings(),H.singleRowView$&&H.singleRowView$.recordView("refreshFields").recordView($b))}var j,k,l,m,o,p,q,r={},s=b.htmlBuilder(),t=!0,w=c.igConfig,x=w.defaultGridViewOptions.multiple,y=w.defaultGridViewOptions.selectAll,z=w.views.grid.features,A=!1,B=w.defaultGridViewOptions.rowHeader||Kc,C=c.ig,D=C.actions,E=C._isCurrentlyEditable(),F=w.columnGroups,G=!!E&&w.editable.autoAddRow,H=this,J=!0,K=null,L=null;if(!z.gridView&&!z.singleRowView)throw new Error("Interactive Grid grid view must have at least one of grid or single row");switch(a("div.a-GV-columnItemContainer",c.ig$).appendTo(c.ig$),z.gridView&&(s.markup("<div").attr(ad,Ma).attr("style","display:none;").attr("id",C._getId("column_header_menu")).markup(">").markup("</div>"),K=a(s.toString()),a("body").append(K),q=c.currentReportSettings.views.grid.aggregations,q.length>0&&(B!==Kc&&B!==Yc||(B=Zc))),z.rowSelector&&(B===Kc&&(B=Yc),A=!z.rowSelector.hideControl,void 0===x&&(x=z.rowSelector.multiSelect),x&&void 0===y&&(y=z.rowSelector.selectAll)),w.headingFixedTo){case Kc:t=!1,m=!1,o=!1;break;case Rc:t=!0,m=!1,o=!1;break;case Sc:t=!1,m=function(){return h.defaultStickyTop()+a(W,c.ig$).outerHeight()},o=w.defaultGridViewOptions.stickyFooter||!0}for(j=0;j<F.length;j++)k=F[j],r[k.id]={heading:k.heading,label:k.label};z.gridView?(w.defaultGridViewOptions.contextMenu&&!w.defaultGridViewOptions.contextMenu.hasOwnProperty("actionsContext")&&(w.defaultGridViewOptions.contextMenu.actionsContext=C.actions),w.editable&&w.editable.allowedOperations.create===!1&&w.editable.allowedOperations.update===!1&&(J=!1),p={modelName:H.modelName,editable:E,autoAddRecord:G,rowHeader:B,rowHeaderCheckbox:A,aggregateLabels:this._gridAggregateLabels(),highlights:this._gridHighlightsFromReport(c.currentReportSettings),multiple:x,selectAll:y,noDataMessage:w.text.noDataFound,moreDataMessage:w.text.moreDataFound,showNullAs:w.appearance.showNullValue,columns:[H.modelColumns],columnGroups:r,columnSort:z.sort,reorderColumns:e(w.defaultGridViewOptions.reorderColumns,z.reorderColumns),resizeColumns:e(w.defaultGridViewOptions.resizeColumns,z.resizeColumns),pagination:C._getPaginationConfig(w,"defaultGridViewOptions"),rowsPerPage:c.currentReportSettings.rowsPerPage,hasSize:t,stickyTop:m,stickyFooter:o,allowEditMode:J,persistSelection:w.defaultGridViewOptions.persistSelection||w.submitSelectedRows,activateColumnHeader:function(c,d){function e(c){var d,e,f,g=b.htmlBuilder();for(d=0;d<c.length;d++)a.isPlainObject(c[d])?(e=c[d].r,f=c[d].d):e=f=c[d],I(g,{cssClasses:Ua,text:f,data:{"return-value":e}});C._getElement("column_header_menu_rows").html(g.toString())}function j(a){var b=K.find(":focusable");a||(k=b.first(),k.data("first",!0)),l=b.last(),l.data("last",!0)}var k,l,m,o,p,q,r,s=[],t=b.htmlBuilder();K.is(":visible")?f():(m=C._isColumnFilterable(d.column.id),m&&(o=C._hasColumnFilterLov(d.column.id)),L=d.header$,d.header$.addClass(tb).attr(Eb,"true"),C._renderColumnHeaderMenu(t,m,o,d.column.id),p>220?(q=d.column.frozen?2:1,p=d.header$.outerWidth(),K.css("min-width",p-q)):K.css("min-width","0"),r=C.isRTL?Lb:Kb,K.html(t.toString()).show().css({left:0,top:0}).position({my:r+" top",at:r+" bottom",of:d.header$,collision:"fit"}),o?C._getFilterValues(d.column.id,!0,function(a){a.regions[0].filterValues&&(C._getElement("column_header_search").focus(),s=a.regions[0].filterValues,e(s),j())}):(j(),k.focus()),C._on(K,{"click button.a-IRR-sortWidget-button":function(b){var c,e,i,j,k=Gc,l=a(b.currentTarget).data(ic);switch(l){case"hide":H.view$.grid("hideColumn",d.column),C._currentViewColumn(d.column.id,{isVisible:!1}),g(),f(!0);break;case"break":c=C._currentViewColumn(d.column.id),c.sort&&(k=c.sort.direction),C.addControlBreak(d.column,{isEnabled:!0,direction:k}),f(!0);break;case"aggregate":C._openDialog(Bc,{columnId:d.column.id}),f();break;case"freeze":if(e=C._currentReportSettings().views.grid.columns,H.view$.grid(d.column.frozen?"unfreezeColumn":"freezeColumn",d.column),i=d.column.frozen)for(j=0;j<e.length;j++)c=e[j],c.seq<=d.column.seq&&!c.isFrozen&&(c.isFrozen=!0,C._setOperationUpdate(c));else for(j=0;j<e.length;j++)c=e[j],c.seq>=d.column.seq&&c.isFrozen&&(c.isFrozen=!1,C._setOperationUpdate(c));C._setReportSettings(),f(!0);break;case"help":f(!0),h.popupFieldHelp(C._getColumn(d.column.id).helpid,$v("pInstance"))}},keydown:function(b){var c;b.which===a.ui.keyCode.ESCAPE?(f(!0),b.preventDefault()):b.which===a.ui.keyCode.TAB&&(c=!!b.shiftKey,!c&&a(b.target).data("last")&&(b.preventDefault(),k.focus()),c&&a(b.target).data("first")&&(b.preventDefault(),l.focus()))},"keydown input.a-IRR-sortWidget-searchField":function(b){var c,e;if(m&&b.which===a.ui.keyCode.ENTER){if(e=this._getColumn(d.column.id).filter.dataType,e===Ud)try{c=apex.jQuery.timepicker.parseDateString(a(b.target).val(),this._getColumn(d.column.id).appearance.dateFormatMask),C.addFilter({type:Ub,columnType:Ub,columnId:d.column.id,operator:ld,value:u(c),isCaseSensitive:!1})}catch(g){i.alert(n("INVALID_DATE_FORMAT"))}else C.addFilter({type:Ub,columnType:Ub,columnId:d.column.id,operator:e===Sd?vd:ld,value:a(b.target).val(),isCaseSensitive:!1});f(!0),b.preventDefault()}},"keyup input.a-IRR-sortWidget-searchField":function(a){if(o){var b,c=a.target.value;b=s.filter(function(a){return a.d?a.d.toLowerCase().indexOf(c.toLowerCase())>-1:a.toLowerCase().indexOf(c.toLowerCase())>-1}),e(b),j(!0)}},"click a.a-IRR-sortWidget-row":function(b){var c,e,g,h,i=a(b.currentTarget).data("returnValue");o&&(c=C._getColumn(d.column.id).filter.dataType,c===Ud||c.indexOf(Wd)>-1?(e=i.indexOf(Tc),g=i.substring(0,e),h=i.substring(e+1),e>0&&C.addFilter({type:Ub,columnType:Ub,columnId:d.column.id,operator:g,value:h,isCaseSensitive:!1})):C.addFilter({type:Ub,columnType:Ub,columnId:d.column.id,operator:ld,value:i,isCaseSensitive:!0}),f(!0),b.preventDefault())}}),C._on(C.document,{mousedown:function(b){!a(b.target).closest(K).length>0&&!a(b.target).closest(d.header$).length>0&&K.is(":visible")&&f()}}),C._on(C.window,{blur:function(){K.is(":visible")&&f()}}))},cancelColumnHeader:function(){K.is(":visible")&&f()},sortChange:function(a,b){C._ifNoChangesDo(function(){var a,c,d,e,f,g=b.column.sortIndex,h=H.view$.grid("getColumns");for(d=1,a=0;a<h.length;a++)c=h[a],c.sortIndex&&("change"===b.action?c===b.column&&(d=c.sortIndex):"add"===b.action?c.sortIndex>=d&&(d=c.sortIndex+1):"remove"===b.action?c===b.column?(delete c.sortIndex,delete c.sortDirection,e=C._currentViewColumn(b.column.id),e.sort=!1,C._setOperationUpdate(e)):c.sortIndex>g&&(c.sortIndex-=1,C._currentViewColumn(c.id,{sort:{order:c.sortIndex}})):"clear"!==b.action&&"set"!==b.action||(delete c.sortIndex,delete c.sortDirection,e=C._currentViewColumn(c.id),e.sort=!1,C._setOperationUpdate(e)));"clear"!==b.action&&"remove"!==b.action&&(b.column.sortIndex=d,b.column.sortDirection=b.direction,f=b.direction===Gc?Jc:Ic,C._currentViewColumn(b.column.id,{sort:{order:d,direction:b.direction,nulls:f}})),C._setReportSettings({refreshModel:!0,refreshColumns:!0})})},columnReorder:function(a,b){var c,d,e=C._currentReportSettings().views.grid.columns,f=e[b.newPosition].isFrozen;for(v(e,b.oldPosition,b.newPosition),e[b.newPosition]&&(e[b.newPosition].isFrozen=f),c=0;c<e.length;c++)e[c]||e.splice(c,1);for(c=0;c<e.length;c++)d=e[c],d.seq!==c+1&&(d.seq=c+1,C._setOperationUpdate(d));g()},columnResize:function(a,b){C._currentViewColumn(b.column.id,{width:b.width}),C._setReportSettings()},modeChange:d,selectionChange:function(b){var c=H.view$.grid("getSelection");a(".js-selectionMenu",H.view$).prop(gc,0===c.length),H._selectionChange(C,b)},pageChange:function(a,b){C._pageChange(b)}},q.length>0&&(p.aggregateTooltips=this._gridAggregateTooltipsFromReport(C,c.currentReportSettings)),H.view$.grid({},w.defaultGridViewOptions,p),H.curInst=H.view$.grid("instance")):(H.view$.hide(),H.singleRowMode=!0),H.supports.singleRowView&&z.singleRowView&&(H.singleRowView$=a("<div id='"+C._getId("singleRow"+Xc)+"' class='"+La+"'></div>").attr(Ib,C._getId("summary")),H.view$.after(this.singleRowView$),H.singleRowView$.width(H.view$.width()),w.maxHeight&&H.singleRowView$.height(H.view$.height()),l=a.apex.recordView.copyDefaultToolbar(),w.editable&&l[0].controls.unshift({type:hd,labelKey:"APEX.IG.SRV_CHANGE_MENU",iconOnly:!0,icon:"icon-ig-actions",menuId:C._getId("srv_actions_menu")}),z.gridView&&(D.remove(["close-single-row-view"]),D.add([{name:"close-single-row-view",labelKey:"APEX.IG.REPORT_VIEW",action:function(){var a,b=C.editMode;return b&&H.singleRowView$.recordView("setEditMode",!1),H.singleRowMode=!1,H.singleRowView$.hide(),H.curInst=H.view$.grid("instance"),C._updateSummary(),a=C._toolbarFind("selection_submenu"),a&&(a.disabled=!H.supports.selection),H.view$.show().grid(_b),b&&H.view$.grid("setEditMode",!0),H.view$.grid("focus"),!0}}]),l[0].controls.unshift({type:gd,action:"close-single-row-view"})),H.singleRowView$.recordView({},w.defaultSingleRowOptions,{modelName:H.modelName,actionsContext:D,toolbar:l,editable:E,autoAddRecord:G,noDataMessage:w.text.noDataFound,moreDataMessage:w.text.moreDataFound,showNullAs:w.appearance.showNullValue,fields:[H.modelColumns],fieldGroups:r,hasSize:t,modeChange:d,recordChange:function(a){H._selectionChange(C,a)}}),z.gridView?(H.singleRowView$.hide(),H.singleRowMode=!1):H.curInst=H.singleRowView$.recordView("instance"))},viewChanged:function(a,b,c){b._toggleEnableAction(a&&c.editable&&this.supports.edit,Me),a&&this._selectionChange(b)},updateActions:function(a){var b=a.ig,c=b.options.config;b._toggleShowAction(a.canEdit&&this.supports.edit&&this.supports.cellSelection&&c.views.grid.features.cellRangeActions,Me)},setReportOptions:function(a,b,c,d){function e(){k._hasGridView()&&k.view$.grid(ic,"aggregateTooltips",k._gridAggregateTooltipsFromReport(a,c))}function f(){k._hasGridView()&&k.view$.grid(ic,"highlights",k._gridHighlightsFromReport(c))}function g(){var b,d,e,f,g,h,i=l.views.grid.features,j=c.views.grid.columns,m=k.getColumns(),n=i.gridView!==!1,o=!1;for(b=0;b<j.length;b++)for(g=j[b],e=a._getColumn(g.columnId),d=0;d<m.length;d++)if(f=m[d],f.id===g.columnId){n&&(h=f.noStretch,void 0!==e.defaultGridColumnOptions&&void 0!==e.defaultGridColumnOptions.noStretch||(void 0!==e.layout.noStretch?f.noStretch=e.layout.noStretch:null!==i.stretchColumns?f.noStretch=!i.stretchColumns:f.noStretch=!c.views.grid.stretchColumns),f.noStretch!==h&&(o=!0)),f.hidden===g.isVisible&&f.canHide&&(f.hidden=!g.isVisible,o=!0);break}o&&(k.refreshColumns(),k.refresh())}function h(){var b=a._isCurrentlyEditable();k.model.getOption("identityField")&&k.model.setOption("editable",b),k.singleRowView$&&(k.singleRowView$.recordView(ic,"editable",b),k.singleRowView$.recordView(ic,"autoAddRecord",b)),k._hasGridView()&&(k.view$.grid(ic,"editable",b),k.view$.grid(ic,"autoAddRecord",b)),a._updateActions()}function i(){k._hasGridView()&&(k.view$.grid(ic,"rowsPerPage",c.rowsPerPage),b||(k.pendingRefresh=!0))}var j,k=this,l=a.options.config;j={"views.grid.aggregations":e,"views.grid.highlights":f,"views.grid.columns":g,editable:h,rowsPerPage:i},j[d]&&k.view$&&j[d]()},_selectionChange:function(a,b){b&&a._selectionChange(b)},_initMenus:function(b,c){function d(a){m.push(a),n&&n.push(a)}var e,f=null,g=null,h=null,i=this,j=b.views.grid.features,k=[],l=[],m=[],n=c._toolbarFind("selection_submenu");n&&(n=n.menu.items,i._selectionMenuItems=n,i._selectionMenuStart=n.length),m.push({type:cd,action:"selection-copy",accelerator:"Ctrl+C"}),m.push(fd),f=a("<div/>",{id:c._getId("row_actions_menu")}).appendTo("body"),g=a("<div/>",{id:c._getId("srv_actions_menu")}).appendTo("body"),h=a("<div/>",{id:c._getId("selection_actions_menu")}).appendTo("body"),i.supports.singleRowView&&(k.push({id:"srv",type:cd,action:"single-row-view"}),k.push(fd)),b.editable&&(b.editable.allowedOperations.create&&(k.push({id:"ins",type:cd,action:"row-add-row"}),l.push({id:"ins",type:cd,label:b.text.addRowButton,action:"insert-record"}),k.push({id:"dup",type:cd,action:"row-duplicate"}),l.push({id:"dup",type:cd,action:"duplicate-record"}),d({id:"dup",type:cd,action:"selection-duplicate"}),k.push(fd),d(fd)),(b.editable.allowedOperations[Zb]||b.editable.allowedOperations.create)&&(k.push({id:"del",type:cd,action:"row-delete"}),l.push({id:"del",type:cd,action:"delete-record"})),b.editable.allowedOperations[Zb]&&d({id:"del",type:cd,action:"selection-delete"}),k.push(fd),k.push({id:"refresh",type:cd,action:"row-refresh"}),l.push({id:"refresh",type:cd,action:"refresh-record"}),d(fd),d({id:"refresh",type:cd,action:"selection-refresh"}),(b.editable.allowedOperations.update||b.editable.allowedOperations[Zb])&&(k.push({id:"revert",type:cd,action:"row-revert"}),l.push({id:"revert",type:cd,action:"revert-record"}),d({id:"revert",type:cd,action:"selection-revert"})),j.cellRangeActions&&(d(fd),d({id:"copy_down",type:cd,action:"selection-copy-down"}),d({id:"fill",type:cd,action:"selection-fill"}),d({id:"clear",type:cd,action:"selection-clear"})),f.menu({actionsContext:c.actions,items:k,beforeOpen:function(){var a,d=i.view$.find("."+yb+"."+tb).closest("tr");i.singleRowMode?(c._updateAction(bc,"single-row-view"),a=i.getSelectedRecords()):a=i.view$.grid("getRecords",[d]),b.editable.allowedOperations.create&&(f.menu("find","dup").disabled=!i.model.allowAdd(null,"copy"),f.menu("find","ins").disabled=!i.model.allowAdd(null,"new")),(b.editable.allowedOperations.update||b.editable.allowedOperations[Zb])&&c._toggleEnableAction(i.model.canRevertRecord(a[0]),["row-revert"]),b.editable.allowedOperations[Zb]||c._toggleShowAction(i.model.allowDelete(a[0]),"row-delete"),b.editable.allowedOperations[Zb]&&c._toggleEnableAction(i.model.allowDelete(a[0]),["row-delete"])},afterClose:function(){i.singleRowMode&&c._updateAction(ac,"single-row-view"),c._updateSelectionActions()}}),g.menu({actionsContext:c.actions,items:l,beforeOpen:function(){var a=i.getSelectedRecords();b.editable.allowedOperations.create&&(g.menu("find","dup").disabled=!i.model.allowAdd(null,"copy"),g.menu("find","ins").disabled=!i.model.allowAdd(null,"new")),(b.editable.allowedOperations.update||b.editable.allowedOperations[Zb])&&(g.menu("find","revert").disabled=!a.length||!i.model.canRevertRecord(a[0]),g.menu("find","refresh").disabled=!a.length),b.editable.allowedOperations[Zb]||c._toggleShowAction(i.model.allowDelete(a[0]),"delete-record"),b.editable.allowedOperations[Zb]&&(g.menu("find","del").disabled=!a.length||!i.model.allowDelete(a[0]))}}),h.menu({actionsContext:c.actions,items:m,beforeOpen:function(){c._updateSelectionActions()}}),n&&(e=c.toolbar$.toolbar("findElement","actions_button_menu"),e.on("menubeforeopen.gridview",function(){c._updateSelectionActions()}))),i.rowActionMenu$=f,i.srvActionMenu$=g,i.selActionMenu$=h},_gridAggregateLabels:function(){var b=null;return this.aggregateLabels||(this.aggregateLabels=b={},a.each(we,function(a,c){b[c]={label:n(c),overallLabel:n(c+"_OVERALL")}})),this.aggregateLabels},_gridAggregateTooltipsFromReport:function(a,b){var c,d,e=null,f=b.views.grid.aggregations;if(f.length>0)for(e={},c=0;c<f.length;c++)d=f[c],d.tooltip&&(e[d["function"]+"|"+a._getColumn(d.columnId).name]=d.tooltip);return e},_gridHighlightsFromReport:function(a){var b,c,d,e={},f=a.views.grid.highlights;for(b=0;b<f.length;b++)d=f[b],c=d.id,e[c]={seq:d.seq,row:d.type===Tb,color:d.textColor,background:d.backgroundColor};return e},_hasGridView:function(){return this.view$.is(":apex-grid")},destroyView:function(a){this._hasGridView()&&this.view$.grid(Yb),this.singleRowView$&&this.singleRowView$.remove(),a._getElement("column_header_menu").remove()},destroy:function(a){this.rowActionMenu$&&this.rowActionMenu$.length>0&&(this.rowActionMenu$.remove(),this.rowActionMenu$=null),this.selActionMenu$&&this.selActionMenu$.length>0&&(this.selActionMenu$.remove(),this.selActionMenu$=null),this._selectionMenuStart&&this._selectionMenuItems&&(this._selectionMenuItems.length=this._selectionMenuStart,this._selectionMenuItems=this._selectionMenuStart=null,a.toolbar$.toolbar("findElement","actions_button_menu").off("menubeforeopen.gridview"))},getContextRecord:function(b){var c;return this.singleRowMode?[this.singleRowView$.recordView("getRecord")]:(c=a(b).closest("tr"),c.length>0?this.view$.grid("getRecords",[c]):[])},getColumns:function(){return this.singleRowMode?this.curInst.getFields():this.curInst.getColumns()},canCopy2Clipboard:function(){return!this.singleRowMode&&this.curInst.option("allowCopy")},selectCells:function(a){if(!this.singleRowMode){if(void 0===a)return this.view$.grid(ic,"selectCells");this.view$.grid(ic,"selectCells",a)}},getSelectedRecords:function(){var a;return this.singleRowMode?(a=this.curInst.getRecord(),a?[a]:[]):this.curInst.getSelectedRecords()},setSelectedRecords:function(a,b,c){var d;this.singleRowMode?(d=this.model.indexOf(a[0]),d<0&&(d=0),this.singleRowView$.recordView(ic,"recordOffset",d)):this.view$.grid("setSelectedRecords",a,b,c)},getActiveRecordId:function(){return this.curInst.getActiveRecordId()},setModelName:function(a){this.curInst.option("modelName",a)},setEditMode:function(a){this.curInst.setEditMode(a)},finishEditing:function(){return this.curInst.finishEditing()},setNoDataMessage:function(a){this.curInst.option("noDataMessage",a)},focus:function(){this.curInst.focus()},refreshColumns:function(){this._hasGridView()&&this.view$.grid("refreshColumns"),this.singleRowView$&&this.singleRowView$.recordView("refreshFields")},footerHeight:function(){if(!this.singleRowMode)return this.view$.find(".a-GV-footer").outerHeight()||0},refresh:function(a){this._hasGridView()&&this.view$.grid($b),this.singleRowView$&&this.singleRowView$.recordView($b)},resize:function(){this.curInst.resize()},show:function(){this.curInst.element.show()},hide:function(){this.curInst.element.hide()}},Oe={setColumnConfig:function(b){var c,d,e={},f={},g=b.baseModelColumns,h=b.igConfig,i=b.ig,j=h.editable!==!1,k=0;for(d in g)g.hasOwnProperty(d)&&(k++,e=a.extend(!0,{},g[d]),d!==Wc?(c=i._getColumn(d),e.elementId=c.staticId,e.seq=k,j&&"actions"===c.specialType&&(delete e.index,e.virtual=!0,e.elementId=null),f[c.name]=e):f[Wc]=e);this.modelColumns=f,this.specialColumns={identityField:0===i.primaryKeyColumns.length?null:i.primaryKeyColumns,metaField:Wc}},initView:function(a){var b=!0,c=!1,d=a.igConfig,e=a.ig;switch(d.headingFixedTo){case Kc:b=!1;break;case Sc:b=!1,c=!0}this.view$.tableModelView(this.viewConfig(a,{modelName:this.modelName,noDataMessage:d.text.noDataFound,moreDataMessage:d.text.moreDataFound,showNullAs:d.appearance.showNullValue,hasSize:b,columns:this.modelColumns,pagination:e._getPaginationConfig(d,this.internalIdentifier===kc?"defaultIconViewOptions":"defaultDetailViewOptions"),rowsPerPage:a.currentReportSettings.rowsPerPage,stickyFooter:c,selectionChange:function(a){e._selectionChange(a)},pageChange:function(a,b){e._pageChange(b)}}))},destroyView:function(){this.view$.tableModelView(Yb)},setReportOptions:function(a,b,c,d){var e,f=this;e={rowsPerPage:function(){f.view$.tableModelView(ic,"rowsPerPage",c.rowsPerPage),b||(f.pendingRefresh=!0)}},e[d]&&f.view$&&e[d]()},getSelectedRecords:function(){return this.view$.tableModelView("getSelectedRecords")},setSelectedRecords:function(a,b,c){this.view$.tableModelView("setSelectedRecords",a,b,c)},setModelName:function(a){this.view$.tableModelView(ic,"modelName",a)},setNoDataMessage:function(a){this.view$.tableModelView(ic,"noDataMessage",a)},footerHeight:function(){return this.view$.find(".a-GV-footer").outerHeight()||0},refresh:function(a){this.view$.tableModelView($b)},resize:function(){this.view$.tableModelView(_b)},isConfigured:function(){return!0}};S(a.extend({},Oe,{title:n("ICON"),internalIdentifier:kc,cssClass:Ia,icon:"icon-ig-icons",supports:{sort:!0},viewConfig:function(b,c){var d,e=b.igConfig,f=e.views.icon.features,g=!1,h=e.views.icon;return c=a.extend(!0,{iconListOptions:{}},e.defaultIconViewOptions,c),h.customIcon?(h.customIcon.trim().toLowerCase().match(/\s*<li/)?c.recordTemplate=h.customIcon:c.recordTemplate="<li>"+h.customIcon+"</li>",h.customIcon.toLowerCase().indexOf("href=")>=0&&(g=!0)):(c.labelColumn=h.labelColumn,h.iconClassColumn&&(c.iconClassColumn=h.iconClassColumn),h.imageURLColumn&&(c.imageURLColumn=h.imageURLColumn),h.imageAttributes&&(c.imageAttributes=h.imageAttributes),h.linkAttributes&&(c.linkAttributes=h.linkAttributes),h.linkTarget&&(c.linkTarget=!0,g=!0),c.linkTargetColumn&&(g=!0)),c.useIconList=!0,d=c.iconListOptions,g&&void 0===d.navigation&&(d.navigation=!0),f.rowSelector&&void 0===d.multiple&&void 0===d.itemSelector&&(d.multiple=f.rowSelector.multiSelect,d.navigation?d.itemSelector=!1:d.itemSelector=!f.rowSelector.hideControl),c.iconListOptions.contextMenu&&!c.iconListOptions.contextMenu.hasOwnProperty("actionsContext")&&(c.iconListOptions.contextMenu.actionsContext=b.ig.actions),c},focus:function(){this.view$.tableModelView("focus")},getContextRecord:function(b){var c,d=this.view$.tableModelView("option").useIconList;return d&&(c=a(b).closest(".a-IconList-item"),c.length)?this.view$.tableModelView("getRecords",c):[]},canCopy2Clipboard:function(){var a=this.view$.tableModelView("option","iconListOptions");return void 0===a.allowCopy||a.allowCopy}})),S(a.extend({},Ne,{title:n("GRID"),internalIdentifier:jc,cssClass:Ha,icon:"icon-ig-report",supports:{cellSelection:!0,edit:!0,highlight:!0,controlBreak:!0,aggregation:!0,singleRowView:!0,configurableColumns:!0,download:!0},gotoCell:function(a,b){return this.singleRowMode?this.curInst.gotoField(a,b):this.curInst.gotoCell(a,b)},lockActive:function(){this.curInst.lockActive()},unlockActive:function(){this.curInst.unlockActive()}})),S(a.extend({},Oe,{title:n("DETAIL"),internalIdentifier:lc,cssClass:Ja,icon:"icon-ig-details",supports:{selection:!1,sort:!0},viewConfig:function(b,c){var d=b.igConfig,e=d.views.detail;return c.beforeTemplate=e.beforeRows,c.recordTemplate=e.row,c.afterTemplate=e.afterRows,c.useIconList=!1,a.extend(!0,{},d.defaultDetailViewOptions,c)},focus:function(){this.view$.find(":focusable").first().focus()}})),S({title:n("CHART"),internalIdentifier:mc,cssClass:Ka,icon:"icon-ig-chart",supports:{totalRows:!1,selection:!1,sort:!1,changeRowsPerPage:!1},initDialog:function(b){var c,d,f,g,h=[],i=[],j=[],k=n(te),l=b.options.config.columns;for(h.push({value:"",label:k}),i.push({value:"",label:k}),j.push({value:"",label:k}),f=0;f<l.length;f++)d=l[f],d.specialType||d.isHidden||(g||(g=d),h.push({value:d.id,label:b._getColumnLabel(d.id)}),d.dataType===Td&&i.push({value:d.id,label:b._getColumnLabel(d.id)}),d.dataType!==Td&&d.dataType!==Ud||j.push({value:d.id,label:b._getColumnLabel(d.id)}));c=[{value:"",label:n(te)},{value:we.CNT,label:n(we.CNT)},{value:we.CNT_DIST,label:n(we.CNT_DIST)},{value:we.APPR_CNT_DIST,label:n(we.APPR_CNT_DIST)},{value:we.MIN,label:n(we.MIN)},{value:we.MAX,label:n(we.MAX)},{value:we.SUM,label:n(we.SUM)},{value:we.AVG,label:n(we.AVG)}],this.dialog$=b._createDialog("chart",function(a){a(Sb,{id:"CH_TYPE",iconOnly:!1,options:[{value:Zd,label:n("AREA"),iconCssClasses:"icon-region-chart-area"},{value:$d,label:n("BAR"),iconCssClasses:"icon-region-chart-bar"},{value:_d,label:n("BUBBLE"),iconCssClasses:"icon-region-chart-bubble"},{value:ae,label:n("DONUT"),iconCssClasses:"icon-region-chart-donut"},{value:be,label:n("FUNNEL"),iconCssClasses:"icon-region-chart-funnel"},{value:ce,label:n("LINE"),iconCssClasses:"icon-region-chart-line"},{value:de,label:n("LINE_WITH_AREA"),iconCssClasses:"icon-region-chart-line-area"},{value:ee,label:n("PIE"),iconCssClasses:"icon-region-chart-pie"},{value:fe,label:n("POLAR"),iconCssClasses:"icon-region-chart-polar"},{value:ge,label:n("RADAR"),iconCssClasses:"icon-region-chart-radar"},{value:he,label:n("RANGE"),iconCssClasses:"icon-region-chart-range-bar"},{value:ie,label:n("SCATTER"),iconCssClasses:"icon-region-chart-scatter"},{value:je,label:n("STOCK"),iconCssClasses:"icon-region-chart-stock"}]}),a(Nb,{id:"CH_ORIENTATION",options:[{value:ke,label:n("VERTICAL")},{value:le,label:n("HORIZONTAL")}]}),a(Nb,{id:"CH_LABEL_COLUMN",
options:h}),a(Nb,{id:"CH_VALUE_COLUMN",options:i}),a(Nb,{id:"CH_VALUE_FUNCTION",options:c}),a(Nb,{id:"CH_X_COLUMN",options:j}),a(Nb,{id:"CH_X_FUNCTION",options:c}),a(Nb,{id:"CH_Y_COLUMN",options:i}),a(Nb,{id:"CH_Y_FUNCTION",options:c}),a(Nb,{id:"CH_Z_COLUMN",options:i}),a(Nb,{id:"CH_Z_FUNCTION",options:c}),a(Nb,{id:"CH_OPEN_COLUMN",options:i}),a(Nb,{id:"CH_OPEN_FUNCTION",options:c}),a(Nb,{id:"CH_CLOSE_COLUMN",options:i}),a(Nb,{id:"CH_CLOSE_FUNCTION",options:c}),a(Nb,{id:"CH_HIGH_COLUMN",options:i}),a(Nb,{id:"CH_HIGH_FUNCTION",options:c}),a(Nb,{id:"CH_LOW_COLUMN",options:i}),a(Nb,{id:"CH_LOW_FUNCTION",options:c}),a(Nb,{id:"CH_VOLUME_COLUMN",options:i}),a(Nb,{id:"CH_VOLUME_FUNCTION",options:c}),a(Nb,{id:"CH_TARGET_COLUMN",options:i}),a(Nb,{id:"CH_TARGET_FUNCTION",options:c}),a(Nb,{id:"CH_SERIES_COLUMN",options:h}),a(Nb,{id:"CH_STACK",options:[{value:ne,label:n("OFF")},{value:me,label:n("ON")}]}),a(Nb,{id:"CH_SORT_BY",options:[]}),b._renderSortControls(a,"CH_SORT_"),a(Mb,{id:"CH_AXIS_LABEL_TITLE",maxChars:255}),a(Mb,{id:"CH_AXIS_VALUE_TITLE",maxChars:255}),a(Mb,{id:"CH_AXIS_VALUE_DECIMAL"})},{viewDialog:!0,width:750,height:450,titleKey:"CHART",modelOptions:{fields:{id:{canHide:!1,hidden:!0,seq:0},type:{label:"TYPE",elementId:"CH_TYPE",seq:10,defaultValue:$d},orientationId:{label:"ORIENTATION",elementId:"CH_ORIENTATION",seq:20,fieldColSpan:7,defaultValue:ke},labelColumnId:{label:"LABEL_COLUMN",elementId:"CH_LABEL_COLUMN",seq:30,fieldColSpan:7,defaultValue:""},valueColumnId:{label:"VALUE_COLUMN",elementId:"CH_VALUE_COLUMN",seq:40,fieldColSpan:7,defaultValue:""},valueFunctionId:{label:"AGGREGATION",elementId:"CH_VALUE_FUNCTION",seq:45,fieldColSpan:5,defaultValue:""},xColumnId:{label:"X_COLUMN",elementId:"CH_X_COLUMN",seq:50,fieldColSpan:7,defaultValue:""},xFunctionId:{label:"AGGREGATION",elementId:"CH_X_FUNCTION",seq:55,fieldColSpan:5,defaultValue:""},yColumnId:{label:"Y_COLUMN",elementId:"CH_Y_COLUMN",seq:60,fieldColSpan:7,defaultValue:""},yFunctionId:{label:"AGGREGATION",elementId:"CH_Y_FUNCTION",seq:65,fieldColSpan:5,defaultValue:""},openColumnId:{label:"OPEN_COLUMN",elementId:"CH_OPEN_COLUMN",seq:70,fieldColSpan:7,defaultValue:""},openFunctionId:{label:"AGGREGATION",elementId:"CH_OPEN_FUNCTION",seq:75,fieldColSpan:5,defaultValue:""},closeColumnId:{label:"CLOSE_COLUMN",elementId:"CH_CLOSE_COLUMN",seq:80,fieldColSpan:7,defaultValue:""},closeFunctionId:{label:"AGGREGATION",elementId:"CH_CLOSE_FUNCTION",seq:85,fieldColSpan:5,defaultValue:""},highColumnId:{label:"HIGH_COLUMN",elementId:"CH_HIGH_COLUMN",seq:90,fieldColSpan:7,defaultValue:""},highFunctionId:{label:"AGGREGATION",elementId:"CH_HIGH_FUNCTION",seq:95,fieldColSpan:5,defaultValue:""},lowColumnId:{label:"LOW_COLUMN",elementId:"CH_LOW_COLUMN",seq:100,fieldColSpan:7,defaultValue:""},lowFunctionId:{label:"AGGREGATION",elementId:"CH_LOW_FUNCTION",seq:105,fieldColSpan:5,defaultValue:""},volumeColumnId:{label:"VOLUME_COLUMN",elementId:"CH_VOLUME_COLUMN",seq:110,fieldColSpan:7,defaultValue:""},volumeFunctionId:{label:"AGGREGATION",elementId:"CH_VOLUME_FUNCTION",seq:115,fieldColSpan:5,defaultValue:""},targetColumnId:{label:"TARGET_COLUMN",elementId:"CH_TARGET_COLUMN",seq:120,fieldColSpan:7,defaultValue:""},targetFunctionId:{label:"AGGREGATION",elementId:"CH_TARGET_FUNCTION",seq:125,fieldColSpan:5,defaultValue:""},zColumnId:{label:"Z_COLUMN",elementId:"CH_Z_COLUMN",seq:130,fieldColSpan:7,defaultValue:""},zFunctionId:{label:"AGGREGATION",elementId:"CH_Z_FUNCTION",seq:135,fieldColSpan:5,defaultValue:""},seriesColumnId:{label:"SERIES_COLUMN",elementId:"CH_SERIES_COLUMN",seq:140,fieldColSpan:7,defaultValue:""},stackId:{label:"STACK",elementId:"CH_STACK",seq:143,fieldColSpan:5,defaultValue:ne},sortBy:{label:"SORT_BY",elementId:"CH_SORT_BY",seq:145,fieldColSpan:7,defaultValue:n("LABEL_COLUMN")},sortDirection:{label:"DIRECTION",elementId:"CH_SORT_DIRECTION",seq:147,fieldColSpan:3,defaultValue:Gc},sortNulls:{label:"NULLS",elementId:"CH_SORT_NULLS",seq:149,fieldColSpan:2,defaultValue:Jc},axisLabelTitle:{label:"AXIS_LABEL_TITLE",elementId:"CH_AXIS_LABEL_TITLE",seq:150,fieldColSpan:7},axisValueTitle:{label:"AXIS_VALUE_TITLE",elementId:"CH_AXIS_VALUE_TITLE",seq:170,fieldColSpan:7},axisValueDecimal:{label:"AXIS_VALUE_DECIMAL",elementId:"CH_AXIS_VALUE_DECIMAL",seq:180,fieldColSpan:3}}},init:function(c,d,e){function f(){var b=k.val();l.val();switch(O([l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,E,F,G,H,I,J,K,L,M,P,R,S,T]),g(),h=[l,m,o,y,z,E,A,B,C,R,S,T],i=[m,o,E,R,S,T],b){case Zd:N(h),Q([m,o],!0),Q([p,q,r,s,t,u,v],!1),R.empty(),j={},j[ze.LABEL]=n("LABEL_COLUMN"),j[ze.VALUE]=n("VALUE_COLUMN"),a.each(j,function(b,c){R.append(a("<option></option>").attr("value",b).text(c))});break;case $d:N([l,m,o,r,y,z,E,H,A,B,C,R,S,T]),Q([m,o],!0),Q([p,q,r,s,t,u,v],!1),U=R.val(),R.empty(),j={},j[ze.LABEL]=n("LABEL_COLUMN"),j[ze.VALUE]=n("VALUE_COLUMN"),j[ze.Z]=n("Z_COLUMN"),a.each(j,function(b,c){R.append(a("<option></option>").attr("value",b).text(c))}),null===U&&""===U||R.val(U);break;case _d:N([m,p,q,r,F,G,H,A,B,C,R,S,T]),Q([m,p,q,r],!0),Q([o,s,t,u,v],!1),U=R.val(),R.empty(),j={},j[ze.LABEL]=n("LABEL_COLUMN"),j[ze.X]=n("X_COLUMN"),j[ze.Y]=n("Y_COLUMN"),j[ze.Z]=n("Z_COLUMN"),a.each(j,function(b,c){R.append(a("<option></option>").attr("value",b).text(c))}),null===U&&""===U||R.val(U);break;case ae:N([m,o,E,R,S,T,C]),Q([m,o],!0),Q([p,q,r,s,t,u,v],!1),U=R.val(),R.empty(),j={},j[ze.LABEL]=n("LABEL_COLUMN"),j[ze.VALUE]=n("VALUE_COLUMN"),a.each(j,function(b,c){R.append(a("<option></option>").attr("value",b).text(c))}),null===U&&""===U||R.val(U);break;case be:N([l,m,o,x,E,P,R,S,T]),Q([m,o],!0),Q([p,q,r,s,t,u,v],!1),U=R.val(),R.empty(),j={},j[ze.LABEL]=n("LABEL_COLUMN"),j[ze.VALUE]=n("VALUE_COLUMN"),j[ze.TARGET]=n("TARGET_COLUMN"),a.each(j,function(b,c){R.append(a("<option></option>").attr("value",b).text(c))}),null===U&&""===U||R.val(U);break;case ce:N(h),Q([m,o],!0),Q([p,q,r,s,t,u,v],!1),U=R.val(),R.empty(),j={},j[ze.LABEL]=n("LABEL_COLUMN"),j[ze.VALUE]=n("VALUE_COLUMN"),a.each(j,function(b,c){R.append(a("<option></option>").attr("value",b).text(c))}),null===U&&""===U||R.val(U);break;case de:N(h),Q([m,o],!0),Q([p,q,r,s,t,u,v],!1),U=R.val(),R.empty(),j={},j[ze.LABEL]=n("LABEL_COLUMN"),j[ze.VALUE]=n("VALUE_COLUMN"),a.each(j,function(b,c){R.append(a("<option></option>").attr("value",b).text(c))}),null===U&&""===U||R.val(U);break;case ee:N([m,o,E,C,R,S,T]),Q([m,o],!0),Q([p,q,r,s,t,u,v],!1);break;case fe:N(i),Q([m,o],!0),Q([p,q,r,s,t,u,v],!1),U=R.val(),R.empty(),j={},j[ze.LABEL]=n("LABEL_COLUMN"),j[ze.VALUE]=n("VALUE_COLUMN"),a.each(j,function(b,c){R.append(a("<option></option>").attr("value",b).text(c))}),null===U&&""===U||R.val(U);break;case ge:N(i),Q([m,o],!0),Q([p,q,r,s,t,u,v],!1),U=R.val(),R.empty(),j={},j[ze.LABEL]=n("LABEL_COLUMN"),j[ze.VALUE]=n("VALUE_COLUMN"),a.each(j,function(b,c){R.append(a("<option></option>").attr("value",b).text(c))}),null===U&&""===U||R.val(U);break;case he:N([l,m,u,v,r,y,K,L,H,A,B,C,R,S,T]),Q([u,v],!0),Q([m,o,p,q,r,s,t],!1),U=R.val(),R.empty(),j={},j[ze.LABEL]=n("LABEL_COLUMN"),j[ze.HIGH]=n("HIGH_COLUMN"),j[ze.LOW]=n("LOW_COLUMN"),j[ze.Z]=n("Z_COLUMN"),a.each(j,function(b,c){R.append(a("<option></option>").attr("value",b).text(c))}),null===U&&""===U||R.val(U);break;case je:N([m,s,t,u,v,w,I,J,K,L,M]),Q([m,s,t,u,v],!0),Q([o,p,q,r],!1);break;case ie:N([m,p,q,y,F,G,A,B,C,R,S,T]),Q([m,p,q],!0),Q([o,r,s,t,u,v],!1),U=R.val(),R.empty(),j={},j[ze.LABEL]=n("LABEL_COLUMN"),j[ze.X]=n("X_COLUMN"),j[ze.Y]=n("Y_COLUMN"),a.each(j,function(b,c){R.append(a("<option></option>").attr("value",b).text(c))}),null===U&&""===U||R.val(U)}}function g(){function a(a,d){c.setValue(b,a,d)}var b=e.recordView("getRecord");a("sortBy",R.val()),a("sortDirection",S.val()),a("sortNulls",T.val()),a("orientationId",l.val()),a("stackId",z.val())}var h,i,j={},k=b._getElement("CH_TYPE"),l=b._getElement("CH_ORIENTATION"),m=b._getElement("CH_LABEL_COLUMN"),o=b._getElement("CH_VALUE_COLUMN"),p=b._getElement("CH_X_COLUMN"),q=b._getElement("CH_Y_COLUMN"),r=b._getElement("CH_Z_COLUMN"),s=b._getElement("CH_OPEN_COLUMN"),t=b._getElement("CH_CLOSE_COLUMN"),u=b._getElement("CH_HIGH_COLUMN"),v=b._getElement("CH_LOW_COLUMN"),w=b._getElement("CH_VOLUME_COLUMN"),x=b._getElement("CH_TARGET_COLUMN"),y=b._getElement("CH_SERIES_COLUMN"),z=b._getElement("CH_STACK"),A=b._getElement("CH_AXIS_LABEL_TITLE"),B=b._getElement("CH_AXIS_VALUE_TITLE"),C=b._getElement("CH_AXIS_VALUE_DECIMAL"),E=b._getElement("CH_VALUE_FUNCTION"),F=b._getElement("CH_X_FUNCTION"),G=b._getElement("CH_Y_FUNCTION"),H=b._getElement("CH_Z_FUNCTION"),I=b._getElement("CH_OPEN_FUNCTION"),J=b._getElement("CH_CLOSE_FUNCTION"),K=b._getElement("CH_HIGH_FUNCTION"),L=b._getElement("CH_LOW_FUNCTION"),M=b._getElement("CH_VOLUME_FUNCTION"),P=b._getElement("CH_TARGET_FUNCTION"),R=b._getElement("CH_SORT_BY"),S=b._getElement("CH_SORT_DIRECTION"),T=b._getElement("CH_SORT_NULLS"),U=R.val();k.change(f),e.on("apexbeginrecordedit",function(a,c){var d=k.val();D(b._getId("CH_TYPE"),d),f()})},load:function(c){var d,e,f=a.extend({},b.getChart());f.axis&&(f.axis.label&&(f.axisLabelTitle=f.axis.label),f.axis.value&&(f.axisValueTitle=f.axis.value),f.axis.valueDecimalPlaces&&(f.axisValueDecimal=f.axis.valueDecimalPlaces),delete f.axis),f.stackId=f.stack,delete f.stack,f.orientationId=f.orientation,delete f.orientation;for(d in f.chartColumns)if(f.chartColumns.hasOwnProperty(d))switch(e=f.chartColumns[d],d){case"LABEL":f.type in{bar:1,bubble:1,area:1,funnel:1,pie:1,donut:1,polar:1,radar:1,line:1,lineWithArea:1,range:1,stock:1,scatter:1}&&(f.labelColumnId=e.columnId,e.sort&&(f.sortBy="LABEL",f.sortDirection=e.sort.direction,f.sortNulls=e.sort.nulls));break;case"VALUE":f.valueColumnId=e.columnId,e["function"]&&(f.valueFunctionId=e["function"]),e.sort&&(f.sortBy="VALUE",f.sortDirection=e.sort.direction,f.sortNulls=e.sort.nulls);break;case"X":f.xColumnId=e.columnId,e["function"]&&(f.xFunctionId=e["function"]),e.sort&&(f.sortBy="X",f.sortDirection=e.sort.direction,f.sortNulls=e.sort.nulls);break;case"Y":f.yColumnId=e.columnId,e["function"]&&(f.yFunctionId=e["function"]),e.sort&&(f.sortBy="Y",f.sortDirection=e.sort.direction,f.sortNulls=e.sort.nulls);break;case"Z":f.zColumnId=e.columnId,e["function"]&&(f.zFunctionId=e["function"]),e.sort&&(f.sortBy="Z",f.sortDirection=e.sort.direction,f.sortNulls=e.sort.nulls);break;case"OPEN":f.openColumnId=e.columnId,e["function"]&&(f.openFunctionId=e["function"]);break;case"CLOSE":f.closeColumnId=e.columnId,e["function"]&&(f.closeFunctionId=e["function"]);break;case"HIGH":f.highColumnId=e.columnId,e["function"]&&(f.highFunctionId=e["function"]),e.sort&&(f.sortBy="HIGH",f.sortDirection=e.sort.direction,f.sortNulls=e.sort.nulls);break;case"LOW":f.lowColumnId=e.columnId,e["function"]&&(f.lowFunctionId=e["function"]),e.sort&&(f.sortBy="LOW",f.sortDirection=e.sort.direction,f.sortNulls=e.sort.nulls);break;case"VOLUME":f.volumeColumnId=e.columnId,e["function"]&&(f.volumeFunctionId=e["function"]);break;case"TARGET":f.targetColumnId=e.columnId,e["function"]&&(f.targetFunctionId=e),e.sort&&(f.sortBy="TARGET",f.sortDirection=e.sort.direction,f.sortNulls=e.sort.nulls);break;case"SERIES_NAME":f.seriesColumnId=e.columnId}delete f.chartColumns,c.setData(f)},validate:function(a,b,c){var d,f=!0,g=a.getRecord();return g.sortBy&&(d=g.sortBy.toLowerCase()+"ColumnId",g.hasOwnProperty(d)?b(g.sortBy,"sortBy"):(c(g.sortBy,"sortBy",e.formatMessage("APEX.IG.INVALID_SORT_BY",g.sortBy)),f=!1)),f},store:function(c){var d,e,f,g,h,i,j,k,l,m,n,o,p=a.extend({},c.getRecord());p.axis={},p.axis={label:p.axisLabelTitle,value:p.axisValueTitle,valueDecimalPlaces:p.axisValueDecimal},delete p.axisLabelTitle,delete p.axisValueTitle,delete p.axisValueDecimal,p.stack=p.stackId,p.orientation=p.orientationId,p.chartColumns={},p.type in{bar:1,bubble:1,area:1,funnel:1,pie:1,donut:1,polar:1,radar:1,line:1,lineWithArea:1,range:1,stock:1,scatter:1}?p.labelColumnId&&(d={columnId:p.labelColumnId,columnType:Ub},p.sortBy===ze.LABEL&&(d.sort={order:1,direction:p.sortDirection,nulls:p.sortNulls}),p.chartColumns.LABEL=d):delete p.chartColumns.LABEL,p.type in{bar:1,area:1,funnel:1,pie:1,donut:1,polar:1,radar:1,line:1,lineWithArea:1}?p.valueColumnId&&(e={columnId:p.valueColumnId,columnType:Ub},p.sortBy===ze.VALUE&&(e.sort={order:1,direction:p.sortDirection,nulls:p.sortNulls}),p.valueFunctionId&&(e["function"]=p.valueFunctionId),p.chartColumns.VALUE=e):delete p.chartColumns.VALUE,p.type in{bubble:1,scatter:1}?(p.xColumnId&&(f={columnId:p.xColumnId,columnType:Ub},"X"===p.sortBy&&(f.sort={order:1,direction:p.sortDirection,nulls:p.sortNulls}),p.xFunctionId&&(f["function"]=p.xFunctionId),p.chartColumns.X=f),p.yColumnId&&(g={columnId:p.yColumnId,columnType:Ub},"Y"===p.sortBy&&(g.sort={order:1,direction:p.sortDirection,nulls:p.sortNulls}),p.yFunctionId&&(g["function"]=p.yFunctionId),p.chartColumns.Y=g)):(delete p.chartColumns.X,delete p.chartColumns.Y),p.type in{bar:1,bubble:1}?p.zColumnId&&(h={columnId:p.zColumnId,columnType:Ub},"Z"===p.sortBy&&(h.sort={order:1,direction:p.sortDirection,nulls:p.sortNulls}),p.zFunctionId&&(h["function"]=p.zFunctionId),p.chartColumns.Z=h):delete p.chartColumns.Z,p.type===je?(p.openColumnId&&(i={columnId:p.openColumnId,columnType:Ub},p.openFunctionId&&(i["function"]=p.openFunctionId),p.chartColumns.OPEN=i),p.closeColumnId&&(j={columnId:p.closeColumnId,columnType:Ub},p.closeFunctionId&&(j["function"]=p.closeFunctionId),p.chartColumns.CLOSE=j),p.volumeColumnId&&(m={columnId:p.volumeColumnId,columnType:Ub},p.volumeFunctionId&&(m["function"]=p.volumeFunctionId),p.chartColumns.VOLUME=m)):(delete p.chartColumns.OPEN,delete p.chartColumns.CLOSE,delete p.chartColumns.VOLUME),p.type in{range:1,stock:1}?(p.highColumnId&&(k={columnId:p.highColumnId,columnType:Ub},"HIGH"===p.sortBy&&(k.sort={order:1,direction:p.sortDirection,nulls:p.sortNulls}),p.highFunctionId&&(k["function"]=p.highFunctionId),p.chartColumns.HIGH=k),p.lowColumnId&&(l={columnId:p.lowColumnId,columnType:Ub},"LOW"===p.sortBy&&(l.sort={order:1,direction:p.sortDirection,nulls:p.sortNulls}),p.lowFunctionId&&(l["function"]=p.lowFunctionId),p.chartColumns.LOW=l)):(delete p.chartColumns.HIGH,delete p.chartColumns.LOW),p.type===be?p.targetColumnId&&(n={columnId:p.targetColumnId,columnType:Ub},"TARGET"===p.sortBy&&(n.sort={order:1,direction:p.sortDirection,nulls:p.sortNulls}),p.targetFunctionId&&(n["function"]=p.targetFunctionId),p.chartColumns.TARGET=n):delete p.chartColumns.TARGET,p.seriesColumnId&&(o={columnId:p.seriesColumnId,columnType:Ub},p.chartColumns.SERIES_NAME=o),delete p.sortBy,delete p.sortDirection,delete p.sortNulls,delete p.stackId,delete p.orientationId,delete p.xColumnId,delete p.xFunctionId,delete p.yFunctionId,delete p.yColumnId,delete p.valueColumnId,delete p.valueFunctionId,delete p.labelColumnId,delete p.zColumnId,delete p.zFunctionId,delete p.openColumnId,delete p.openFunctionId,delete p.closeColumnId,delete p.closeFunctionId,delete p.volumeColumnId,delete p.volumeFunctionId,delete p.highColumnId,delete p.highFunctionId,delete p.lowColumnId,delete p.lowFunctionId,delete p.targetColumnId,delete p.targetFunctionId,delete p.seriesColumnId,b.setChart(p)}})},setColumnConfig:function(b){var c,d,e,f,g,h={},i={},j=b.baseModelColumns,k=b.ig,l=b.igConfig,m=b.currentReportSettings.views.chart.chartColumns,n=["CLOSE","HIGH","LABEL","LOW","OPEN","SERIES_NAME","TARGET","VALUE","VOLUME","X","Y","Z"],o=0;for(g=0;g<n.length;g++)e=n[g],m.hasOwnProperty(e)&&(h=a.extend(!0,{},j[m[e].columnId]),h.seq=o,h.index=o,i[e]=h,o++);if(l.parentRegionStaticId)for(d in j)j.hasOwnProperty(d)&&(f=j[d],f.parentField&&(c=k._getColumn(d),h=a.extend(!0,{},f),h.seq=o,h.virtual=!0,delete h.index,i[c.name]=h,o++));this.modelColumns=i,this.specialColumns={}},initView:function(b){var c,d,e,f,g,h,i,j,k,l,m,n=b.ig,o=this,p=n._currentReportSettings().views.chart,q=b.igConfig,r=[],s="disabled";require(["ojs/ojcore","ojs/ojchart","ojs/ojvalidation"],function(){function b(a){var b,c=oj.ConverterFactory.CONVERTER_TYPE_NUMBER,d=n._getColumn(a);return d.filter.dataType===Ud||d.filter.dataType===Wd||d.filter.dataType===Xd||d.filter.dataType===Yd?(c=oj.ConverterFactory.CONVERTER_TYPE_DATETIME,b=t(d)):d.filter.dataType===Td&&(b=u(d)),b?oj.Validation.converterFactory(c).createConverter(b):{}}function t(b){var c=b.appearance.formatMask;return c?a.each(Be,function(a,b){b.value===c&&(c=b.label)}):c={formatType:"date",dateFormat:"medium"},c}function u(b){var c,d=b.appearance.formatExample.trim();return p.axis&&p.axis.valueDecimalPlaces&&(c=p.axis.valueDecimalPlaces),d?a.each(Ae,function(a,b){b.value===d&&(d=b.label)}):d={style:"decimal",maximumFractionDigits:c?c:2},d}switch(p.chartColumns.LABEL.columnId&&(h=n._getColumn(p.chartColumns.LABEL.columnId),h.filter.dataType!==Ud&&h.filter.dataType!==Wd&&h.filter.dataType!==Xd&&h.filter.dataType!==Yd||(s="enabled")),d={legend:{rendered:oe,position:"end"},orientation:p.orientation,stack:p.stack,animationOnDisplay:oe,animationOnDataChange:oe,hoverBehavior:"dim",groups:[],series:[],valueFormats:[],timeAxisType:s,translations:{labelNoData:q.text.noDataFound}},p.type){case Zd:e=a.extend({},d,{type:p.type,legend:p.chartColumns.SERIES_NAME?{rendered:oe}:{rendered:ne},coordinateSystem:pe,valueFormats:[{type:Zc,converter:b(p.chartColumns.LABEL.columnId)},{type:"y",converter:b(p.chartColumns.VALUE.columnId)}],xAxis:{},yAxis:{}});break;case $d:e=a.extend({},d,{type:p.type,legend:p.chartColumns.SERIES_NAME?{rendered:oe}:{rendered:ne},coordinateSystem:pe,valueFormats:[{type:Zc,converter:b(p.chartColumns.LABEL.columnId)},{type:"y",converter:b(p.chartColumns.VALUE.columnId)}],xAxis:{},yAxis:{}});break;case _d:e=a.extend({},d,{type:p.type,legend:{rendered:ne},coordinateSystem:pe,xAxis:{},yAxis:{}});break;case ae:e=a.extend({},d,{type:ee,styleDefaults:{pieInnerRadius:.5},legend:{rendered:oe},hideAndShowBehavior:"withRescale",valueFormats:[{type:Zc,converter:b(p.chartColumns.LABEL.columnId)},{type:bd,converter:b(p.chartColumns.VALUE.columnId)}]});break;case ee:e=a.extend({},d,{type:p.type,styleDefaults:{pieInnerRadius:0},legend:{rendered:oe},hideAndShowBehavior:"withRescale",valueFormats:[{type:Zc,converter:b(p.chartColumns.LABEL.columnId)},{type:bd,converter:b(p.chartColumns.VALUE.columnId)}]});break;case be:e=a.extend({},d,{type:p.type,legend:{rendered:oe},valueFormats:[{type:Zc,converter:b(p.chartColumns.LABEL.columnId)},{type:bd,converter:b(p.chartColumns.VALUE.columnId)}]}),p.chartColumns.TARGET&&e.valueFormats.push({type:"target",converter:b(p.chartColumns.TARGET.columnId)});break;case ce:e=a.extend({},d,{type:p.type,legend:p.chartColumns.SERIES_NAME?{rendered:oe}:{rendered:ne},coordinateSystem:pe,valueFormats:[{type:Zc,converter:b(p.chartColumns.LABEL.columnId)},{type:bd,converter:b(p.chartColumns.VALUE.columnId)}],xAxis:{},yAxis:{}});break;case de:e=a.extend({},d,{type:p.type,legend:p.chartColumns.SERIES_NAME?{rendered:oe}:{rendered:ne},coordinateSystem:pe,valueFormats:[{type:Zc,converter:b(p.chartColumns.LABEL.columnId)},{type:bd,converter:b(p.chartColumns.VALUE.columnId)}],xAxis:{},yAxis:{}});break;case fe:e=a.extend({},d,{type:$d,coordinateSystem:p.type,legend:{rendered:ne},valueFormats:[{type:Zc,converter:b(p.chartColumns.LABEL.columnId)},{type:bd,converter:b(p.chartColumns.VALUE.columnId)}],polarGridShape:"circle",stack:me});break;case ge:e=a.extend({},d,{type:Zd,coordinateSystem:fe,legend:{rendered:ne},valueFormats:[{type:Zc,converter:b(p.chartColumns.LABEL.columnId)},{type:bd,converter:b(p.chartColumns.VALUE.columnId)}],polarGridShape:"polygon",stack:me});break;case he:e=a.extend({},d,{type:$d,legend:p.chartColumns.SERIES_NAME?{rendered:oe}:{rendered:ne},valueFormats:[{type:Zc,converter:b(p.chartColumns.LABEL.columnId)},{type:"high",converter:b(p.chartColumns.HIGH.columnId)},{type:"low",converter:b(p.chartColumns.LOW.columnId)}],xAxis:{},yAxis:{}});break;case ie:e=a.extend({},d,{type:p.type,legend:p.chartColumns.SERIES_NAME?{rendered:oe}:{rendered:ne},coordinateSystem:pe,valueFormats:[{type:Zc,converter:b(p.chartColumns.LABEL.columnId)},{type:"x",converter:b(p.chartColumns.X.columnId)},{type:"y",converter:b(p.chartColumns.Y.columnId)}],xAxis:{},yAxis:{}});break;case je:e=a.extend({},d,{type:p.type,zoomAndScroll:"delayed",initialZooming:"first",legend:{rendered:oe},dataCursor:me,dataCursorBehavior:"smooth",valueFormats:[{type:Zc,converter:b(p.chartColumns.LABEL.columnId)},{type:"high",converter:b(p.chartColumns.HIGH.columnId)},{type:"low",converter:b(p.chartColumns.LOW.columnId)},{type:"open",converter:b(p.chartColumns.OPEN.columnId)},{type:"close",converter:b(p.chartColumns.CLOSE.columnId)}],xAxis:{},yAxis:{}}),p.chartColumns.VOLUME&&e.valueFormats.push({type:"volume",converter:b(p.chartColumns.VOLUME.columnId)}),e.series.type="candlestick"}if(p.type in{area:1,bar:1,bubble:1,line:1,lineWithArea:1,range:1,stock:1,scatter:1}){switch(p.type){case je:i=p.chartColumns.OPEN.columnId;break;case he:i=p.chartColumns.HIGH.columnId;break;case ie:i=p.chartColumns.X.columnId;break;case _d:i=p.chartColumns.X.columnId;break;default:i=p.chartColumns.VALUE.columnId}p.axis&&(p.axis.label&&(j=p.axis.label),p.axis.value&&(k=p.axis.value)),e.xAxis={title:j,baselineScaling:"zero",majorTick:{rendered:me},minorTick:{rendered:ne},tickLabel:{rendered:me,converter:b(p.chartColumns.LABEL.columnId),scaling:Kc},position:oe,rotation:ne},e.yAxis={title:k,baselineScaling:"zero",position:p.type===je?"end":oe,majorTick:{rendered:me},minorTick:{rendered:ne},tickLabel:{rendered:me,converter:b(i),scaling:Kc}}}if(p.type in{bar:1,area:1,polar:1,radar:1,range:1,line:1,lineWithArea:1,bubble:1,scatter:1,stock:1}){switch(c={path:"groups",uniqueIndexField:"LABEL",item:{name:"LABEL"}},p.type){case _d:g={name:"LABEL",x:"X",y:"Y",z:"Z",labelPosition:"'none'"};break;case ie:g={name:"LABEL",x:"X",y:"Y",labelPosition:"'none'"};break;case je:g={name:"LABEL",open:"OPEN",close:"CLOSE",high:"HIGH",low:"LOW",volume:"VOLUME"};break;case he:g={name:"LABEL",high:"HIGH",low:"LOW",labelPosition:"'none'"};break;default:g={label:"VALUE",value:"VALUE",name:"LABEL",labelPosition:"'none'"}}r=p.chartColumns.SERIES_NAME?[c,{path:"series",uniqueIndexField:"SERIES_NAME",item:{name:"SERIES_NAME",displayInLegend:me}},{path:"series/[SERIES_NAME]/items",item:g}]:[c,{path:"series/0/items",item:g}]}if(p.type in{pie:1,donut:1,funnel:1}&&(l=o.model.getFieldKey("LABEL"),r=[{path:"series",uniqueIndexField:"LABEL",item:function(a,b){return{name:""+b[l],displayInLegend:me}}},{path:"series/[LABEL]/items",item:{value:"VALUE",targetValue:"TARGET"}}]),p.chartColumns.VALUE){if(p.chartColumns.VALUE.sort)switch(p.chartColumns.VALUE.sort.direction){case"asc":m="ascending";break;case"desc":m="descending"}}else p.chartColumns.LABEL.sort?m="label-"+p.chartColumns.LABEL.sort.direction:(p.chartColumns.SERIES_NAME&&(m="label-asc"),m="off");e.sorting=m,o._dataTransformOptions={showNullAs:q.appearance.showNullValue,offset:0,template:r},o._chartOptions=e,o._updateChartData(),f=o.view$.ojChart(e),f.css({"max-width":"100%"}),o._subscribeModel(),(q.lazyLoad||o.model.getTotalRecords()<0)&&o.refresh()})},_updateChartData:function(){var b,c=["pie","funnel","scatter","bubble","stock","polar","radar"];if(b=this.model.transform(this._dataTransformOptions,this._chartOptions),a.inArray(b.type,c)===-1&&b.series.length>1&&"mixedFrequency"!==b.timeAxisType&&"skipGaps"!==b.timeAxisType){l.chartSortArray(b.groups,b.sorting);for(var d=0;d<b.series.length;d++)l.chartFillGaps(b.groups,b.series[d].items,b.sorting,!0)}},_subscribeModel:function(){var a=this,b=this.view$;this._observedModel&&this._observedModel.unSubscribe(this._observerId),this._observedModel=this.model,this._observerId=this.model.subscribe({viewId:b[0].id,onChange:function(b){b===$b&&a.refresh()},progressView:b})},refresh:function(){var a=this;if(this.view$.hasClass("oj-chart")){if(null===this.view$[0].offsetParent)return void(this._pendingRefresh=!0);this._pendingRefresh=!1,this.model.fetch(0,function(b){b&&c.warn("No data fetched for chart"),a._updateChartData(),a.resize()})}},resize:function(){if(this.view$.hasClass("oj-chart")){if(this._pendingRefresh)return void this.refresh();this.view$.ojChart($b)}},destroyView:function(){this.model&&this.model.unSubscribe(this.view$[0].id),this.view$.ojChart(Yb)},setModelName:function(a){this._subscribeModel(),this.view$.hasClass("oj-chart")&&(this.model.getTotalRecords()<0?this.refresh():(this._updateChartData(),this.resize()))},setNoDataMessage:function(a){var b=this.view$;b.hasClass("oj-chart")&&b.ojChart(ic,"translations.labelNoData",a)}})}(apex.jQuery,apex.util,apex.debug,apex.server,apex.lang,apex.actions,apex.region,apex.theme,apex.message,apex.item,apex.model,apex.widget.util);